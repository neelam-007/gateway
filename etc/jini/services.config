import net.jini.core.discovery.LookupLocator;
import net.jini.discovery.LookupLocatorDiscovery;
import net.jini.constraint.BasicMethodConstraints;
import net.jini.core.entry.Entry;
import net.jini.core.constraint.ClientAuthentication;
import net.jini.core.constraint.InvocationConstraint;
import net.jini.core.constraint.InvocationConstraints;
import net.jini.security.BasicProxyPreparer;
import net.jini.lookup.entry.*;
import net.jini.jeri.BasicILFactory;
import net.jini.jeri.BasicJeriExporter;
import net.jini.jeri.tcp.TcpServerEndpoint;
import com.l7tech.jini.security.AuthenticateClientSubjectChecker;
import com.sun.jini.discovery.DiscoveryProtocolVersion;
import net.jini.core.constraint.Delegation;
import net.jini.jeri.ssl.SslServerEndpoint;
import net.jini.jeri.tcp.TcpServerEndpoint;
import net.jini.discovery.ConstrainableLookupLocator;
import net.jini.discovery.LookupDiscoveryManager;
import net.jini.discovery.DiscoveryGroupManagement;
import java.security.Permission;

/* Items used in multiple blocks below */
shared.entries {
    
    private serviceLookupConstraints = 
	new BasicMethodConstraints( 
	    new InvocationConstraints( 
		new InvocationConstraint[] { 
		    DiscoveryProtocolVersion.TWO
		    }, 
		null));

}//end shared.entries

com.sun.jini.reggie{

  initialMemberGroups = new String[] { "services.l7tech.com"};

  unicastDiscoverySubjectChecker = new AuthenticateClientSubjectChecker();

  /* Exporter for the server proxy */
  serverExporter = 
    new BasicJeriExporter(SslServerEndpoint.getInstance(2124),
                          new BasicILFactory(), false, false);
  discoveryConstraints =                            
	    shared.entries.serviceLookupConstraints;
        
  initialLookupLocators = new LookupLocator[] {
    new ConstrainableLookupLocator(
        "jini://localhost",
        shared.entries.serviceLookupConstraints
     )
  };
}


com.l7tech.jini.export.RemoteService {

  /* Exporter for the server proxy */
  serverExporter =
        new BasicJeriExporter(
        TcpServerEndpoint.getInstance(2124),
        new BasicILFactory());
                                     
  private groups = new String[] { "services.l7tech.com" };
  // discoveryManager = new LookupDiscovery(groups, this);

  discoveryManager =
  new LookupLocatorDiscovery(
    new LookupLocator[] {
        new ConstrainableLookupLocator(
            "jini://localhost",
            shared.entries.serviceLookupConstraints)
    });

    static registrarPreparer =
        new BasicProxyPreparer(false,
                               shared.entries.serviceLookupConstraints,
                               new Permission[] {});

}

