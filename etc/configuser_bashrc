set -u
set -e

SYSWIZARD="/ssg/sysconfigwizard/systemconfig.sh"
CONFWIZARD="/ssg/configwizard/ssgconfig.sh"
UPDATEWIZARD="/ssg/updatewizard/ssgupdatewizard.sh"

checkForUpdater() {
    if [ -d "/ssg/updatewizard" ] ; then
        UPDATER_PRESENT="true"
    else
        UPDATER_PRESENT=""
    fi
}

checkForUpdater
isValid="n"
while [ "$isValid" != "y" ]
do
    clear
    echo "Welcome to the SecureSpan Gateway"
    echo
    echo "This user account allows you to configure the appliance"
    echo "What would you like to do?"
        echo "1) Configure networking on this SecureSpan Gateway appliance"
        echo "2) Configure the SecureSpan Gateway application on this appliance"
        echo "3) Logout (no reboot)"
        echo "4) Reboot the SSG appliance (apply the new configuration)"
        if [ "${UPDATER_PRESENT}" = "true" ] ; then
            echo "5) Upgrade the SecureSpan Appliance"
        fi
        echo -n "Please make a selection: "
        read choice

        case $choice in
                1) 	clear;
                    (${SYSWIZARD});
                    echo "Press enter to continue";
                    read;
                    clear;;
                2) 	clear;
                    (${CONFWIZARD});
                    echo "Press enter to continue";
                    read;
                    clear;;
                3)  exit;;
                4)  sudo /sbin/reboot;;
                5)  if [ -n ${UPDATER_PRESENT} ] ; then
                        clear;
                        (${UPDATEWIZARD})
                        echo "Press enter to continue";
                        read;
                    else
                        echo "This option requires the SecureSpan Update Utility to be installed."
                        echo "Please select another option"
                        echo "Press enter to continue";
                        read;
                    fi
                    clear;;
                *)  isValid="n";
                    echo "That is not a valid selection";
                    echo "Press enter to continue";
                    read;;
        esac
done