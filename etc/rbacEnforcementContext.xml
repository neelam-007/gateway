<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC  "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
    <bean id="rbacPointcut" class="com.l7tech.server.security.rbac.SecuredPointcut"/>

    <bean id="rbacAdvice" class="com.l7tech.server.security.rbac.SecuredMethodInterceptor">
        <constructor-arg ref="roleManager"/>
    </bean>

    <bean id="rbacAdvisor" class="org.springframework.aop.support.DefaultPointcutAdvisor">
        <constructor-arg>
            <ref local="rbacPointcut"/>
        </constructor-arg>
        <constructor-arg>
            <ref local="rbacAdvice"/>
        </constructor-arg>
        <property name="order" value="1"/>
    </bean>
</beans>
