#!/bin/sh

MODULE=$1

# Pull in collector support functions
. ${COLLECTOR_HOME}/collectorlib

preModule $MODULE


#Define and create output folders
KERNEL_MODULE_BaseOutputDirectory=${ALL_MODULES_BASE_OUTPUT_DIR}/${MODULE}
KERNEL_MODULE_BaseOutputDirectory_config=${KERNEL_MODULE_BaseOutputDirectory}/config
KERNEL_MODULE_BaseOutputDirectory_logs=${KERNEL_MODULE_BaseOutputDirectory}/logs
mkdir -p ${KERNEL_MODULE_BaseOutputDirectory}
#mkdir -p ${KERNEL_MODULE_BaseOutputDirectory_config}
#mkdir -p ${KERNEL_MODULE_BaseOutputDirectory_logs}

#Begin data collection
logCommand cat /proc/version
cp /proc/version ${KERNEL_MODULE_BaseOutputDirectory}/proc_version.txt

logCommand lsmod
lsmod > ${KERNEL_MODULE_BaseOutputDirectory}/lsmod.txt

logCommand cat /etc/sysctl.conf
cp /etc/sysctl.conf ${KERNEL_MODULE_BaseOutputDirectory}/etc_sysctl.conf

logCommand cat /proc/cmdline
cat /proc/cmdline > ${KERNEL_MODULE_BaseOutputDirectory}/proc_cmdline.txt

postModule $MODULE
