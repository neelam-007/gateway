#!/bin/sh

MODULE=$1
LEVEL=$2

# Pull in collector support functions
. ${COLLECTOR_HOME}/collectorlib

preModule $MODULE

#Define and create output folders
DEVICES_MODULE_BaseOutputDirectory=${ALL_MODULES_BASE_OUTPUT_DIR}/${MODULE}
DEVICES_MODULE_BaseOutputDirectory_config=${DEVICES_MODULE_BaseOutputDirectory}/config
DEVICES_MODULE_BaseOutputDirectory_logs=${DEVICES_MODULE_BaseOutputDirectory}/logs
mkdir -p ${DEVICES_MODULE_BaseOutputDirectory}
#mkdir -p ${DEVICES_MODULE_BaseOutputDirectory_config}
#mkdir -p ${DEVICES_MODULE_BaseOutputDirectory_logs}



#Begin data collection
logAndRunCmd cp /proc/meminfo "${DEVICES_MODULE_BaseOutputDirectory}"

logAndRunCmd lspci -tv &> "${DEVICES_MODULE_BaseOutputDirectory}"/lspci.txt

logAndRunCmd cp /proc/cpuinfo "${DEVICES_MODULE_BaseOutputDirectory}"

logAndRunCmd ls -Rl /dev &> "${DEVICES_MODULE_BaseOutputDirectory}"/ls_R1_dev.txt

logAndRunCmd dmidecode -t 1 &> "${DEVICES_MODULE_BaseOutputDirectory}"/dmidecode.txt

#
#if [ $LEVEL -ge $DETAIL ]
#then
#    #nothing here
#fi
#
#if [ $LEVEL -ge $EVERYTHING ]
#then
#    #nothing here
#fi

postModule $MODULE
