LAYER 7 TECHNOLOGIES, INC

August 29, 2003
flascell

Description of the Xml security assertions (xml-dsig and xml-enc)

Two assertions

XmlRequestSecurity and XmlResponseSecurity.

Both apply digital signature on the soap envelope and optional xml encryption
of the soap body. You cannot encrypt a soap body without signing the envelope.
XmlRequestSecurity and XmlResponseSecurity do these transformations on the
request and response messages respectively.

XML encryption uses a pair of symmetric keys (one for the request and another
one for the response document).

To achieve replay attack protection, signed requests contain a reference to a
session id and a sequence number embedded in a WS Secure Conversation Token
element in the header of the envelope. Similarly, the response document
optionally includes a reference to a client nonce also in a WS Secure
Conversation Token element in the header of the envelope. This nonce is added
to the document before signing the response if the client asked for it in the
request. This optional nonce is generated by the client and attached to the
request in a http header.

The client proxy is responsible to ask the server to generate a session
containing both symmetric keys, and session id through a special http request.
The server maintains this session while its alive (sessions are not persisted)
and increment a sequence number each time the client sends a signed request.
This session expires one hour after its creation of after it was used to send
5000 requests.

When a client proxy tries to send a signed request using an expired session,
the server sends back a soap fault with a special header hinting that the proxy
should generate a new session.

Sessions are not synchronized with peer servers (cluster like configs). We rely
on the load balancer to redirect requests from same requestor to the same
server. If this is not the case, the client proxy might have to generate new
sessions all the time.
