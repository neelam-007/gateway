<div>
    <h1>Migration</h1>
    <p>Use the <a href="$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/doc/gmu.html">Gateway Migration Utility</a> to help facilitate migration.</p>
    <p>The migration APIs allow you to move entities, including folders, services and policies from one Gateway to another.</p>
    <p>The following is an overview of the migration workflow:</p>
    <ol>
        <li>Export a bundle from the source Gateway.</li>
        <li>Map entities as required.</li>
        <li>Import the bundle into the target Gateway.</li>
    </ol>
    <h3>Exporting a Bundle</h3>
    <p>Send the following request to export a bundle.</p>
    <table cellpadding="0" cellspacing="0" class="api-example"> 
        <caption>Bundle Export Example</caption>
        <tbody>
        <tr><td></td><td></td></tr>
        <tr><td colspan="2">Request</td>
        </tr>
        <tr>
            <td>Uri</td>
            <td><div class="code">$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle?[[folder|service|policy]={id} | all=true]</div></td>
        </tr>
        <tr><td>Http Method</td>
            <td>GET</td>
        </tr>
        <tr><td colspan="2">Response</td></tr>
        <tr>
            <td>Http Status</td>
            <td>200</td>
        </tr>
        <tr>
            <td>Message Body</td>
            <td><div class="code">
				<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;l7:Item xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot;&gt;
    &lt;l7:Name&gt;Bundle&lt;/l7:Name&gt;
    &lt;l7:Type&gt;BUNDLE&lt;/l7:Type&gt;
    &lt;l7:TimeStamp&gt;2014-01-13T11:43:01.482-08:00&lt;/l7:TimeStamp&gt;
    &lt;l7:Link/&gt; &lt;!-- This will contain the link used to generate this bundle. --&gt;
    ...
    &lt;l7:Resource&gt;
        &lt;l7:Bundle&gt; &lt;!-- The bundle object --&gt;
            &lt;l7:References&gt; &lt;!-- This is the list of entities that are in the bundle.
                &lt;l7:Item /&gt;
                ...
            &lt;/l7:References&gt;
            &lt;l7:Mappings&gt;
                &lt;!-- This is the list of mappings. It describes how to create the entity on import. The must be
                one mapping for every entity. A mapping may not reference a resource in the bundle if it will not be
                migrated. They are in the order they should be created in so to avoid any dependency issues.--&gt;
                &lt;l7:Mapping /&gt;
                ...
            &lt;/l7:Mappings&gt;
        &lt;/l7:Bundle&gt;
    &lt;/l7:Resource&gt;
&lt;/l7:Item&gt;
				</pre></div>
            </td>
        </tr>
        </tbody>
    </table>
    <p>The request URI contains query parameters of the folders, services or policies to export, specified by their ids. You can also specify all=true to export all the entities on the gateway.</p>
    <p>For example:</p>
    <p class="code indent">$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle?folder=97cd0afb295cd2d823d0fdd43e720bbc&service=08890dfa5e893770ac234e5d5a43000b&service=0ef0d5dd06fe67ab15b6a1b16517e0f5</p>
    <p>The above URI will bundle folder with ID 97cd0afb295cd2d823d0fdd43e720bbc, and services with ID 08890dfa5e893770ac234e5d5a43000b and 0ef0d5dd06fe67ab15b6a1b16517e0f5.</p>
    <p class="code indent"><a href="$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle?all=true">$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle?all=true</a></p>
    <p>The above URI will bundle all the entities in the gateway.</p>
    <h3>Importing a Bundle</h3>
    <p>To import a bundle send a PUT request with the same bundle XML to $#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle</p>
    <table cellpadding="0" cellspacing="0" class="api-example"> 
        <caption>Import Bundle Example</caption>
        <tbody>
        <tr><td></td><td></td></tr>
        <tr><td colspan="2">Request</td>
        </tr>
        <tr>
            <td>Uri</td>
            <td><div class="code">$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle</div></td>
        </tr>
        <tr>
            <td>Http Method</td>
            <td>PUT</td>
        </tr>
        <tr>
            <td>Content-Type</td>
            <td>application/xml</td>
        </tr>
        <tr>
            <td>Message Body</td>
            <td><div class="code">
				<pre>
&lt;l7:Bundle xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot;&gt; &lt;!-- The bundle object --&gt;
    &lt;l7:References&gt; &lt;!-- This is the list of entities that are in the bundle.
        &lt;l7:Item /&gt;
        ...
    &lt;/l7:References&gt;
    &lt;l7:Mappings&gt;
                    &lt;!-- This is the list of mappings. It describes how to create the entity on import. The must be
                    one mapping for every entity. A mapping may not reference a resource in the bundle if it will not be
                    migrated. They are in the order they should be created in so to avoid any dependency issues.--&gt;
        &lt;l7:Mapping /&gt;
        ...
    &lt;/l7:Mappings&gt;
&lt;/l7:Bundle&gt;
				</pre></div>
            </td>
        </tr>
        <tr><td colspan="2">Response</td></tr>
        <tr>
            <td>Http Status</td>
            <td>200</td>
        </tr>
        <tr>
            <td>Message Body</td>
            <td><div class="code">
				<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;l7:Item xmlns:l7=&quot;http://ns.l7tech.com/2010/04/gateway-management&quot;&gt;
    &lt;l7:Name&gt;Bundle mappings&lt;/l7:Name&gt;
    &lt;l7:Type&gt;BUNDLE MAPPINGS&lt;/l7:Type&gt;
    &lt;l7:TimeStamp&gt;2014-04-01T15:20:04.222-07:00&lt;/l7:TimeStamp&gt;
    &lt;l7:Link rel=&quot;self&quot; uri=&quot;$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/bundle&quot;/&gt;
    &lt;l7:Resource&gt;
        &lt;l7:Mappings&gt;
            &lt;l7:Mapping /&gt;
            ...
        &lt;/l7:Mappings&gt;
    &lt;/l7:Resource&gt;
&lt;/l7:Item&gt;
				</pre></div>
            </td>
        </tr>
        </tbody>
    </table>
    <p>The response will contain a list of mappings describing the actions that were performed during the bundle import. If bundle import failed for any reason, the mappings will describe the errors.</p>
    <h3>Mapping the Entities</h3>
    <h4>Mapping Attributes</h4>
    <p>The mapping section in a bundle describes how to import the entities listed in the resource section when the bundle is imported. Default mappings are automatically created when the bundle is exported. The mapping section has the following attributes:</p>
    <table class="properties-table" cellpadding="0" cellspacing="0">
        <tr><td>type</td><td>Type of entity being mapped</td></tr>
        <tr><td>scrId</td><td>Source ID of the service being mapping; this normally references an entity in the bundle resources section</td></tr>
        <tr><td>srcUri</td><td>Source URI to retrieve the entity from the Gateway</td></tr>
        <tr><td>targetId</td><td>During bundle import, this ID instructs the importer to map this entity with the given target ID. The bundle importer will return a list of the mappings that were made (i.e., ID of the entity that was mapped or created on the target Gateway during import).</td></tr>
        <tr><td>targetUri</td><td>Target uri of the entity that was mapped or created.</td></tr>
        <tr><td>action</td>
            <td>The possible mapping actions are as follows:
                <table class="properties-table" cellpadding="0" cellspacing="0">
                    <tr><td>NewOrExisting</td><td>If an existing entity is found on the target Gateway, map to this existing entity (no update occurs). If an existing entity is not found, then create a new one on the target Gateway.</td></tr>
                    <tr><td>NewOrUpdate</td><td>If an existing entity is found on the target Gateway, map to this existing entity and update it using information from the bundle. If an existing entity is not found, then create a new one on the target Gateway.</td></tr>
                    <tr><td>AlwaysCreateNew</td><td>If an existing entity is found on the target Gateway, then create a new one with a different ID. If an existing entity is not found, then create a new one with the source ID.</td></tr>
                    <tr><td>Delete</td><td>If an existing entity is found on the target Gateway it will be removed. If an existing entity is not found, then nothing will happen and bundle import will continue (this will not fail bundle import)</td></tr>
                    <tr><td>Ignore</td><td>Ignore this entity and do not import it.</td></tr>
                </table>
            </td>
        </tr>
        <tr><td>actionTaken</td>
            <td>This is the action that was taken during the import. This attribute is only returned by the bundle import results. The possible actions are as follows:
                <table class="properties-table" cellpadding="0" cellspacing="0">
                    <tr><td>UsedExisting</td><td>The entity was mapped to an existing entity on the target Gateway. The target entity was not updated.</td></tr>
                    <tr><td>UpdatedExisting</td><td>The entity was mapped to an existing entity on the target Gateway and the target entity was updated.</td></tr>
                    <tr><td>CreatedNew</td><td>A new entity was created on the target Gateway.</td></tr>
                    <tr><td>Deleted</td><td>The entity was deleted on the target gateway.</td></tr>
                    <tr><td>Ignored</td><td>The entity was ignored and not imported. If the action was Delete and the action taken was Ignored that means that a target entity could not be found to be deleted.</td></tr>
                </table>
            </td>
        </tr>
        <tr><td>errorType</td>
            <td>This is set if there was an error attempting to import the entity. The possible errors are as follows:
                <table class="properties-table" cellpadding="0" cellspacing="0">
                    <tr><td>TargetExists</td><td>A new entity was supposed to be created but an entity already exists on the target Gateway. See the <a href="#failonexisting">FailOnExisting</a> property.</td></tr>
                    <tr><td>TargetNotFound</td><td>An existing entity should exist on the target Gateway but it cannot be found. See the <a href="#failonnew">FailOnNew</a> property.</td></tr>
                    <tr><td>UniqueKeyConflict</td><td>There is an entity on the target Gateway with a conflicting unique key (usually name) as the one that is being created or updated.</td></tr>
                    <tr><td>CannotReplaceDependency</td><td>An error occurred when replacing an entity's dependencies.</td></tr>
                    <tr><td>InvalidResource</td><td>A problem occurred when updating an entity.</td></tr>
                </table>
            </td>
        </tr>
    </table>
    <h4>Simple Mapping Examples</h4>
    <h5>NewOrExisting</h5>
    <p>This will create a new entity or reuse an existing one:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot; /&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>An entity with the same ID exists on the target Gateway and this existing entity was used:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    actionTaken=&quot;UsedExisting&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway and a new entity with the specified ID was created:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway but one with a conflicting unique key was present instead, resulting in a 409 error response:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    errorType=&quot;UniqueKeyConflict&quot; &gt;
        &lt;l7:Properties&gt;
            &lt;l7:Property key="ErrorMessage"&gt;
                &lt;l7:StringValue&gt;(name)  must be unique&lt;/l7:StringValue&gt;
            &lt;/l7:Property&gt;
        &lt;/l7:Properties&gt;
&lt;/l7:Mapping&gt;
        </pre>
    </div>
    <h5>NewOrUpdate</h5>
    <p>This will create a new entity or update an existing one:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot; /&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>An entity with the same ID exists on the target Gateway. This entity has been updated using the entity in the import bundle:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot;
    actionTaken=&quot;UpdatedExisting&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway and a new entity with the ID specified was created:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway, but an entity with a conflicting unique key is present instead. Alternatively, an entity with the same ID exists, but unique key errors occurred when updating it, resulting in a 409 error response:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot;
    errorType=&quot;UniqueKeyConflict&quot; &gt;
        &lt;l7:Properties&gt;
            &lt;l7:Property key="ErrorMessage"&gt;
                &lt;l7:StringValue&gt;(name)  must be unique&lt;/l7:StringValue&gt;
            &lt;/l7:Property&gt;
        &lt;/l7:Properties&gt;
&lt;/l7:Mapping&gt;
        </pre>
    </div>
    <h5>AlwaysCreateNew</h5>
    <p>This will create a new entity:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;AlwaysCreateNew&quot; /&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>An entity with the same ID exists on the target Gateway, resulting in a new entity with a new ID being created on the target Gateway.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;AlwaysCreateNew&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/8756846868e6eb676bf4ed8a9bfba04b&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway, resulting in a new entity being created with the specified ID.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;AlwaysCreateNew&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>The entity created has unique key conflicts with an entity on the Gateway, resulting in a 409 error response:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;AlwaysCreateNew&quot;
    errorType=&quot;UniqueKeyConflict&quot; &gt;
        &lt;l7:Properties&gt;
            &lt;l7:Property key="ErrorMessage"&gt;
                &lt;l7:StringValue&gt;(name)  must be unique&lt;/l7:StringValue&gt;
            &lt;/l7:Property&gt;
        &lt;/l7:Properties&gt;
&lt;/l7:Mapping&gt;
        </pre>
    </div>
    <h5>Delete</h5>
    <p>This will delete an  entity:</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;Delete&quot; /&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>An entity with the same ID exists on the target Gateway, resulting in the entity being deleted on the target Gateway.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;Delete&quot;
    actionTaken=&quot;Deleted&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; /&gt;
        </pre>
    </div>
    <p>An entity with the same ID does NOT exist on the target Gateway, resulting in no entity being deleted.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;Delete&quot;
    actionTaken=&quot;Ignored&quot; /&gt;
        </pre>
    </div>
    <h5>Ignore</h5>
    <p>This will ignore the entity. No attempt will be made to import the entity.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;Ignore&quot; /&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>There is only one possible response.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    actionTaken=&quot;Ignored&quot; /&gt;
        </pre>
    </div>
    <h4>Mapping Properties</h4>
    <p>A mapping can also have properties specified. Properties are specified as a key value map. The currently supported properties are:</p>
    <table class="properties-table" cellpadding="0" cellspacing="0">
        <tr><td><a class="anchor" id="failonexisting">NewOrExisting</a>FailOnExisting</td><td>This is a boolean property that can be applied to any mapping type. If true it will fail with a 409 if an entity with the same ID exists on the target. The possible values are 'true' or 'false'. If this is not specified false is assumed. Example Failure response:
            <div class="code"><pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    errorType=&quot;TargetExists&quot; /&gt;
            </pre></div>
        </td></tr>
        <tr><td><a class="anchor" id="failonnew">FailOnNew</a>FailOnNew</td><td>This is a boolean property that can be applied to any mapping type. If true it will fail with a 409 if an entity with the same ID DOES NOT EXIST on the target. The possible values are 'true' or 'false'. If this is not specified false is assumed. Example Failure response:
            <div class="code"><pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    errorType=&quot;TargetNotFound&quot; /&gt;
            </pre></div>
        </td></tr>
        <tr><td>MapBy</td><td>This can specify the unique key to map the target by. The possible values are 'name' or 'guid'. If this is not specified mapping is done by the ID. There is also a special mapping, 'mapByRoleEntity', this is used to map a auto created role to an auto created role on the target gateway. This mapping is automatically set when doing a full gateway export. Another special mapping, 'moduleSha256' is used to map a ServerModuleFile using its content digest on the target Gateway. This is the default mapping when exporting ServerModuleFile(s).</td></tr>
        <tr><td>MapTo</td><td>This allow mapping to a different entity. The default it to map to an entity on the target with the same mapTo property. This is only used with the mapBy property.</td></tr>
    </table>
    <h4>Complex Mapping Examples</h4>
    <h5>Mapping by Name</h5>
    <p>Map a policy to a policy on the target Gateway with the same name.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;POLICY&quot;
     srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
     srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
     action=&quot;NewOrUpdate&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;mapBy&quot; value=&quot;name&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>If an entity with the same Name DOES NOT exist on the target Gateway this will create a new entity with the ID specified.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot; &gt;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;mapBy&quot; value=&quot;name&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name exist on the target Gateway this will update the entity.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot; &gt;
    actionTaken=&quot;UpdatedExisting&quot;
    targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/8756846868e6eb676bf4ed8a9bfba04b&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;mapBy&quot; value=&quot;name&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name DOES NOT exist on the target Gateway but one with the same ID does, this will fail.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrUpdate&quot; &gt;
    errorType=&quot;UniqueKeyConflict&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:Property key=&quot;ErrorMessage&quot;&gt;
            &lt;l7:StringValue&gt;Other entity exists with the given id: 97cd0afb295cd2d823d0fdd43e720bbc&lt;/l7:StringValue&gt;
        &lt;/l7:Property&gt;
        &lt;l7:Property key=&quot;MapBy&quot;&gt;
            &lt;l7:StringValue&gt;name&lt;/l7:StringValue&gt;
        &lt;/l7:Property&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:Mapping&gt;
        </pre>
    </div>
    <h5>Mapping by Name to a Specific Entity</h5>
    <p>Map a service to a service on the target Gateway with a specific name.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;POLICY&quot;
     srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
     srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
     action=&quot;NewOrExisting&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>If an entity with the target name DOES NOT exist on the target Gateway this will create a new entity with the ID specified, and the mapTo name ("MyTargetService").</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the target name exist on the target Gateway this will do nothing, used the existing service.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    actionTaken=&quot;UsedExisting&quot;
    targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/8756846868e6eb676bf4ed8a9bfba04b&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the target name DOES NOT exist on the target Gateway but one with the same ID does, this will fail.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    errorType=&quot;UniqueKeyConflict&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:Property key=&quot;ErrorMessage&quot;&gt;
            &lt;l7:StringValue&gt;Other entity exists with the given id: 7d428d5529fece370bc3cb5b44027ba0&lt;/l7:StringValue&gt;
        &lt;/l7:Property&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h5>Mapping by ID where Entity Must Exist on the Target</h5>
    <p>Map a service to a service on the target Gateway. The service must exist on the target Gateway.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;POLICY&quot;
     srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
     srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
     action=&quot;NewOrExisting&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>If an entity with the same ID DOES NOT exist on the target Gateway this will fail.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    errorType=&quot;TargetNotFound&quot; &gt;
    &lt;l7:Properties&gt;
       &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same ID exist on the target Gateway this will do nothing, used the existing service.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;POLICY&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    action=&quot;NewOrExisting&quot;
    actionTaken=&quot;UsedExisting&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/policies/97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>

    <h5>Mapping by Name to Specific Entity Do Not Fail on ID Clash </h5>
    <p>Map a service to a service on the target Gateway with a specific name. Do not fail if a service with the same ID exists on the target Gateway.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;SERVICE&quot;
     srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
     srcUri=&quot;https://ssgsource/restman/1.0/services/97cd0afb295cd2d823d0fdd43e720bbc&quot;
     action=&quot;AlwaysCreateNew&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>If an entity with the same Name DOES NOT exist on the target Gateway this will create a new entity with the ID specified, and the mapTo name ("MyTargetService").</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;SERVICE&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/services/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/services/97cd0afb295cd2d823d0fdd43e720bbc&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name exist on the target Gateway this will fail with unique key conflict.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;SERVICE&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/services/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    errorType=&quot;UniqueKeyConflict&quot;
    targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/services/8756846868e6eb676bf4ed8a9bfba04b&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name DOES NOT exist on the target Gateway but one with the same ID does, this will create a new entity with a new ID, and the mapTo name ("MyTargetService").</p>
    <div class="code">
        <pre>
&lt;l7:mapping
    type=&quot;SERVICE&quot;
    srcId=&quot;97cd0afb295cd2d823d0fdd43e720bbc&quot;
    srcUri=&quot;https://ssgsource/restman/1.0/services/97cd0afb295cd2d823d0fdd43e720bbc&quot;
    actionTaken=&quot;CreatedNew&quot;
    targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
    targetUri=&quot;https://ssgtarget/restman/1.0/services/8756846868e6eb676bf4ed8a9bfba04b&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot; /&gt;
    &lt;l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h5>Delete by Name a Specific Entity Fail if Entity Does Not Exist</h5>
    <p>Delete a service on the target gateway with the name 'MyTargetService'. If the service does not exist fail the bundle import.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;SERVICE&quot;
     action=&quot;Delete&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot;
        &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <h6>Possible Responses</h6>
    <p>If an entity with the same Name exists on the target Gateway this will delete the entity.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;SERVICE&quot;
     action=&quot;Delete&quot;
     actionTaken=&quot;Deleted&quot;
     targetId=&quot;8756846868e6eb676bf4ed8a9bfba04b&quot;
     targetUri=&quot;https://ssgtarget/restman/1.0/services/8756846868e6eb676bf4ed8a9bfba04b&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot;
        &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name DOES NOT exist on the target Gateway this will fail.</p>
    <div class="code">
        <pre>
&lt;l7:mapping
     type=&quot;SERVICE&quot;
     action=&quot;Delete&quot; &gt;
    &lt;l7:Properties&gt;
        &lt;l7:Property key=&quot;ErrorMessage&quot;&gt;
            &lt;l7:StringValue&gt;Could not locate entity: Fail on new specified and could not locate existing target. Source Entity: EntityHeader. Name=MyTargetService, id=null, description=null, type = SERVICE&lt;/l7:StringValue&gt;
        &lt;/l7:Property&gt;
        &lt;l7:property key=&quot;MapBy&quot; value=&quot;name&quot; /&gt;
        &lt;l7:property key=&quot;MapTo&quot; value=&quot;MyTargetService&quot;
        &lt;l7:property key=&quot;FailOnNew&quot; value=&quot;true&quot; /&gt;
    &lt;/l7:Properties&gt;
&lt;/l7:mapping&gt;
        </pre>
    </div>
    <p>If an entity with the same Name exist on the target Gateway this will fail with unique key conflict.</p>
    <h3>Supporting Large Migrations</h3>
    <p>By default the REST Management Service accepts requests up to 50MB in size. If you need to increase the maximum message size that the REST Management Service can accept edit the <span class="italicize">restman.request.message.maxSize</span> cluster property.</p>
    <h3>Migration Example</h3>
    <p>For an example migration work-flow see:</p>
    <p class="code indent"><a href="$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/doc/migration-example.html">$#{scheme}://$#{host}:$#{port}/$#{service-url}/1.0/doc/migration-example.html</a></p>
</div>