<?xml version="1.0" encoding="UTF-8"?>
<enumeration>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="60cec430-0767-429c-8eff-62891c2eb343"
               id="123961350" version="6">
        <l7:PolicyDetail folderId="123600897" guid="60cec430-0767-429c-8eff-62891c2eb343" id="123961350" version="6">
            <l7:Name>OAuth 1.0 Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>7</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Policy Fragment: OAuth Context Variables"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_ovp_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0My9hdXRoL29hdXRoL3YxL2F1dGhvcml6ZS93ZWJzaXRl"/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_v1_server_website"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_v1_server_website_baseuri"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="host_oauth_ovp_server"/&gt;
                    &lt;L7p:item stringValue="host_oauth_v1_server_website"/&gt;
                    &lt;L7p:item stringValue="host_oauth_v1_server_website_baseuri"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="a1d0576f-ad44-4142-bd1f-e7b15c37d52f"
               id="123731970" version="2">
        <l7:PolicyDetail folderId="123600903" guid="a1d0576f-ad44-4142-bd1f-e7b15c37d52f" id="123731970" version="2">
            <l7:Name>Require OAuth 1.0 Token</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="The fragment enables an API/ Service endpoint to require a valid oauth
                    access token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Input: the http request including the oauth header"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Output: oauth_consumer_key, oauth_token, oauth_verifier,
                    authorizationHeader"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="60cec430-0767-429c-8eff-62891c2eb343"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="35aa8869-8319-44e0-a6b6-2ed2ce59001e"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtwYXJhbXN9"/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${host_oauth_ovp_server}/oauth/validation/validate/v1/signature"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="params"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/result[text()='valid']"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validate signature"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="fded77d9-893f-4dcd-99bf-859988d65072"
               id="123731972" version="0">
        <l7:PolicyDetail folderId="123600898" guid="fded77d9-893f-4dcd-99bf-859988d65072" id="123731972" version="0">
            <l7:Name>getClientSignature</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>1</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Generates the HMAC-SHA1 signature for the test client"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Input: consumer_key_secret, http_method, url, oauth_consumer_key, oauth_callback, oauth_token, oauth_verifier"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="http_method = GET | POST"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="url = target URL that shall be called"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="oauth_callback (optional) - for request tokens"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="oauth_token (optional) - for authorized request or access tokens"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="oauth_verifier (optional) - for authorized request tokens"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Policy Fragment: getClientSignature"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="url"/&gt;
                    &lt;L7p:Regex stringValue="#.+$"/&gt;
                    &lt;L7p:RegexName stringValue="remove fragment"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="urlQuery"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="url"/&gt;
                    &lt;L7p:Regex stringValue="([^?]+)([?].+)$"/&gt;
                    &lt;L7p:RegexName stringValue="get the query part"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxRdWVyeVsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxRdWVyeVsyXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="sigQuery"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="sigQuery"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:GenerateOAuthSignatureBaseString&gt;
                    &lt;L7p:HttpMethod stringValue="${http_method}"/&gt;
                    &lt;L7p:OauthCallback stringValue="${oauth_callback}"/&gt;
                    &lt;L7p:OauthConsumerKey stringValue="${oauth_consumer_key}"/&gt;
                    &lt;L7p:OauthToken stringValue="${oauth_token}"/&gt;
                    &lt;L7p:OauthVerifier stringValue="${oauth_verifier}"/&gt;
                    &lt;L7p:QueryString stringValue="${sigQuery}"/&gt;
                    &lt;L7p:RequestUrl stringValue="${url}"/&gt;
                    &lt;/L7p:GenerateOAuthSignatureBaseString&gt;
                    &lt;L7p:GenerateSecurityHash&gt;
                    &lt;L7p:Base64Data stringValue="JHtvYXV0aC5zaWdCYXNlU3RyaW5nfQ=="/&gt;
                    &lt;L7p:KeyText stringValue="${consumer_key_secret}&amp;amp;${token_secret}"/&gt;
                    &lt;L7p:LineBreak lineBreak="CR-LF"/&gt;
                    &lt;L7p:TargetOutputVariable stringValue="signature"/&gt;
                    &lt;/L7p:GenerateSecurityHash&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="signature"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="signature"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="For debugging purposes only"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Detail stringValue="SignatureBaseString: ${oauth.sigBaseString}, secret_for_signature:
                    '${consumer_key_secret}&amp;amp;${token_secret}', ssg_signature: ${signature}"/&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;L7p:Level stringValue="WARNING"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="oauth.oauth_callback"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_consumer_key"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_nonce"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_signature_method"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_timestamp"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_token"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_verifier"/&gt;
                    &lt;L7p:item stringValue="oauth.oauth_version"/&gt;
                    &lt;L7p:item stringValue="oauth_callback"/&gt;
                    &lt;L7p:item stringValue="oauth_consumer_key"/&gt;
                    &lt;L7p:item stringValue="signature"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="35aa8869-8319-44e0-a6b6-2ed2ce59001e"
               id="123731969" version="0">
        <l7:PolicyDetail folderId="123600902" guid="35aa8869-8319-44e0-a6b6-2ed2ce59001e" id="123731969" version="0">
            <l7:Name>Authenticate OAuth 1.0 Parameter</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>1</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="The fragment enables an API/ Service endpoint to require a valid oauth
                    access token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Input: the http request including the oauth header"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Output: oauth_consumer_key, oauth_token, oauth_verifier,
                    authorizationHeader"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Policy Fragment: Authenticate OAuth 1.0 Parameter"/&gt;
                    &lt;/L7p:AuditDetailAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="POST"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="POST"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="GET is optional according to oauth 1.0/ 1.0a"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="GET"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="GET"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:JdbcQuery&gt;
                    &lt;L7p:AssertionFailureEnabled booleanValue="false"/&gt;
                    &lt;L7p:ConnectionName stringValue="OAuth"/&gt;
                    &lt;L7p:SqlQuery stringValueReference="inline"&gt;&lt;![CDATA[select ock.client_key, ock.secret,
                    ock.scope, ock.callback, ock.environment, ock.expiration, ock.status, ock.client_ident, ock.created,
                    ock.created_by, ock.client_name
                    from oauth_client_key ock
                    where ock.client_key = ${request.http.parameter.client_key}]]&gt;&lt;/L7p:SqlQuery&gt;
                    &lt;/L7p:JdbcQuery&gt;

                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Only POST and GET permitted"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtyZXF1ZXN0Lmh0dHAubWV0aG9kfSBub3QgcGVybWl0dGVk"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus intValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="POST or GET"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="oauthSig"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="request.http.header.Authorization"/&gt;
                    &lt;L7p:Regex stringValue="oauth_signature=\&amp;quot;([^&amp;quot;]{1,100})\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="oauthSig"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aFNpZ1sxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_signature"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HtmlFormDataAssertion&gt;
                    &lt;L7p:AllowGet booleanValue="true"/&gt;
                    &lt;L7p:AllowPost booleanValue="true"/&gt;
                    &lt;L7p:FieldSpecs htmlFormFieldSpecArray="included"&gt;
                    &lt;L7p:item htmlFormFieldSpec="included"&gt;
                    &lt;L7p:AllowEmpty boxedBooleanValue="false"/&gt;
                    &lt;L7p:DataType fieldDataType="any"/&gt;
                    &lt;L7p:MaxOccurs intValue="1"/&gt;
                    &lt;L7p:MinOccurs intValue="1"/&gt;
                    &lt;L7p:Name stringValue="oauth_signature"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:FieldSpecs&gt;
                    &lt;/L7p:HtmlFormDataAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLm9hdXRoX3NpZ25hdHVyZX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_signature"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="oauth_signature"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="oauth_signature"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue=" request"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="TWlzc2luZyBvYXV0aF9zaWduYXR1cmU="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus intValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="not found"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="get signature"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9"/&gt;
                    &lt;L7p:VariableToSet stringValue="url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="url"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="url"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5xdWVyeX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="query"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${query}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="query"/&gt;
                    &lt;L7p:Regex stringValue="^[?]"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="query"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="query"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JnF1ZXJ5PSR7cXVlcnl9"/&gt;
                    &lt;L7p:VariableToSet stringValue="query"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="query"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:GenerateOAuthSignatureBaseString&gt;
                    &lt;L7p:UsageMode usageMode="SERVER"/&gt;
                    &lt;/L7p:GenerateOAuthSignatureBaseString&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtvYXV0aC5lcnJvcn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus intValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="use Generate OAuth Signature Base String to retrieve and validate oauth
                    parameters"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${oauth.oauth_signature_method}"/&gt;
                    &lt;L7p:Expression2 stringValue="HMAC-SHA1"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="HMAC-SHA1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF9zaWduYXR1cmVfbWV0aG9kfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_signature_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="SW52YWxpZCBvYXV0aF9zaWduYXR1cmVfbWV0aG9kOiAke29hdXRoLm9hdXRoX3NpZ25hdHVyZV9tZXRob2R9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="set signature method"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF9jb25zdW1lcl9rZXl9"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_consumer_key"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF90aW1lc3RhbXB9"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_timestamp"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF9ub25jZX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_nonce"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="b2F1dGhfc2lnbmF0dXJlPSR7b2F1dGhfc2lnbmF0dXJlfSZvYXV0aF9jb25zdW1lcl9rZXk9JHtvYXV0aC5vYXV0aF9jb25zdW1lcl9rZXl9"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${oauth.requestType}"/&gt;
                    &lt;L7p:Expression2 stringValue="request token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="request token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF9jYWxsYmFja30="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_callback"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="request token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${oauth.requestType}"/&gt;
                    &lt;L7p:Expression2 stringValue="authorized request token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="authorized request token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF90b2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF92ZXJpZmllcn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_verifier"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtvYXV0aF9wYXJhbXN9Jm9hdXRoX3Rva2VuPSR7b2F1dGhfdG9rZW59Jm9hdXRoX3ZlcmlmaWVyPSR7b2F1dGhfdmVyaWZpZXJ9"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="authorized request token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${oauth.requestType}"/&gt;
                    &lt;L7p:Expression2 stringValue="access token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="access token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aC5vYXV0aF90b2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aF9wYXJhbXN9Jm9hdXRoX3Rva2VuPSR7b2F1dGhfdG9rZW59"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="access token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="request type specific handling"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="oauth.sigBaseString"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="oauth.sigBaseString"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtvYXV0aF9wYXJhbXN9JnNpZ25hdHVyZUJhc2VTdHJpbmc9JHtvYXV0aC5zaWdCYXNlU3RyaW5nfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtvYXV0aF9ub25jZX0ke29hdXRoX3RpbWVzdGFtcH0ke29hdXRoX3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="replay_arg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:WssReplayProtection&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Set the right timeframe!"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CustomExpiryTime intValue="300000"/&gt;
                    &lt;L7p:CustomIdentifierVariable stringValue="replay_arg"/&gt;
                    &lt;L7p:CustomProtection booleanValue="true"/&gt;
                    &lt;L7p:CustomScope stringValue="${service.oid}"/&gt;
                    &lt;/L7p:WssReplayProtection&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="VG9vIG1hbnkgcmVxdWVzdHM="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check for replay attacks"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="oauth_consumer_key"/&gt;
                    &lt;L7p:item stringValue="oauth_token"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="d1d995ab-c7c8-4354-b005-ec3deeedc3a5"
               id="123961345" version="4">
        <l7:PolicyDetail folderId="123600896" guid="d1d995ab-c7c8-4354-b005-ec3deeedc3a5" id="123961345" version="4">
            <l7:Name>Token Lifetime Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>5</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
                    &lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MzYwMA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth2_access_token_lifetime_sec&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth_v1_consumer_key_lifetime_m&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;ODY0MDA=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth_v1_access_token_lifetime_s&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MzAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth_v1_request_token_lifetime_s&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NjAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth2_auth_code_lifetime_sec&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MzYwMA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth2_access_token_lifetime_sec&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;NjA0ODAw&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;oauth2_refresh_token_lifetime_sec&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue=&quot;included&quot;&gt;
                    &lt;L7p:item stringValue=&quot;oauth2_access_token_lifetime_sec&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;oauth2_auth_code_lifetime_sec&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;oauth2_refresh_token_lifetime_sec&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;oauth_v1_access_token_lifetime_s&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;oauth_v1_consumer_key_lifetime_m&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;oauth_v1_request_token_lifetime_s&quot;/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="585c3a3d-8fd7-4337-8d91-46846bfc4194"
               id="123731968" version="0">
        <l7:PolicyDetail folderId="123600896" guid="585c3a3d-8fd7-4337-8d91-46846bfc4194" id="123731968" version="0">
            <l7:Name>GenerateOAuthToken</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>15</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
                    &lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Poilcy issues tokens and token secrets&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Input: token_type=urt|art|at|ck|ac|at_2|rft&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;urt=unauthorized request token, art=authorized request token,
                    at=access token, ck=client_key&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;ac=authorization_code, at_2=access_token for oauth 2.0,
                    rft=refresh_token&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Output: genToken, genSecret, genExpiration&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue=&quot;Configurable values: lifetime for tokens&quot;/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue=&quot;d1d995ab-c7c8-4354-b005-ec3deeedc3a5&quot;/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Operator operatorNull=&quot;null&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item regex=&quot;included&quot;&gt;
                    &lt;L7p:Pattern stringValue=&quot;urt|art&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth_v1_request_token_lifetime_s}&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;unauthorized/ authorized request token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;at&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;at&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth_v1_access_token_lifetime_s}&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;access token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;ck&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;ck&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${oauth_v1_consumer_key_lifetime_m}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;0&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:CaseSensitive booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:Operator operator=&quot;GT&quot;/&gt;
                    &lt;L7p:RightValue stringValue=&quot;0&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth_v1_consumer_key_lifetime_m}&quot;/&gt;
                    &lt;L7p:DateOffsetField intValue=&quot;12&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;MA==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration.millis&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;client_key&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;ac&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;ac&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth2_auth_code_lifetime_sec}&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;authorization_code&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;at_2&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;at_2&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth2_access_token_lifetime_sec}&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;access token oauth 2.0&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue=&quot;${token_type}&quot;/&gt;
                    &lt;L7p:Expression2 stringValue=&quot;rft&quot;/&gt;
                    &lt;L7p:Predicates predicates=&quot;included&quot;&gt;
                    &lt;L7p:item binary=&quot;included&quot;&gt;
                    &lt;L7p:RightValue stringValue=&quot;rft&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;&quot;/&gt;
                    &lt;L7p:DataType variableDataType=&quot;dateTime&quot;/&gt;
                    &lt;L7p:DateOffsetExpression stringValue=&quot;${oauth2_refresh_token_lifetime_sec}&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;expiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;refresh token oauth 2.0&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;Set the lifetime for the token&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:UUIDGenerator&gt;
                    &lt;L7p:AssertionComment assertionComment=&quot;included&quot;&gt;
                    &lt;L7p:Properties mapValue=&quot;included&quot;&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue=&quot;RIGHT.COMMENT&quot;/&gt;
                    &lt;L7p:value stringValue=&quot;Generate the token and the secret&quot;/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Quantity stringValue=&quot;2&quot;/&gt;
                    &lt;L7p:TargetVariable stringValue=&quot;tokenSecret&quot;/&gt;
                    &lt;/L7p:UUIDGenerator&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt0b2tlblNlY3JldFswXX0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;genToken&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHt0b2tlblNlY3JldFsxXX0=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;genSecret&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtleHBpcmF0aW9uLm1pbGxpc30=&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;genExpiration&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue=&quot;included&quot;&gt;
                    &lt;L7p:item stringValue=&quot;genExpiration&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;genSecret&quot;/&gt;
                    &lt;L7p:item stringValue=&quot;genToken&quot;/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="f0eb1f7b-392b-40a4-9f4f-46d00ffad3d3"
               id="123961351" version="2">
        <l7:PolicyDetail folderId="123600896" guid="f0eb1f7b-392b-40a4-9f4f-46d00ffad3d3" id="123961351" version="2">
            <l7:Name>OAuth Client Token Store Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
                    &lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
                    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;host_oauth_tokenstore_server&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;host_oauth_clientstore_server&quot;/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
</enumeration>
