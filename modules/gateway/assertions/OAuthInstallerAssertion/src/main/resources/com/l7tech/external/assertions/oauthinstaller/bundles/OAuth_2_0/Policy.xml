<?xml version="1.0" encoding="UTF-8"?>
<enumeration>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="dfdc6c16-7c02-4415-b0e1-b4a9de10316f"
               id="57477c668279c3c8d34da687b89a7721" version="12">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a75a1" guid="dfdc6c16-7c02-4415-b0e1-b4a9de10316f"
                         id="57477c668279c3c8d34da687b89a7721" version="12">
            <l7:Name>OAuth 2.0 Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>11</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="BEARER or MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="QkVBUkVS"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_token_type"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_ovp_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth2_auth_template_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="L2F1dGgvb2F1dGgvdjIvYXV0aG9yaXplL3dlYnNpdGU="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_auth_template_path"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MTAw"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_client_max_fail_per_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MTAw"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_resource_owner_max_fail_per_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth2_auth_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="L2F1dGgvb2F1dGgvdjIvYXV0aG9yaXpl"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_auth_path"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="L2F1dGgvb2F1dGgvdjIvdG9rZW4="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_token_path"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Mi4wIChSRkMgNjc0OSk="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_version"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="oauth2_auth_path"/&gt;
                    &lt;L7p:item stringValue="host_oauth2_auth_server"/&gt;
                    &lt;L7p:item stringValue="oauth2_auth_template_path"/&gt;
                    &lt;L7p:item stringValue="host_oauth2_auth_template_server"/&gt;
                    &lt;L7p:item stringValue="oauth2_client_max_fail_per_sec"/&gt;
                    &lt;L7p:item stringValue="oauth2_resource_owner_max_fail_per_sec"/&gt;
                    &lt;L7p:item stringValue="oauth2_token_path"/&gt;
                    &lt;L7p:item stringValue="oauth2_token_type"/&gt;
                    &lt;L7p:item stringValue="host_oauth_ovp_server"/&gt;
                    &lt;L7p:item stringValue="oauth2_version"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="683d721b-2a6f-4d44-b484-aae0e64989b6"
               id="57477c668279c3c8d34da687b89a7735" version="1">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a74a9" guid="683d721b-2a6f-4d44-b484-aae0e64989b6"
                         id="57477c668279c3c8d34da687b89a7735" version="1">
            <l7:Name>v2GenerateRequestMac</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Generates request MAC using HMAC-SHA1 algorithm"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Inputs: timestamp_sec, nonce, http_method, url, ext, mac_key,
                    mac_algorithm"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Outputs: mac"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Validate inputs =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${timestamp_sec}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="timestamp_sec"/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue="false"/&gt;
                    &lt;L7p:Regex stringValue="^0+"/&gt;
                    &lt;L7p:RegexName stringValue="Timestamp must not have leading zeros"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="timestamp_sec"/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue="false"/&gt;
                    &lt;L7p:Regex stringValue="^-"/&gt;
                    &lt;L7p:RegexName stringValue="Timestamp must be a positive number"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${nonce}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${http_method}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="http_method"/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue="false"/&gt;
                    &lt;L7p:Regex stringValue="[a-z]"/&gt;
                    &lt;L7p:RegexName stringValue="HTTP method must be in upper case"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${url}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${mac_key}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${mac_algorithm}"/&gt;
                    &lt;L7p:Expression2 stringValue="hmac-sha-1"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="hmac-sha-1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Break URL into parts (protocol, hostname+port, path)
                    =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="url_sub_string"/&gt;
                    &lt;L7p:FindAll booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="url"/&gt;
                    &lt;L7p:Regex stringValue="([a-z]*)://([^/]*)(.*)"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxfc3ViX3N0cmluZ1szXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="request_uri"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxfc3ViX3N0cmluZ1syXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="url_hostname_port"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="host"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="port"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="url_hostname_port_sub_string"/&gt;
                    &lt;L7p:FindAll booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="url_hostname_port"/&gt;
                    &lt;L7p:Regex stringValue="([^:]*):([0-9]*)"/&gt;
                    &lt;L7p:RegexName stringValue="get hostname and port number"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxfaG9zdG5hbWVfcG9ydF9zdWJfc3RyaW5nWzFdfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxfaG9zdG5hbWVfcG9ydF9zdWJfc3RyaW5nWzJdfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="port"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="port is specified"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt1cmxfaG9zdG5hbWVfcG9ydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="host"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${url_sub_string[1]}"/&gt;
                    &lt;L7p:Expression2 stringValue="http"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="http"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ODA="/&gt;
                    &lt;L7p:VariableToSet stringValue="port"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${url_sub_string[1]}"/&gt;
                    &lt;L7p:Expression2 stringValue="https"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="https"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NDQz"/&gt;
                    &lt;L7p:VariableToSet stringValue="port"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Use default port"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="port is not specified"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Get hostname and port number"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check if there are any uppercases in hostname"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:FindAll booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="host"/&gt;
                    &lt;L7p:Regex stringValue="[A-Z]"/&gt;
                    &lt;L7p:RegexName stringValue="Check for uppercase"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PGhvc3RuYW1lPiR7aG9zdH08L2hvc3RuYW1lPg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="xml"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4bWx9"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="forXSL"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:XslTransformation&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="forXSL"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                    &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;xsl:stylesheet version="1.0"
                    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
                    &lt;xsl:output method="text" omit-xml-declaration="yes"/&gt;

                    &lt;xsl:variable name="lowercase" select="'abcdefghijklmnopqrstuvwxyz'"/&gt;
                    &lt;xsl:variable name="uppercase" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/&gt;

                    &lt;xsl:template match="/hostname"&gt;
                    &lt;xsl:value-of select="translate(., $uppercase, $lowercase)"/&gt;
                    &lt;/xsl:template&gt;

                    &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;/L7p:XslTransformation&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtmb3JYU0wubWFpbnBhcnR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="host"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Change hostname to lowercase"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request_uri}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${host}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${port}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="request_uri"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="request_uri"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:LineBreak lineBreak="LF"/&gt;
                    &lt;L7p:VariableToSet stringValue="empty_line"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHt0aW1lc3RhbXBfc2VjfQ0KJHtub25jZX0NCiR7aHR0cF9tZXRob2R9DQoke3JlcXVlc3RfdXJpfQ0KJHtob3N0fQ0KJHtwb3J0fQ0KJHtleHR9DQoke2VtcHR5X2xpbmV9"/&gt;
                    &lt;L7p:VariableToSet stringValue="normalized_request"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:GenerateSecurityHash&gt;
                    &lt;L7p:Base64Data stringValue="JHtub3JtYWxpemVkX3JlcXVlc3R9"/&gt;
                    &lt;L7p:KeyText stringValue="${mac_key}"/&gt;
                    &lt;L7p:LineBreak lineBreak="CR-LF"/&gt;
                    &lt;L7p:TargetOutputVariable stringValue="mac"/&gt;
                    &lt;/L7p:GenerateSecurityHash&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="mac"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="9481f86f-4c50-4500-b496-a5fa5a4a98b9"
               id="57477c668279c3c8d34da687b89a7748" version="1">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a75e1" guid="9481f86f-4c50-4500-b496-a5fa5a4a98b9"
                         id="57477c668279c3c8d34da687b89a7748" version="1">
            <l7:Name>v2GenerateAuthHeaderForClient</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Generates Authorization Header"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Inputs: token, target_url, target_http_method"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Outputs: authorization_header"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="bGF5ZXI3"/&gt;
                    &lt;L7p:VariableToSet stringValue="ext"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="at"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;access_token\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate the access token itself"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="at"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="access_token\=([^&amp;amp;]*)"/&gt;
                    &lt;L7p:RegexName stringValue="isolate the access token itself - for implicit grant_type"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthdFsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="token_type"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;token_type\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate token type"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="token_type"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="token_type\=([^&amp;amp;]*)"/&gt;
                    &lt;L7p:RegexName stringValue="isolate token type - for implicit grant_type"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type[1]}"/&gt;
                    &lt;L7p:Expression2 stringValue="Bearer"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="Bearer"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="QmVhcmVyICR7YWNjZXNzX3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="authorization_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=Bearer"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type[1]}"/&gt;
                    &lt;L7p:Expression2 stringValue="mac"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="mac"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnYXRld2F5LnRpbWUuc2Vjb25kc30="/&gt;
                    &lt;L7p:VariableToSet stringValue="timestamp_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:UUIDGenerator&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Generate nonce"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:TargetVariable stringValue="nonce"/&gt;
                    &lt;/L7p:UUIDGenerator&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0YXJnZXRfaHR0cF9tZXRob2R9"/&gt;
                    &lt;L7p:VariableToSet stringValue="http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0YXJnZXRfdXJsfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="mk"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;mac_key\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate mac key"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="mk"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="mac_key\=([^&amp;amp;]*)"/&gt;
                    &lt;L7p:RegexName stringValue="isolate mac key - for implicit grant_type"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtta1sxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="mac_key"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="ma"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;mac_algorithm\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate mac algorithm"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="ma"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="token"/&gt;
                    &lt;L7p:Regex stringValue="mac_algorithm\=([^&amp;amp;]*)"/&gt;
                    &lt;L7p:RegexName stringValue="isolate mac algorithm - for implicit grant_type"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHttYVsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="mac_algorithm"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="683d721b-2a6f-4d44-b484-aae0e64989b6"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${ext}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="TUFDIGlkPSIke2FjY2Vzc190b2tlbn0iLCB0cz0iJHt0aW1lc3RhbXBfc2VjfSIsIG5vbmNlPSIke25vbmNlfSIsIGV4dD0iJHtleHR9IiwgbWFjPSIke21hY30i"/&gt;
                    &lt;L7p:VariableToSet stringValue="authorization_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${ext}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:ExpressionIsVariable booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="TUFDIGlkPSIke2FjY2Vzc190b2tlbn0iLCB0cz0iJHt0aW1lc3RhbXBfc2VjfSIsIG5vbmNlPSIke25vbmNlfSIsIG1hYz0iJHttYWN9Ig=="/&gt;
                    &lt;L7p:VariableToSet stringValue="authorization_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Build Authorization Header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=mac"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="authorization_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Invalid token_type"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="authorization_header"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="e418c4cb-b910-49a7-b9f5-aa6ee18d21f9"
               id="57477c668279c3c8d34da687b89a775b" version="27">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a76a1" guid="e418c4cb-b910-49a7-b9f5-aa6ee18d21f9"
                         id="57477c668279c3c8d34da687b89a775b" version="27">
            <l7:Name>Require OAuth 2.0 Token</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>28</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Include this policy in a service policy to authorize api access based
                    on an oauth 2.0 access token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This policy exports these variables: session.scope, session.client_id,
                    session.subscriber_id, session.expires_in, session.scheme, session.access_token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="dfdc6c16-7c02-4415-b0e1-b4a9de10316f"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="=== If the token is found at multiple locations the policy will fail"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Allow Token in Header?"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="allow_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Allow token as parameter?"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="allow_query"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Change this value as desired"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validation result"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="MzA="/&gt;
                    &lt;L7p:VariableToSet stringValue="cache_lifetime"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Will be set to MAC or Bearer"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="auth_scheme"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLmF1dGhvcml6YXRpb259"/&gt;
                    &lt;L7p:VariableToSet stringValue="auth_header"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5hY2Nlc3NfdG9rZW59"/&gt;
                    &lt;L7p:VariableToSet stringValue="auth_param_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ZmFsc2U="/&gt;
                    &lt;L7p:VariableToSet stringValue="hasError"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${allow_query}"/&gt;
                    &lt;L7p:Expression2 stringValue="true"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_header}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${auth_param_token}"/&gt;
                    &lt;L7p:MultivaluedComparison multivaluedComparison="FAIL"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item dataType="included"&gt;
                    &lt;L7p:Type variableDataType="string"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="QmVhcmVy"/&gt;
                    &lt;L7p:VariableToSet stringValue="auth_scheme"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthdXRoX3BhcmFtX3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="LOCATE AS PARAMETER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${allow_header}"/&gt;
                    &lt;L7p:Expression2 stringValue="true"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_param_token}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="schema_token"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="auth_header"/&gt;
                    &lt;L7p:Regex stringValue="^\b([Bb][Ee][Aa][Rr][Ee][Rr]|MAC)\b\s(.{1,256})$"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtzY2hlbWFfdG9rZW5bMV19"/&gt;
                    &lt;L7p:VariableToSet stringValue="auth_scheme"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="for MAC this will contain MAC values, not the access_token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="JHtzY2hlbWFfdG9rZW5bMl19"/&gt;
                    &lt;L7p:VariableToSet stringValue="access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="LOCATE IN HEADER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_header}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_param_token}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="dHJ1ZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="hasError"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${auth_scheme}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{
                    "error":"invalid_request",
                    "error_description":"Missing access token"
                    }]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Pragma"/&gt;
                    &lt;L7p:Value stringValue="no-cache"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Cache-Control"/&gt;
                    &lt;L7p:Value stringValue="no-store"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="WWW-Authenticate"/&gt;
                    &lt;L7p:Value stringValue="${auth_scheme} error=&amp;quot;Missing access token&amp;quot;"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="401"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{
                    "error":"invalid_request",
                    "error_description":"Missing access token"
                    }]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Pragma"/&gt;
                    &lt;L7p:Value stringValue="no-cache"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Cache-Control"/&gt;
                    &lt;L7p:Value stringValue="no-store"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="401"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add WWW-Authenticate header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${hasError}"/&gt;
                    &lt;L7p:Expression2 stringValue="false"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="false"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_header}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="auth_header"/&gt;
                    &lt;L7p:Regex stringValue="^\b([Bb][Ee][Aa][Rr][Ee][Rr]|MAC)\b\s"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_param_token}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${auth_scheme}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{
                    "error":"invalid_request",
                    "error_description":"Duplicate access token"
                    }]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Pragma"/&gt;
                    &lt;L7p:Value stringValue="no-cache"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Cache-Control"/&gt;
                    &lt;L7p:Value stringValue="no-store"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="WWW-Authenticate"/&gt;
                    &lt;L7p:Value stringValue="${auth_scheme} error=&amp;quot;Duplicate access token&amp;quot;"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="401"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{
                    "error":"invalid_request",
                    "error_description":"Duplicate access token"
                    }]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Pragma"/&gt;
                    &lt;L7p:Value stringValue="no-cache"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Cache-Control"/&gt;
                    &lt;L7p:Value stringValue="no-store"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="401"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add WWW-Authenticate header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="MULTIPLE ACCESS_TOKEN"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="MISSING TOKEN"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Make it available as variable"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Find the access_token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${access_token}"/&gt;
                    &lt;L7p:CacheId stringValue="accessTokenValidation"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue="text/xml"/&gt;
                    &lt;L7p:MaxEntryAgeSeconds stringValue="${cache_lifetime}"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="validationResult"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${auth_scheme}"/&gt;
                    &lt;L7p:Expression2 stringValue="Bearer"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="Bearer"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="emptyMessage"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${host_oauth_ovp_server}/oauth/validation/validate/v2/token?access_token=${access_token}&amp;amp;auth_scheme=${auth_scheme}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="emptyMessage"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${access_token}"/&gt;
                    &lt;L7p:CacheId stringValue="accessTokenValidation"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeSeconds stringValue="${cache_lifetime}"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="validationResult"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${auth_scheme}"/&gt;
                    &lt;L7p:Expression2 stringValue="MAC"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="MAC"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAubWV0aG9kfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="request_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="request_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="request_url"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="request_url"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="aHR0cF9tZXRob2Q9JHtyZXF1ZXN0X2h0dHBfbWV0aG9kfSZ1cmw9JHtyZXF1ZXN0X3VybH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="params"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="YXV0aF9zY2hlbWU9JHthdXRoX3NjaGVtZX0maHR0cF9tZXRob2Q9JHtyZXF1ZXN0X2h0dHBfbWV0aG9kfSZ1cmw9JHtyZXF1ZXN0X3VybH0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded; charset=UTF-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="message"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${host_oauth_ovp_server}/oauth/validation/validate/v2/token"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${auth_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="message"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Each request contains different values and have to be recalculated with
                    each request."/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="DOES NOT WORK FOR MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CacheEntryKey stringValue="${access_token}"/&gt;
                    &lt;L7p:CacheId stringValue="accessTokenValidation"/&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeSeconds stringValue="${cache_lifetime}"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="validationResult"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="MAC token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validate the token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:validation/ns:result[text()='valid']"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-ovp"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="removeValidationResult"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${access_token}"/&gt;
                    &lt;L7p:CacheId stringValue="accessTokenValidation"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeSeconds stringValue="1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="removeValidationResult"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${auth_scheme}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="WWW-Authenticate"/&gt;
                    &lt;L7p:HeaderValue stringValue="${auth_scheme} error=&amp;quot;Invalid request&amp;quot;"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add WWW-Authenticate header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValueReference="inline"&gt;&lt;![CDATA[{
                    "error":"invalid_request",
                    "error_description":"Validation error"
                    }]]&gt;&lt;/L7p:Content&gt;
                    &lt;L7p:ContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Pragma"/&gt;
                    &lt;L7p:Value stringValue="no-cache"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item nameValuePair="included"&gt;
                    &lt;L7p:Key stringValue="Cache-Control"/&gt;
                    &lt;L7p:Value stringValue="no-store"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:ExtraHeaders&gt;
                    &lt;L7p:HttpStatus stringValue="401"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check the validation result"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Add global authorization rules here =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Get token information fromvalidation result =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathClientId"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:validation/ns:client_key/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-ovp"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathOwner"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:validation/ns:resource_owner/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-ovp"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:validation/ns:scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-ovp"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathExpiration"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:validation/ns:expiration/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-ovp"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4cGF0aENsaWVudElkLnJlc3VsdH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="session.client_id"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4cGF0aE93bmVyLnJlc3VsdH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="session.subscriber_id"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4cGF0aFNjb3BlLnJlc3VsdH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="session.scope"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4cGF0aEV4cGlyYXRpb24ucmVzdWx0fQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="session.expires_at"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthdXRoX3NjaGVtZX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="session.scheme"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthY2Nlc3NfdG9rZW59"/&gt;
                    &lt;L7p:VariableToSet stringValue="session.access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="session.access_token"/&gt;
                    &lt;L7p:item stringValue="session.client_id"/&gt;
                    &lt;L7p:item stringValue="session.expires_at"/&gt;
                    &lt;L7p:item stringValue="session.scheme"/&gt;
                    &lt;L7p:item stringValue="session.scope"/&gt;
                    &lt;L7p:item stringValue="session.subscriber_id"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="6042809d-5ef7-4bb1-a9f3-af3584a06d5c"
               id="57477c668279c3c8d34da687b89a776e" version="1">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a75e1" guid="6042809d-5ef7-4bb1-a9f3-af3584a06d5c"
                         id="57477c668279c3c8d34da687b89a776e" version="1">
            <l7:Name>OAuth 2.0 Client Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NTRmMGM0NTUtNGQ4MC00MjFmLTgyY2EtOTE5NGRmMjQ4NTlk"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_client_id"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="c2NvcGVfdGVzdA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_scope"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="YTBmMjc0MmYtMzFjNy00MzZmLTk4MDItYjcwMTViOGZkOGU2"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_client_secret"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFKOEFBQUExQ0FNQUFBQm9Rc2xhQUFBQUdYUkZXSFJUYjJaMGQyRnlaUUJCWkc5aVpTQkpiV0ZuWlZKbFlXUjVjY2xsUEFBQUFNQlFURlJGRkJBTWpJNk83cU9sYTI5dzV1Zm45TWpKNW1GZ3lNaklUMUpTNFR3dDFkZll0TGU0K2ZuNTgvVDBwNmluWFdObStlVGwvdno3K3YzK3E3cTgrdno1K3Uvdy9mbjd3TVBFNm9lSWdJU0cwZExTK2Z2OC9mei85dmo2Ny9Eem82R2ZWVnhmOS9qM3E2NncrZmYwdWJ1OW5xS2tSRUU5Mjl6ZHk4M092OEMrOWZYMTdlN3U2dXZyNHVQazVFeElkM3Q3cnEyclhsdFhob1NCOTlqYWxaaVozK0RnTHl3b1pXUmhzck95OGZIeG5aNmQrUGo3Ky96Ny9QejgvZjM5Ly8vL0FTRERZd0FBREZwSlJFRlVlTnJVV1d0N3Fqb1dOcUxGZWdGaEtCWjMyb3ExRmF1VTNZcHVXNU9zLy8rdlpxMGtJTFoyNW5ubXc1eHpjczYyR0lKNTg2NzdvZ1YvNzlINlIrQlRVa2twaFZENkd3ZWhGTWhBcWI4SlBnVUtFVWtKc0o0YzVvdWNBRXNoYVFJdjFWK1BUeGwwZDVPRXNZUWxneGZnZ1FqMXJQcHJFYllxOFFLSWFabDhac3RsMzJQTTVVRFFDSjhlZnprK2dKMlhNTmRNTGxuaW9aQVJtelFVL25VQXJYd2h6SkprRUFPWElsQ1NpMFhDc2tmU1FRV2FRdmovQU5TN3lPLzJ5L2w2L3JuUlZxSUN4QU44VTVZZFE2Mm05MzlDK0RQdjZvZHJZd3ZmOFVrK0dpRW9kREN4aUJYQ1JGUzdUdDVmZHNqWGtKQTF5Sys3Zk45ZFdVeXF3bWVWdDlwVk5VZmwyaG9UeWpKUjM5YjRBbjR6ZmdRZWNhRUNycmdJT01MS0Z5eEp5c2thMFpQelVlZG4vV0kwcCswMUxERGJHTnRYcCtYcXpOcVVPVTBOVDlvSitSV2ZpdHV2dCtNSXRTOEt3b0NneU0ycUtEeDN4Wnl5bjJvejF0NVFuVW5OL0RaODIxNXZKSnZFV0FkbXI0U3NWMVdjNmNmbDJZTk4rVzZ2cnErdjJ6Y2hpQUFDQkRQS21EUFFkemJNV1d4Q2E4b25RS0EzcktmTS9xZlAwMTF6Tkh0RG1tblpQTVdGSVdtYzQzdEZmTmRYM1VjRmtlQXlMLzJuRDJKTkJnQnVrVXp2eUpJMWg2cnk1cktHSXB1QURBejdXWCtUTmI3R0FVUURkUFZEMVZKUUpuaForUnA4MTllM04xeHk5VkVrNVAwNDJvdFFBbDZlbkRrb0RSQXNDRU9MYXNySlRndWhUNitqbzdUWDFhelFmNFRHWlNjYTRQUTU2a2R3djIvODRYZ2RjeDUwbGdvRWo1UUkwRjRvWjFnK1FZeGlGeUFxSGFIZmpYQS9YQjFvV0lUOWx4aUs0UkNQUkVpRytJbi82VU5pcU1UdmRGZlBSMUpHMFRFMGl5SzlEbjlIeFhFVTR3aGlFZUFmeGIvcW54NVhZWWg3eGZnTENwOElTSnNEY3g2QkY0cHpmVmJBMDIwbXJqdEZueVJCUnFBem5rN211bTZXNHhsZThNSmRJejFDYmFhdTJ4OUJ4NjFHSDJkaDZtYjZ5M1N0UWg0ckNBS1EzZWJZM3NBRitlSVk4NUE4RFI1SUJzaElFQWp0VzVSd2wwWlFXa1lJOGRCcXRaNUJLNmJVMGdjSFovYXROL1FQblI1ZUZTK2tSQVZPRmkvd29PL1J2ejhZbCtEWmZtM3RlMmlISVc3QjFYVnp2SGJEaS95aEZWK2hHb1lTTXhqRUZSTmF5RXRuRUhvKzJ5bEpISklhQ2ZodDhCRzE1TkFGYk41b3cxYXZBeXFsbTYwbEt1OEhJVDBBZkxhcThmWUlCcDhkZTQraUtqNy9CUjljMGovRTE2VzdiVkE4TkJvTkw1N2ordzY4N0o1OGI0U1NESVcyWTgyZkVsYW5VVTFYWnRQbkZhcHBoNjQvWHdBOFpNbjVBTU5mK2M3ZTM3MVVDSTN2YzVNUGVuUWdDREVxeFB3THZxYitqYS9POGFFZWJrbW1LQW51RnI1UCtBUjZ4YVNZWUxRaDhVckxYeWhqUEFVRlFYaEhibWkvZHpUOWlPN3UwUXZRaEljK3ZTUWdqeDg0Um1TYWhPODNia0R3bjljUTQxdzRyZ2FCdVkwYjhnMzU3VmQ4dU9JUmpaYm56UEVOdmdDTmVuTnd5ZzBRcTVhL29ISUpTajJpZUowUzkzdkRmV0ZEQ0E1OGluL2VkaEJxL25xQkRuYlM2dDhEOHV6aXhmT0c0L05oSFN2YlJNOFlnbVorZFZMQUd0LzE3WmhEdi9CbkJoODZBUHo1ZE1reXJyUmJOUHdKVFNaNkRNaHdLNVlqWDg5b3dVSHM2ZHVPNFNrdy9Kbjl1Y1huSWI0SjRmc0FOR0VWb1pESm14RzgxMjNZOUMraENydXYzL0JkdDJIMGFkQVJmeEtmUnArNVNWeUk1Y2wrY1RkQjV3ZTJiKzEvRTZEOWdxeDZRK2I1WU9oRFFNVGZjN2JDZ1c2SFcvbUNodjJHZ3RHdW1ZZGhEQVRrdFJ0RXZKRWZTQjZxN2UwM2ZGZmp6RG5oRTlhcFQzZEEvcmppTDR6STV3aUFQN2hUcmpjc0tPT1J6THFRMytTQXRQM3VuMmxNSTJudy9mbjhMRWo5TWx3ZUNSUFpqQ1cwWTJrVEppdGZqQUxoWS9mcUM3N3I3cjhxZUFaZmhQQW1aWkxCaVQvaVRwQjFrTVcrcmFhRXFrY2lWNXBBUTU4dy9Ka3hpV1hsWDNERjNza3BCZFJueEdnZjNock5EN2hzK0JkU2QxU3Vtelp5MnozRDE2dncvUUU4STBELzA1bjFQQXh6dGYvajJqdEw3VWlJSUdKa2lSSU40WDFQQUI2R1FFNUs4L2RlRk1YN0xsREd2enkvMFdjUG5hTkdSd2xEWlJ0WWFEVGxpeXJMTWQ1Q3VHMjNiN1lYOFNVb1Njam54V3ptOTd3WGltOE4vVk5HdkxYSEpjOFJDbTNDaUpYSU1mWUw2VXVheGp3eS9MSGMxZkx0RThIRzU0KzE4aW5LUTRNbVBzenQwZFBGK2lxK3VvVFB4ZmpxTW0zTVBlOE8vVjNGWDJneXVnOHl4SUl4UmtFRXlaYWhnais0T3h1UlB6SDhXZnNsYVZuNzBDSG5YYXVyVHFpTThtbnllTlN3RDFRQml2d2l4clNGZDcvam15VnBBSzQxRm8xUFdQNVVxRDBnTFBhMEVZNFZUYWU2aEhGSXZLbkJaL2pEQ2dLTFF5bXMvd1ByZGloQ2toQm81NnNiRENka0VHZjhZZFdHa2lKRjRnRzBYOC94emZ3eWg3aFQyWExQTzBKdHY1WVNuUVo0cEFOOUNyZ1paZUVWUHZMaFRmOEgxbjdKLytrZnljSDRlRTFmbHhKeXJrQis2VjloMnNTeCtFQlhPQjUzYnh2NFpuNHlXT2FqeDNrbDZwbEhuR2orOWg2TmgxeW16OXBSVU5xRlNQY01pQTV5enArMDF1cmZzMTd0ZFd6OGZiTHhBLzJsRHVOd280MGprczJtU3V0VTZtRG1URG5WemRWcmU5dStzdmhtdnZQVVh6NFZnNGlkOE4wUkVPOWtFQWZsSWxYRm1xcGxVWWxNMXZnSWEzbGF2UmlxbXIvOGp6a05LVW5RTmRxbi9TQ2MxUittcHFDR1VCRHIvS1c3dlgzRnMweDhoMlg1d08vTkhGWGpRL3NkcGNUZm5nYjVrQldVZVBFQU9rMlk0UHh6U2ljb2FKS3VVT0c4bGxtTS8wK0dFdE9HdmNhWE1wenlYMHluZ3FUV0JhbWFOWHFyV1ZoVGJoZFYrY3YydHN0SGswV2VKYVNFRFh5enczcmFRVmY0enFyUmg5LzRpVjZQV09zOHZMT3lReHdjR0h2UGhwVHVZM1JPNnRVN3hQS0F0NmFVUnl3WnJrWUZKSXNqbVcyMXg2L0x0N1ArcVJKWW5NZU4vQVhMOUE3cnpVejhxUERObkt6ajV1ZGRFdk1sVWpyUHRFN0VGbUFxTWdBYlExaDY4RGpxdEZxYngrc1d6aHRtRFh3cUNNaUV1NmZ3aXlRVnZTcStXWHl6MlFCMkIrTEtWbUttRU1NTHJuUkNxNGVlVjFVUlo1SWNrNGNOVlpYUm1wdkNya1QrWGcyK1FGN0doM2VVaWtVamZ3bEdaZVdnVC9KOXV0ZG5yd0RVdjYrTE9BTkdhbmRXTFJDbnNyRytQQU5KZzRKZXQ5M3Uzb1JWTCtYY1BrQjdIUlh3NklmOFJScDhSY1loRXVlbmw2cXVjeFZ0VkpkUnBxa3RxNlU2c2JYek5xTFY0QU9qY3FpMVhQM1V2MGZwWWhGNk9UOXdPT0Z6RGltRlZqazhVcDBicFZUQTRpWjNSNUpvZEF4K0hkRkRpU2lTUjhRcG96VDlGUVJCTk1SU04rRGg4VTVFRkFXR3VCekw2V0g4SzZhMVE0VEwwNVR1eWFvcDhnTSt2QkZFUCtDREo5OHZONkh1RSswV2g4T3FBNXY1WVhHUHoweFlPVDFDdXNxZ1AwbGgyQi9rbzhNYWZVSEdtSnRpZGIvS0tZUGVlR3lPdFFFZkxkQzhNZHhQSnFnb3kvbkJmWUcwWHpJWHF0YkRqL3pwTkNZZS81Qy9qQmI1a0pPU1NSaE5ITFlaUWQ5M2Q2bU1YU2YzaWh4R3lSTjRDVzQybUQzZCt6bUl6TzlQL0NuQW9NREFBdXRQdGlreGN6M2kyckpjQXpCcW9oeWNhVDZFRGZ1OTlEZXFxbVIreEVmbExiK1l2emdUVUVPdEtoVExZVmVVdUdYZnozTEVWeWFqSFRMelViQk9pZWxLT3VnbGZjVEg1OG5IeGhta2lNOUZCOVF2NW1yaGRPQll6SWZySGFZYkxFRW5PaSttRzB4ajNwUHB2UWhNRStxODdkbjYwbHNOd2t2NWk1OGNkWjlBNkVSWGFud0srck9rM0tpWUpSK2sxS09rR0NRTStUdjRIbk55R1RJMnN2Z3lpQWdmVEJEMjBUOTBQcjBQTVBnR2ZuTEF4RzdKL09RbE1EbSsrdkg5Rm5WYjBJdUYzZXV2K1F1N1Y5YWJtVVROOERkMThpT1h2eGc3NWhnQzdvc3lmU0w1em90K3o4bTVtaWZIa2JNWUlqNFVNdlFSeU1LWDZxN3crSXAxb09KdmczWGF4MlM5OUplYUFWQS82eCttVmhKQkJ2RzJtYi80c3dJMW1Tby8reFlNUThUU1liaDAybU5QVXhDVEdmTFdnWHVuaEtkaUJFUFBPUmIrTHBEOTJaejVmZFF4UHlrbmNGODZpK1FUa3dYUFdiQUNvU1dvc3pDZmxkNE9Pc25ud1YvYlYxZy82eCtsRFFGd3JLWnZ1bFgrNHZkUUhoRmd1b2poSmJEOVF6endsRlIrc01KQUY5MjUyU1RIVU8vMlZUOGJ3bkE1Z2VYaVE4bzBjMWZMUndXNzFXcUI4WVk2V0dqdFlqM0pwdTRJSUtPUDNXRGlidkNSbGRzWDVvM1FmM2gvYVhxak9zaUhZNnhEWDhlVDNxeGMzZ0hJWm9lVGFFeUgxSEJMMHhTTkJzUkl0NmlGYWVoSmdTRXNwVGNWS2swcHRBNXhXVXFDR3cxMTJpVkcxQWRVcVY2THR5aDFlVWxCeVV0dnFsb1hYaEZ3VXNSZzI5N0c2eW1aMTZtQnJPb0dzbW5PNkI2TnN2MXpxQnZRMHJRc2RVTmNMOU9tcFV4SHh4N1VObHUxMWxENm9NeUMvL2IrVjNjZmpSMURhTDIyUE85aU54dmV0c2RyTzdLNnF5eDBGMWlhQnJNUTByYVZxLzYxZmxiVTRidHVzWXZMYi9rdXZKOXVOT09wQ1JKRWxjOVU5ZnNNZVhwNWFMU21sbjdWZjY5YjMrWTFudTFhYXlhMW00TnE3YWxsRDVjUS9qUGVuLzk5eDc4RkdBQ0Q5Z1pIaXo2ZUZnQUFBQUJKUlU1RXJrSmdnZz09"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_server_logo"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtob3N0X3NlcnZlcn0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly8ke3JlcXVlc3QudXJsLmhvc3R9Ojg0NDM="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_manager_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtob3N0X21hbmFnZXJfc2VydmVyfS9vYXV0aC9tYW5hZ2Vy"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Variable htmlTemplateTop depends on variable 'client_page'. This must
                    be defined by any policy which includes this fragment."/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQoNCi5oaWRkZW4geyBkaXNwbGF5OiBub25lOyB9DQoudW5oaWRkZW4geyBkaXNwbGF5OiBibG9jazsgfQ0KDQo8L3N0eWxlPg0KPC9oZWFkPg0KPGJvZHk+DQo8IS0tIExheW91dCAtLT4NCjxkaXYgaWQ9IndyYXBwZXIiPg0KICAgICA8ZGl2IGlkPSJtZW51YmtnIj48L2Rpdj4NCiAgICAgPGRpdiBpZD0iY29udGFpbmVyIj4NCgkgIDxkaXYgaWQ9ImhlYWRlciI+DQoJCQk8ZGl2IGlkPSJsb2dvLWZsb2F0ZXIiPjxhIGhyZWY9IiR7aG9zdF9zZXJ2ZXJ9L29hdXRoL3YyL2NsaWVudC8ke2NsaWVudF9wYWdlfSIgdGl0bGU9IiI+PGltZyBzcmM9IiR7b2F1dGgyX3NlcnZlcl9sb2dvfSIgYWx0PSIiIGlkPSJsb2dvIiAvPjwvYT48L2Rpdj4NCg0KICAJCTwvZGl2Pg0KPCEtLWNsb3NlIGhlYWRlci0tPg0KDQoNCgk8ZGl2IGlkPSJzaWRlYmFyLWxlZnQiIGNsYXNzPSJzaWRlYmFyIj4NCgkJICA8ZGl2IGlkPSJibG9jay1tZW51X2Jsb2NrLTEwIiBjbGFzcz0iY2xlYXItYmxvY2sgYmxvY2sgYmxvY2stbWVudV9ibG9jayI+DQoJCSAgPGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+DQoJCSAgICA8aDI+IDwvaDI+DQoJCSAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHBhcmVudC1tbGlkLTIzNjMgbWVudS1sZXZlbC0xIj4NCiAgCQkJCQk8IS0tPHVsIGNsYXNzPSJtZW51Ij4NCiAgCQkJCQk8bGkgY2xhc3M9ImV4cGFuZGVkIGZpcnN0IG1lbnUtbWxpZC0yMzY0IG5vbGluay1saSI+PHNwYW4gY2xhc3M9Im5vbGluayI+UmVwb3J0cyBieSBBUEkgS2V5PC9zcGFuPi0tPg0KICAJCQkJCTx1bCBjbGFzcz0ibWVudSI+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iLi9hdXRoY29kZSIgdGl0bGU9IiI+QXV0aG9yaXphdGlvbiBDb2RlPC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iLi9pbXBsaWNpdCIgdGl0bGU9IiI+SW1wbGljaXQ8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIuL2NsaWVudGNyZWRzIiB0aXRsZT0iIj5DbGllbnQgQ3JlZGVudGlhbHM8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIuL3JvcGMiIHRpdGxlPSIiPlJlc291cmNlIE93bmVyIFBhc3N3b3JkIENyZWRlbnRpYWxzPC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iLi9zYW1sIiB0aXRsZT0iIj5TQU1MPC9hPjwvbGk+DQoJCQkJCTxiciAvPg0KCQkJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+DQoJCQkJCTxsaT48YSBocmVmPSIke29hdXRoX21hbmFnZXJfc2VydmVyX3VybH0iIHRhcmdldD0iX2JsYW5rIHRpdGxlPSI+T0F1dGggTWFuYWdlcjwvYT48L2xpPg0KCQkJCTwvZGl2Pg0KCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkgIDwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="apicalltarget"/&gt;
                    &lt;L7p:item stringValue="host_server"/&gt;
                    &lt;L7p:item stringValue="htmlTemplateBottom"/&gt;
                    &lt;L7p:item stringValue="htmlTemplateTop"/&gt;
                    &lt;L7p:item stringValue="oauth2_client_id"/&gt;
                    &lt;L7p:item stringValue="oauth2_client_secret"/&gt;
                    &lt;L7p:item stringValue="oauth2_scope"/&gt;
                    &lt;L7p:item stringValue="oauth2_server_logo"/&gt;
                    &lt;L7p:item stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="ffe30a9e-0d90-45cb-8419-d5c85c883642" id="57477c668279c3c8d34da687b89a753c" version="3">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a74a9" guid="ffe30a9e-0d90-45cb-8419-d5c85c883642" id="57477c668279c3c8d34da687b89a753c" version="3">
            <l7:Name>Token Lifetime Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_v1_consumer_key_lifetime_m"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="ODY0MDA="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_v1_access_token_lifetime_s"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MzAw"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_v1_request_token_lifetime_s"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NjAw"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_auth_code_lifetime_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MzYwMA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_access_token_lifetime_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NjA0ODAw"/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth2_refresh_token_lifetime_sec"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="oauth2_access_token_lifetime_sec"/&gt;
                    &lt;L7p:item stringValue="oauth2_auth_code_lifetime_sec"/&gt;
                    &lt;L7p:item stringValue="oauth2_refresh_token_lifetime_sec"/&gt;
                    &lt;L7p:item stringValue="oauth_v1_access_token_lifetime_s"/&gt;
                    &lt;L7p:item stringValue="oauth_v1_consumer_key_lifetime_m"/&gt;
                    &lt;L7p:item stringValue="oauth_v1_request_token_lifetime_s"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="2dc66d50-fa74-489e-97f8-d6b2f4a13c08" id="57477c668279c3c8d34da687b89a754f" version="2">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a74a9" guid="2dc66d50-fa74-489e-97f8-d6b2f4a13c08" id="57477c668279c3c8d34da687b89a754f" version="2">
            <l7:Name>GenerateOAuthToken</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Poilcy issues tokens and token secrets"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Input: token_type=urt|art|at|ck|ac|at_2|rft"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="urt=unauthorized request token, art=authorized request token, at=access token, ck=client_key"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="ac=authorization_code, at_2=access_token for oauth 2.0, rft=refresh_token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Output: genToken, genSecret, genExpiration"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Configurable values: lifetime for tokens"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="ffe30a9e-0d90-45cb-8419-d5c85c883642"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item regex="included"&gt;
                    &lt;L7p:Pattern stringValue="urt|art"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth_v1_request_token_lifetime_s}"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="unauthorized/ authorized request token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="at"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="at"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth_v1_access_token_lifetime_s}"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="access token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="ck"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="ck"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth_v1_consumer_key_lifetime_m}"/&gt;
                    &lt;L7p:Expression2 stringValue="0"/&gt;
                    &lt;L7p:Operator operator="GT"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="GT"/&gt;
                    &lt;L7p:RightValue stringValue="0"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth_v1_consumer_key_lifetime_m}"/&gt;
                    &lt;L7p:DateOffsetField intValue="12"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="MA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration.seconds"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="client_key"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="ac"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="ac"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth2_auth_code_lifetime_sec}"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="authorization_code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="at_2"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="at_2"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth2_access_token_lifetime_sec}"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="access token oauth 2.0"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="rft"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="rft"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:DataType variableDataType="dateTime"/&gt;
                    &lt;L7p:DateOffsetExpression stringValue="${oauth2_refresh_token_lifetime_sec}"/&gt;
                    &lt;L7p:VariableToSet stringValue="expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="refresh token oauth 2.0"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Set the lifetime for the token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:UUIDGenerator&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Generate the token and the secret"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Quantity stringValue="2"/&gt;
                    &lt;L7p:TargetVariable stringValue="tokenSecret"/&gt;
                    &lt;/L7p:UUIDGenerator&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0b2tlblNlY3JldFswXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="genToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0b2tlblNlY3JldFsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="genSecret"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtleHBpcmF0aW9uLnNlY29uZHN9"/&gt;
                    &lt;L7p:VariableToSet stringValue="genExpiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="genExpiration"/&gt;
                    &lt;L7p:item stringValue="genSecret"/&gt;
                    &lt;L7p:item stringValue="genToken"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="e503f8c2-0466-478d-937d-87c5a5f19bee"
               id="57477c668279c3c8d34da687b89a7529" version="1">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a74a9" guid="e503f8c2-0466-478d-937d-87c5a5f19bee"
                         id="57477c668279c3c8d34da687b89a7529" version="1">
            <l7:Name>OAuth Client Token Store Context Variables</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_tokenstore_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_clientstore_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="aHR0cHM6Ly9sb2NhbGhvc3Q6ODQ0Mw=="/&gt;
                    &lt;L7p:VariableToSet stringValue="host_oauth_session_server"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
    <l7:Policy xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" guid="4fb19dfb-0d61-4ec1-a843-b0493badf7da"
               id="57477c668279c3c8d34da687b89a7781" version="1">
        <l7:PolicyDetail folderId="57477c668279c3c8d34da687b89a75e1" guid="4fb19dfb-0d61-4ec1-a843-b0493badf7da"
                         id="57477c668279c3c8d34da687b89a7781" version="1">
            <l7:Name>getCurrentToken</l7:Name>
            <l7:PolicyType>Include</l7:PolicyType>
            <l7:Properties>
                <l7:Property key="revision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:PolicyDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Retrieves the current access token from session"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Input: cacheKey"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Output: current_token, clearSessionForm"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbi4="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="clearSessionForm"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${cacheKey}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Y2FjaGVLZXk9JHtjYWNoZUtleX0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="lookupSession"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${host_oauth_session_server}/oauth/session/get"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="lookupSession"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="lookupSessionResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="sessionValue"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="lookupSessionResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:found/ns:value/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-session"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="sessionLocation"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="lookupSessionResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/ns:found/ns:location/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="ns"/&gt;
                    &lt;L7p:value stringValue="http://ns.l7tech.com/2012/11/otk-session"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;L7p:XpathVersion xpathVersion="XPATH_1_0"/&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="sessionValue.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="decoded"/&gt;
                    &lt;L7p:TransformType transformType="URL_DECODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtkZWNvZGVkfQ0KDQpUaGUgYWNjZXNzIHRva2VuIHdhcyByZXRyaWV2ZWQgZnJvbSAke3Nlc3Npb25Mb2NhdGlvbi5yZXN1bHR9Lg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGZvcm0gYWN0aW9uPSIiPg0KPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWN0aW9uIiB2YWx1ZT0iY2xlYXJTZXNzaW9uIi8+DQo8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2xlYXIgU2Vzc2lvbiIvPgkJCQ0KPC9mb3JtPg0KPGJyIC8+"/&gt;
                    &lt;L7p:VariableToSet stringValue="clearSessionForm"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="found"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="not found or no cacheKey"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;/L7p:TrueAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:ExportVariables&gt;
                    &lt;L7p:ExportedVars stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="clearSessionForm"/&gt;
                    &lt;L7p:item stringValue="current_token"/&gt;
                    &lt;/L7p:ExportedVars&gt;
                    &lt;/L7p:ExportVariables&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Policy>
</enumeration>