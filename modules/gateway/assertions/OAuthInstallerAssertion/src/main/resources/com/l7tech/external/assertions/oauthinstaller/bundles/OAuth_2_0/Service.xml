<?xml version="1.0" encoding="UTF-8"?>
<enumeration ObjectType="Service" ExportDate="20120815 0135" ExporterVersion="6.2 (4248)">
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797518" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797518" version="2">
            <l7:Name>implicit</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/client/implicit*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="2">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a test client for an OAuth 2 implementation using the implicit
                    grant type"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="e1431c63-9d2c-4ba1-b254-8eb69f543da7"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aDJfYXV0aF9zZXJ2ZXJ9JHtvYXV0aDJfYXV0aF9wYXRofQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="authServer"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvbWFuYWdlcg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnRjcC5yZW1vdGVJUH0hJHtnYXRld2F5Lm9hdXRoMl9jbGllbnRfaWR9IWltcGxpY2l0"/&gt;
                    &lt;L7p:VariableToSet stringValue="cacheID"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="authServer"/&gt;
                    &lt;L7p:Regex stringValue="//localhost:"/&gt;
                    &lt;L7p:RegexName stringValue="Replace localhost"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="//${request.url.host}:"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="600000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIGZyb20gY2FjaGUu"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="callapi"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="callapi"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRhcmdldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="target_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="R0VU"/&gt;
                    &lt;L7p:VariableToSet stringValue="target_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="7768a8bc-8228-48a2-80f1-f44884937569"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${request.http.parameter.target}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${authorization_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Call API"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.access_token}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5xdWVyeX0="/&gt;
                    &lt;L7p:ContentType stringValue="text/plain"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="queryContainingTheAccessToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="600000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="queryContainingTheAccessToken"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtxdWVyeUNvbnRhaW5pbmdUaGVBY2Nlc3NUb2tlbi5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgZXh0cmFjdGVkIGZyb20gdGhlIGZyYWdtZW50IGNvbXBvbmVudC4="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handshake callback"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.error}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5xdWVyeX0NCg0KQWNjZXNzIHdhcyBkZW5pZWQ="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:ContentType stringValue="text/plain"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="queryContainingTheAccessToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="600000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes stringValue="100000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="queryContainingTheAccessToken"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access denied"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjwhLS0gTGF5b3V0IC0tPg0KPGRpdiBpZD0id3JhcHBlciI+DQogICAgIDxkaXYgaWQ9Im1lbnVia2ciPjwvZGl2Pg0KICAgICA8ZGl2IGlkPSJjb250YWluZXIiPg0KCSAgPGRpdiBpZD0iaGVhZGVyIj4NCgkJCTxkaXYgaWQ9ImxvZ28tZmxvYXRlciI+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvY2xpZW50L2ltcGxpY2l0IiB0aXRsZT0iIj48aW1nIHNyYz0iJHtvYXV0aDJfc2VydmVyX2xvZ299IiBhbHQ9IiIgaWQ9ImxvZ28iIC8+PC9hPjwvZGl2Pg0KDQogIAkJPC9kaXY+DQo8IS0tY2xvc2UgaGVhZGVyLS0+DQoNCg0KCTxkaXYgaWQ9InNpZGViYXItbGVmdCIgY2xhc3M9InNpZGViYXIiPg0KCQkgIDxkaXYgaWQ9ImJsb2NrLW1lbnVfYmxvY2stMTAiIGNsYXNzPSJjbGVhci1ibG9jayBibG9jayBibG9jay1tZW51X2Jsb2NrIj4NCgkJICA8YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz4NCgkJICAgIDxoMj4gPC9oMj4NCgkJICAgICAgPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCSAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1uYW1lLXByaW1hcnktbGlua3MgcGFyZW50LW1saWQtMjM2MyBtZW51LWxldmVsLTEiPg0KICAJCQkJCTwhLS08dWwgY2xhc3M9Im1lbnUiPg0KICAJCQkJCTxsaSBjbGFzcz0iZXhwYW5kZWQgZmlyc3QgbWVudS1tbGlkLTIzNjQgbm9saW5rLWxpIj48c3BhbiBjbGFzcz0ibm9saW5rIj5SZXBvcnRzIGJ5IEFQSSBLZXk8L3NwYW4+LS0+DQogIAkJCQkJPHVsIGNsYXNzPSJtZW51Ij4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2F1dGhjb2RlIiB0aXRsZT0iIj5BdXRob3JpemF0aW9uIENvZGU8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2ltcGxpY2l0IiB0aXRsZT0iIj5JbXBsaWNpdDwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvY2xpZW50Y3JlZHMiIHRpdGxlPSIiPkNsaWVudCBDcmVkZW50aWFsczwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvcm9wYyIgdGl0bGU9IiI+UmVzb3VyY2UgT3duZXIgUGFzc3dvcmQgQ3JlZGVudGlhbHM8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L3NhbWwiIHRpdGxlPSIiPlNBTUw8L2E+PC9saT4NCgkJCQkJPGJyIC8+DQoJCQkJCTxjYXB0aW9uPjxoND48Yj48L2I+PC9oND48aHI+PHA+PC9wPjwvY2FwdGlvbj4NCgkJCQkJPGxpPjxhIGhyZWY9IiR7b2F1dGhfbWFuYWdlcl9zZXJ2ZXJfdXJsfSIgdGFyZ2V0PSJfYmxhbmsgdGl0bGU9Ij5PQXV0aCBNYW5hZ2VyPC9hPjwvbGk+DQoJCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCSAgPC9kaXY+"/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHtodG1sVGVtcGxhdGVUb3B9CiAKPGRpdiBpZD0iY29udGVudCI+CgoJPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPiAKCWlmICh3aW5kb3cubG9jYXRpb24uaGFzaC5sZW5ndGggIT0gMCkgewoJLy8gUGFyc2UgZnJnZW1lbnQgY29tcG9uZW50LgoJdmFyIHF1ZXJ5U3RyaW5nID0gbG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSk7CgkKCS8vIFNlbmQgdGhlIGZyYWdtZW50IHRvIHRoZSBzZXJ2ZXIuCgl3aW5kb3cubG9jYXRpb24gPSAiJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9PyIgKyBxdWVyeVN0cmluZwoJfQoJPC9zY3JpcHQ+CgoJPElGUkFNRSBpZD1teWlmcmFtZSBzcmM9IiIgc3R5bGU9J2Rpc3BsYXk6bm9uZScgZnJhbWVib3JkZXI9IjAiIHNjcm9sbGluZz0iYXV0byI+Cgk8L0lGUkFNRT4KCTxkaXYgaWQ9ImNvbnRlbnRfbGFuZGluZ19wYWdlIj4gICAgICAgICAgICAgIAoJPGRpdiBjbGFzcz0idmlldyB2aWV3LXByb2R1Y3RzMyB2aWV3LWlkLXByb2R1Y3RzMyB2aWV3LWRpc3BsYXktaWQtcGFnZV8xIHZpZXctZG9tLWlkLTEiPgkJCgkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQk8ZGl2IGNsYXNzPSJ0aXRsZS1ib3giPgoJCTxoMT5PQXV0aFYyQ2xpZW50PC9oMT4KCQk8YnIgLz4KCQk8aDM+T0F1dGggdmVyc2lvbjogZHJhZnQtaWV0Zi1vYXV0aC12Mi0yMzwvaDM+CgkJPGJyIC8+CgkJPGgzPkdyYW50IHR5cGU6IEltcGxpY2l0PC9oMz4KCQk8YnIgLz4KCQk8aDM+Q3VycmVudCBBY2Nlc3MgVG9rZW46PC9oMz4KCQk8YnIgLz4KCQk8cD48cHJlPgoke2N1cnJlbnRfdG9rZW59CgkJPC9wcmU+CgkJPC9wPgoJCTwvZGl2PgoJCTwvZGl2PgoJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+CgkJPC9kaXY+CgoJCSA8ZGl2IGNsYXNzPSJ2aWV3IHZpZXctcHJvZHVjdHMzIHZpZXctaWQtcHJvZHVjdHMzIHZpZXctZGlzcGxheS1pZC1wYWdlXzEgdmlldy1kb20taWQtMSI+CQkKCQk8ZGl2IGNsYXNzPSJjb250YWluZXIiPgoJCTxiciAvPgoKCQkKCQk8aDM+SW5pdGlhdGUgbmV3IE9BdXRoIGhhbmRzaGFrZTwvaDM+CgkJPGJyIC8+CgoJCTxmb3JtIGFjdGlvbj0iJHthdXRoU2VydmVyfSI+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImNsaWVudF9pZCIKCQkJCQkJCXZhbHVlPSIke29hdXRoMl9jbGllbnRfaWR9Ii8+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InJlZGlyZWN0X3VyaSIKCQkJCQkJCXZhbHVlPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iLz4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVzcG9uc2VfdHlwZSIKCQkJCQkJCXZhbHVlPSJ0b2tlbiIvPgoJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzY29wZSIKCQkJCQkJCXZhbHVlPSIke29hdXRoMl9zY29wZX0iLz4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiCgkJCQkJCQl2YWx1ZT0ic3RhdGVfdGVzdCIvPgoJCQkJCQkJCgkJCTxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJJbml0aWF0ZSIvPgkJCQoJCTwvZm9ybT4KCgkJPGJyIC8+PGJyIC8+PGJyIC8+CgkJCgkJPGgzPkNhbGwgQVBJIFVzaW5nIEN1cnJlbnQgQWNjZXNzIFRva2VuPC9oMz4KCQk8YnIgLz4KCgkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgoJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhY3Rpb24iCgkJCQkJCQl2YWx1ZT0iY2FsbGFwaSIvPgoJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIKCQkJCQkJCXZhbHVlPSJzdGF0ZV90ZXN0Ii8+CgkJCVRhcmdldDogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InRhcmdldCIgc2l6ZT04MCB2YWx1ZT0iJHthcGljYWxsdGFyZ2V0fSIvPgoJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2FsbCBBUEkiLz4KCQk8L2Zvcm0+CgkJPGJyIC8+CgkJPHA+PHByZT4KJHthcGlvdXRwdXR9CgkJPC9wcmU+CgkJPC9wPgoJCQoJCTwvZGl2PgoJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+Cgk8L2Rpdj4KPC9kaXY+CjwvZGl2PgoKJHtodG1sVGVtcGxhdGVCb3R0b219"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797517" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797517" version="2">
            <l7:Name>REST STS</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/samlTokenServer*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>1</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="0">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a SAML token server used by SAML grant type test client"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:HttpBasic/&gt;
                    &lt;L7p:Authentication&gt;
                    &lt;L7p:IdentityProviderOid longValue="-2"/&gt;
                    &lt;/L7p:Authentication&gt;
                    &lt;L7p:SamlIssuer&gt;
                    &lt;L7p:AuthenticationStatement samlAuthenticationInfo="included"&gt;
                    &lt;L7p:AuthenticationMethods stringArrayValue="included"/&gt;
                    &lt;L7p:IncludeAuthenticationContextDeclaration booleanValue="false"/&gt;
                    &lt;/L7p:AuthenticationStatement&gt;
                    &lt;L7p:NameQualifier stringValue=""/&gt;
                    &lt;L7p:SubjectConfirmationMethodUri stringValue="urn:oasis:names:tc:SAML:1.0:cm:bearer"/&gt;
                    &lt;L7p:Version boxedIntegerValue="2"/&gt;
                    &lt;/L7p:SamlIssuer&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="issuedSamlAssertion"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="encodedSaml"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlZGlyZWN0X3VyaX0/c2FtbD0ke2VuY29kZWRTYW1sfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Redirect"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="302"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ResponseContentType stringValue=""/&gt;
                    &lt;L7p:ResponseStatus intValue="302"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Location"/&gt;
                    &lt;L7p:HeaderValue stringValue="${location}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797516" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797516" version="2">
            <l7:Name>resource owner password credentials</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/client/ropc*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="1">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a test client for an OAuth 2 implementation using the resource
                    owner password credentials grant type"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="e1431c63-9d2c-4ba1-b254-8eb69f543da7"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvbWFuYWdlcg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!ropc"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIHZpYSBjYWNoZS4="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="refresh"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="refresh"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="rt"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="current_token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;refresh_token\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate the refresh token"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtydFsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuJnJlZnJlc2hfdG9rZW49JHtydFsxXX0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:Login stringValue="${oauth2_client_id}"/&gt;
                    &lt;L7p:Password stringValue="${oauth2_client_secret}"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="application/xml"/&gt;
                    &lt;L7p:Name stringValue="accept"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue
                    stringValue="3MVG94DzwlYDSHS6GTCNPxF87RQ8HrxbojWk89by7fE_H4ch8TsfZcaIFz.jdne83WCVPiD_xA93_Y8j4iomk"/&gt;
                    &lt;L7p:Name stringValue="client_id"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="https://ssg61.l7tech.com:8443/salesforce/oauth/callback"/&gt;
                    &lt;L7p:Name stringValue="redirect_uri"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="4922422941220601472"/&gt;
                    &lt;L7p:Name stringValue="client_secret"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="authorization_code"/&gt;
                    &lt;L7p:Name stringValue="grant_type"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${request.http.parameter.code}"/&gt;
                    &lt;L7p:Name stringValue="code"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmVmcmVzaGVkLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!ropc"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Refresh"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="callapi"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="callapi"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRhcmdldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="target_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="R0VU"/&gt;
                    &lt;L7p:VariableToSet stringValue="target_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="7768a8bc-8228-48a2-80f1-f44884937569"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${request.http.parameter.target}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${authorization_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Call API"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="handshake"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="handshake"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.login}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item stringLength="included"&gt;
                    &lt;L7p:Max intValue="-1"/&gt;
                    &lt;L7p:Min intValue="1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.password}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item stringLength="included"&gt;
                    &lt;L7p:Max intValue="-1"/&gt;
                    &lt;L7p:Min intValue="1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT1wYXNzd29yZCZ1c2VybmFtZT0ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIubG9naW59JnBhc3N3b3JkPSR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5wYXNzd29yZH0mc2NvcGU9JHtvYXV0aDJfc2NvcGV9"/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:Login stringValue="${oauth2_client_id}"/&gt;
                    &lt;L7p:Password stringValue="${oauth2_client_secret}"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!ropc"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handshake"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjwhLS0gTGF5b3V0IC0tPg0KPGRpdiBpZD0id3JhcHBlciI+DQogICAgIDxkaXYgaWQ9Im1lbnVia2ciPjwvZGl2Pg0KICAgICA8ZGl2IGlkPSJjb250YWluZXIiPg0KCSAgPGRpdiBpZD0iaGVhZGVyIj4NCgkJCTxkaXYgaWQ9ImxvZ28tZmxvYXRlciI+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvY2xpZW50L3JvcGMiIHRpdGxlPSIiPjxpbWcgc3JjPSIke29hdXRoMl9zZXJ2ZXJfbG9nb30iIGFsdD0iIiBpZD0ibG9nbyIgLz48L2E+PC9kaXY+DQoNCiAgCQk8L2Rpdj4NCjwhLS1jbG9zZSBoZWFkZXItLT4NCg0KDQoJPGRpdiBpZD0ic2lkZWJhci1sZWZ0IiBjbGFzcz0ic2lkZWJhciI+DQoJCSAgPGRpdiBpZD0iYmxvY2stbWVudV9ibG9jay0xMCIgY2xhc3M9ImNsZWFyLWJsb2NrIGJsb2NrIGJsb2NrLW1lbnVfYmxvY2siPg0KCQkgIDxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPg0KCQkgICAgPGgyPiA8L2gyPg0KCQkgICAgICA8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJICAgICAgICA8ZGl2IGNsYXNzPSJtZW51LW5hbWUtcHJpbWFyeS1saW5rcyBwYXJlbnQtbWxpZC0yMzYzIG1lbnUtbGV2ZWwtMSI+DQogIAkJCQkJPCEtLTx1bCBjbGFzcz0ibWVudSI+DQogIAkJCQkJPGxpIGNsYXNzPSJleHBhbmRlZCBmaXJzdCBtZW51LW1saWQtMjM2NCBub2xpbmstbGkiPjxzcGFuIGNsYXNzPSJub2xpbmsiPlJlcG9ydHMgYnkgQVBJIEtleTwvc3Bhbj4tLT4NCiAgCQkJCQk8dWwgY2xhc3M9Im1lbnUiPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvYXV0aGNvZGUiIHRpdGxlPSIiPkF1dGhvcml6YXRpb24gQ29kZTwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvaW1wbGljaXQiIHRpdGxlPSIiPkltcGxpY2l0PC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iL29hdXRoL3YyL2NsaWVudC9jbGllbnRjcmVkcyIgdGl0bGU9IiI+Q2xpZW50IENyZWRlbnRpYWxzPC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iL29hdXRoL3YyL2NsaWVudC9yb3BjIiB0aXRsZT0iIj5SZXNvdXJjZSBPd25lciBQYXNzd29yZCBDcmVkZW50aWFsczwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvc2FtbCIgdGl0bGU9IiI+U0FNTDwvYT48L2xpPg0KCQkJCQk8YnIgLz4NCgkJCQkJPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPg0KCQkJCQk8bGk+PGEgaHJlZj0iJHtvYXV0aF9tYW5hZ2VyX3NlcnZlcl91cmx9IiB0YXJnZXQ9Il9ibGFuayB0aXRsZT0iPk9BdXRoIE1hbmFnZXI8L2E+PC9saT4NCgkJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCQkJPC9kaXY+DQoJICA8L2Rpdj4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHtodG1sVGVtcGxhdGVUb3B9Cgo8ZGl2IGlkPSJjb250ZW50Ij4KCQk8SUZSQU1FIGlkPW15aWZyYW1lIHNyYz0iIiBzdHlsZT0nZGlzcGxheTpub25lJyBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJhdXRvIj4KCQk8L0lGUkFNRT4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9ImNvbnRlbnRfbGFuZGluZ19wYWdlIj4gICAgICAgICAgICAgIAoJCQk8ZGl2IGNsYXNzPSJ2aWV3IHZpZXctcHJvZHVjdHMzIHZpZXctaWQtcHJvZHVjdHMzIHZpZXctZGlzcGxheS1pZC1wYWdlXzEgdmlldy1kb20taWQtMSI+CQkKCQkJCTxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CgkJCQk8ZGl2IGNsYXNzPSJ0aXRsZS1ib3giPgoJCQkJPGgxPk9BdXRoVjJDbGllbnQ8L2gxPgoJCQkJPGJyIC8+CgkJCQk8aDM+T0F1dGggdmVyc2lvbjogZHJhZnQtaWV0Zi1vYXV0aC12Mi0yMzwvaDM+CgkJCQk8YnIgLz4KCQkJCTxoMz5HcmFudCB0eXBlOiBSZXNvdXJjZSBvd25lciBwYXNzd29yZCBjcmVkZW50aWFsczwvaDM+CgkJCQk8YnIgLz4KCQkJCTxoMz5DdXJyZW50IEFjY2VzcyBUb2tlbjo8L2gzPgoJCQkJPGJyIC8+CgkJCQk8cD48cHJlPgoke2N1cnJlbnRfdG9rZW59CgkJCQk8L3ByZT4KCQkJCTwvcD4KCQkJCTwvZGl2PgoJCQkJPC9kaXY+CgkJCSAgICAgICAgPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPgoJCSAgICAJPC9kaXY+CgogICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCQkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJCTxiciAvPgoKCQkJCQoJCQkJPGgzPkluaXRpYXRlIG5ldyBPQXV0aCBoYW5kc2hha2U8L2gzPgoJCQkJPGJyIC8+CgoJCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iIG1ldGhvZD0iUE9TVCI+CiAgIAkJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWN0aW9uIgogICAgICAgICAgICAgICAgICAgIAkJCQl2YWx1ZT0iaGFuZHNoYWtlIi8+CgkJCQkJTG9naW46ICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyA8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0ibG9naW4iLz48YnIvPjxici8+CgkJCQkJUGFzc3dvcmQ6IDxpbnB1dCB0eXBlPSJwYXNzd29yZCIgbmFtZT0icGFzc3dvcmQiLz4KCQkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iSW5pdGlhdGUiLz4KCQkJCTwvZm9ybT4KCgkJCQk8YnIgLz48YnIgLz48YnIgLz4KCgkJCQk8aDM+UmVmcmVzaCBDdXJyZW50IEFjY2VzcyBUb2tlbjwvaDM+CgkJCQk8YnIgLz4KCgoJCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgogICAJCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjdGlvbiIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9InJlZnJlc2giLz4KCQkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iUmVmcmVzaCIvPgoJCQkJPC9mb3JtPgoKCQkJCTxiciAvPjxiciAvPjxiciAvPgoJCQkJCgkJCQk8aDM+Q2FsbCBBUEkgVXNpbmcgQ3VycmVudCBBY2Nlc3MgVG9rZW48L2gzPgoJCQkJPGJyIC8+CgoJCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgogICAJCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjdGlvbiIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9ImNhbGxhcGkiLz4KCQkJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9InN0YXRlX3Rlc3QiLz4KCQkJCQlUYXJnZXQ6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ0YXJnZXQiIHNpemU9ODAgdmFsdWU9IiR7YXBpY2FsbHRhcmdldH0iLz4KCQkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2FsbCBBUEkiLz4KCQkJCTwvZm9ybT4KCQkJCTxiciAvPgoJCQkJPHA+PHByZT4KJHthcGlvdXRwdXR9CgkJCQk8L3ByZT4KCQkJCTwvcD4KCQkJCQoJCQkJPC9kaXY+CgkJCSAgICAgICAgPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPgoJICAgIAk8L2Rpdj4KCgoJCTwvZGl2Pgo8L2Rpdj4KCiR7aHRtbFRlbXBsYXRlQm90dG9tfQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797515" version="2">
        <l7:ServiceDetail folderId="123600907" id="123797515" version="2">
            <l7:Name>protected resource</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/protectedapi*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="1">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a protected resource server used by the test clients"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="5b3f8880-588d-424c-bdd5-da7c80119c3a"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Add additional authorization rules here =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Based on grant type, scope, client id, and subscriber id
                    here =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${session.scope}"/&gt;
                    &lt;L7p:Expression2 stringValue="${request.url.path}"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="${request.url.path}"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All L7p:Enabled="false" wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="RmFpbGVkLiBJbnZhbGlkIHNjb3BlLgoke3Jlc3BvbnNlLm1haW5wYXJ0fQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;/L7p:FalseAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check scope"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJjbGllbnRfaWQiOiIke3Nlc3Npb24uY2xpZW50X2lkfSIsCiAgInN1YnNjcmliZXJfaWQiOiIke3Nlc3Npb24uc3Vic2NyaWJlcl9pZH0iLAogICJzY29wZSI6IiR7c2Vzc2lvbi5zY29wZX0iLAogICJleHBpcmVzX2F0Ijoke3Nlc3Npb24uZXhwaXJlc19hdH0sCiAgImFjY2Vzc2VkX2F0Ijoke2dhdGV3YXkudGltZS5taWxsaXN9Cn0="/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797519" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797519" version="2">
            <l7:Name>authorization code</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/client/authcode*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>16</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="15">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a test client for an OAuth 2 implementation using the
                    authorization code grant type"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="e1431c63-9d2c-4ba1-b254-8eb69f543da7"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtvYXV0aDJfYXV0aF9zZXJ2ZXJ9JHtvYXV0aDJfYXV0aF9wYXRofQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="authServer"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvbWFuYWdlcg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnRjcC5yZW1vdGVJUH0hJHtnYXRld2F5Lm9hdXRoMl9jbGllbnRfaWR9IWF1dGhjb2Rl"/&gt;
                    &lt;L7p:VariableToSet stringValue="cacheID"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="authServer"/&gt;
                    &lt;L7p:Regex stringValue="//localhost:"/&gt;
                    &lt;L7p:RegexName stringValue="Replace localhost"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="//${request.url.host}:"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9"/&gt;
                    &lt;L7p:VariableToSet stringValue="redirectUri"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIGZyb20gY2FjaGUu"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="refresh"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="refresh"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="rt"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="current_token"/&gt;
                    &lt;L7p:Regex stringValue="\&amp;quot;refresh_token\&amp;quot;\s*\:\s*\&amp;quot;([^&amp;quot;]*)\&amp;quot;"/&gt;
                    &lt;L7p:RegexName stringValue="isolate the refresh token"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtydFsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="refresh_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT1yZWZyZXNoX3Rva2VuJnJlZnJlc2hfdG9rZW49JHtyZWZyZXNoX3Rva2VufSZzY29wZT0ke29hdXRoMl9zY29wZX0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:Login stringValue="${oauth2_client_id}"/&gt;
                    &lt;L7p:Password stringValue="${oauth2_client_secret}"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="application/xml"/&gt;
                    &lt;L7p:Name stringValue="accept"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue
                    stringValue="3MVG94DzwlYDSHS6GTCNPxF87RQ8HrxbojWk89by7fE_H4ch8TsfZcaIFz.jdne83WCVPiD_xA93_Y8j4iomk"/&gt;
                    &lt;L7p:Name stringValue="client_id"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="https://ssg61.l7tech.com:8443/salesforce/oauth/callback"/&gt;
                    &lt;L7p:Name stringValue="redirect_uri"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="4922422941220601472"/&gt;
                    &lt;L7p:Name stringValue="client_secret"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="authorization_code"/&gt;
                    &lt;L7p:Name stringValue="grant_type"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${request.http.parameter.code}"/&gt;
                    &lt;L7p:Name stringValue="code"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmVmcmVzaGVkLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Refresh"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="callapi"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="callapi"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRhcmdldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="target_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="R0VU"/&gt;
                    &lt;L7p:VariableToSet stringValue="target_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="7768a8bc-8228-48a2-80f1-f44884937569"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${request.http.parameter.target}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${authorization_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Call API"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.code}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT1hdXRob3JpemF0aW9uX2NvZGUmY29kZT0ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuY29kZX0mcmVkaXJlY3RfdXJpPSR7cmVkaXJlY3RVcml9JmNsaWVudF9pZD0ke29hdXRoMl9jbGllbnRfaWR9JmNsaWVudF9zZWNyZXQ9JHtvYXV0aDJfY2xpZW50X3NlY3JldH0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="application/xml"/&gt;
                    &lt;L7p:Name stringValue="accept"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIGJ5IGNsaWVudCB2aWEgYSBjYWxsYmFjayB0byB0aGUgDQphdXRob3JpemF0aW9uIHNlcnZlciBiYXNlZCBvbiB0aGUgYXV0aG9yaXphdGlvbiBjb2RlIHZhbHVlIA0KcmV0dXJuZWQgKCR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5jb2RlfSkgb24gdGhlIHJlZGlyZWN0aW9uDQpiYWNrIGZyb20gdGhlIGF1dGhvcml6YXRpb24gc2VydmVyLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handshake callback"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.error}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiIiwNCiAgInRva2VuX3R5cGUiOiIiLA0KICAiZXhwaXJlc19pbiI6LA0KICAicmVmcmVzaF90b2tlbiI6IiIsDQogICJzY29wZSI6IiINCn0NCg0KVGhlIGFjY2VzcyB3YXMgZGVuaWVkLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiIiwNCiAgInRva2VuX3R5cGUiOiIiLA0KICAiZXhwaXJlc19pbiI6LA0KICAicmVmcmVzaF90b2tlbiI6IiIsDQogICJzY29wZSI6IiINCn0="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="denied"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${cacheID}"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes stringValue="100000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="denied"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access denied"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjwhLS0gTGF5b3V0IC0tPg0KPGRpdiBpZD0id3JhcHBlciI+DQogICAgIDxkaXYgaWQ9Im1lbnVia2ciPjwvZGl2Pg0KICAgICA8ZGl2IGlkPSJjb250YWluZXIiPg0KCSAgPGRpdiBpZD0iaGVhZGVyIj4NCgkJCTxkaXYgaWQ9ImxvZ28tZmxvYXRlciI+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvY2xpZW50L2F1dGhjb2RlIiB0aXRsZT0iIj48aW1nIHNyYz0iJHtvYXV0aDJfc2VydmVyX2xvZ299IiBhbHQ9IiIgaWQ9ImxvZ28iIC8+PC9hPjwvZGl2Pg0KDQogIAkJPC9kaXY+DQo8IS0tY2xvc2UgaGVhZGVyLS0+DQoNCg0KCTxkaXYgaWQ9InNpZGViYXItbGVmdCIgY2xhc3M9InNpZGViYXIiPg0KCQkgIDxkaXYgaWQ9ImJsb2NrLW1lbnVfYmxvY2stMTAiIGNsYXNzPSJjbGVhci1ibG9jayBibG9jayBibG9jay1tZW51X2Jsb2NrIj4NCgkJICA8YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz4NCgkJICAgIDxoMj4gPC9oMj4NCgkJICAgICAgPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCSAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1uYW1lLXByaW1hcnktbGlua3MgcGFyZW50LW1saWQtMjM2MyBtZW51LWxldmVsLTEiPg0KICAJCQkJCTwhLS08dWwgY2xhc3M9Im1lbnUiPg0KICAJCQkJCTxsaSBjbGFzcz0iZXhwYW5kZWQgZmlyc3QgbWVudS1tbGlkLTIzNjQgbm9saW5rLWxpIj48c3BhbiBjbGFzcz0ibm9saW5rIj5SZXBvcnRzIGJ5IEFQSSBLZXk8L3NwYW4+LS0+DQogIAkJCQkJPHVsIGNsYXNzPSJtZW51Ij4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2F1dGhjb2RlIiB0aXRsZT0iIj5BdXRob3JpemF0aW9uIENvZGU8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2ltcGxpY2l0IiB0aXRsZT0iIj5JbXBsaWNpdDwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvY2xpZW50Y3JlZHMiIHRpdGxlPSIiPkNsaWVudCBDcmVkZW50aWFsczwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvcm9wYyIgdGl0bGU9IiI+UmVzb3VyY2UgT3duZXIgUGFzc3dvcmQgQ3JlZGVudGlhbHM8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L3NhbWwiIHRpdGxlPSIiPlNBTUw8L2E+PC9saT4NCgkJCQkJPGJyIC8+DQoJCQkJCTxjYXB0aW9uPjxoND48Yj48L2I+PC9oND48aHI+PHA+PC9wPjwvY2FwdGlvbj4NCgkJCQkJPGxpPjxhIGhyZWY9IiR7b2F1dGhfbWFuYWdlcl9zZXJ2ZXJfdXJsfSIgdGFyZ2V0PSJfYmxhbmsgdGl0bGU9Ij5PQXV0aCBNYW5hZ2VyPC9hPjwvbGk+DQoJCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCSAgPC9kaXY+"/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHtodG1sVGVtcGxhdGVUb3B9Cgo8ZGl2IGlkPSJjb250ZW50Ij4KCgk8SUZSQU1FIGlkPW15aWZyYW1lIHNyYz0iIiBzdHlsZT0nZGlzcGxheTpub25lJyBmcmFtZWJvcmRlcj0iMCIgc2Nyb2xsaW5nPSJhdXRvIj4KCTwvSUZSQU1FPgoJCTxkaXYgaWQ9ImNvbnRlbnRfbGFuZGluZ19wYWdlIj4gICAgICAgICAgICAgIAoJCTxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCTxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CgkJPGRpdiBjbGFzcz0idGl0bGUtYm94Ij4KCQk8aDE+T0F1dGhWMkNsaWVudDwvaDE+CgkJPGJyIC8+CgkJPGgzPk9BdXRoIHZlcnNpb246IGRyYWZ0LWlldGYtb2F1dGgtdjItMjM8L2gzPgoJCTxiciAvPgoJCTxoMz5HcmFudCB0eXBlOiBBdXRob3JpemF0aW9uIGNvZGU8L2gzPgoJCTxiciAvPgoJCTxoMz5DdXJyZW50IEFjY2VzcyBUb2tlbjo8L2gzPgoJCTxiciAvPgoJCTxwPjxwcmU+CiR7Y3VycmVudF90b2tlbn0KCQk8L3ByZT4KCQk8L3A+CgkJPC9kaXY+CgkJPC9kaXY+CgkJCTxjYXB0aW9uPjxoND48Yj48L2I+PC9oND48aHI+PHA+PC9wPjwvY2FwdGlvbj4KCQk8L2Rpdj4KCgkJIDxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCTxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CgkJPGJyIC8+CgoJCQoJCTxoMz5Jbml0aWF0ZSBuZXcgT0F1dGggaGFuZHNoYWtlPC9oMz4KCQk8YnIgLz4KCgkJPGZvcm0gYWN0aW9uPSIke2F1dGhTZXJ2ZXJ9Ij4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVzcG9uc2VfdHlwZSIKCQkJCQkJCXZhbHVlPSJjb2RlIi8+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImNsaWVudF9pZCIKCQkJCQkJCXZhbHVlPSIke29hdXRoMl9jbGllbnRfaWR9Ii8+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InJlZGlyZWN0X3VyaSIKCQkJCQkJCXZhbHVlPSIke3JlZGlyZWN0VXJpfSIvPgoJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzY29wZSIKCQkJCQkJCXZhbHVlPSIke29hdXRoMl9zY29wZX0iLz4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhdGUiCgkJCQkJCQl2YWx1ZT0ic3RhdGVfdGVzdCIvPgoKCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkluaXRpYXRlIi8+CQkJCgkJPC9mb3JtPgoKCQk8YnIgLz48YnIgLz48YnIgLz4KCgkJPGgzPlJlZnJlc2ggQ3VycmVudCBBY2Nlc3MgVG9rZW48L2gzPgoJCTxiciAvPgoKCgkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgoJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhY3Rpb24iCgkJCQkJCSAgdmFsdWU9InJlZnJlc2giLz4KCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IlJlZnJlc2giLz4KCQk8L2Zvcm0+CgoJCTxiciAvPjxiciAvPjxiciAvPgoJCQoJCTxoMz5DYWxsIEFQSSBVc2luZyBDdXJyZW50IEFjY2VzcyBUb2tlbjwvaDM+CgkJPGJyIC8+CgoJCTxmb3JtIGFjdGlvbj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9Ij4KCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iYWN0aW9uIgoJCQkJCQkgIHZhbHVlPSJjYWxsYXBpIi8+CgkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InN0YXRlIgoJCQkJCQkgIHZhbHVlPSJzdGF0ZV90ZXN0Ii8+CgkJCVRhcmdldDogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InRhcmdldCIgc2l6ZT04MCB2YWx1ZT0iJHthcGljYWxsdGFyZ2V0fSIvPgoJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2FsbCBBUEkiLz4KCQk8L2Zvcm0+CgkJPGJyIC8+CgkJPHA+PHByZT4KJHthcGlvdXRwdXR9CgkJPC9wcmU+CgkJPC9wPgoJCQoJCTwvZGl2PgoJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+CgkJPC9kaXY+CgoJPC9kaXY+CjwvZGl2PgoKJHtodG1sVGVtcGxhdGVCb3R0b219"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797514" version="2">
        <l7:ServiceDetail folderId="123600906" id="123797514" version="2">
            <l7:Name>oauth/v2</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/auth/oauth/v2/*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="2">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:AuditAssertion&gt;
                    &lt;L7p:Enabled booleanValue="false"/&gt;
                    &lt;/L7p:AuditAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="Endpoint isused by websites to reload website content"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Set this to the uri prefix that points to the authorization template
                    resource files "/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAudXJpfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="uri"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="uris"/&gt;
                    &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="uri"/&gt;
                    &lt;L7p:Regex stringValue="(.*)/"/&gt;
                    &lt;L7p:RegexName stringValue="remove uri prefix"/&gt;
                    &lt;L7p:RegexVar stringValue="uri"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="/"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_template_server}${uri}${request.http.query}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="SOAPAction"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797513" version="2">
        <l7:ServiceDetail folderId="123600906" id="123797513" version="2">
            <l7:Name>oauth/v2</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/auth/oauth/v2/authorize/website</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>1</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="0">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="T0F1dGggMi4wIEF1dGhvcml6YXRpb24gU2VydmVy"/&gt;
                    &lt;L7p:VariableToSet stringValue="this.app.name"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCmJvZHkuZHJhZ3tjdXJzb3I6bW92ZTt9dGguYWN0aXZlIGltZ3tkaXNwbGF5OmlubGluZTt9dHIuZXZlbix0ci5vZGR7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNjY2M7cGFkZGluZzowLjFlbSAwLjZlbTt9DQp0ci5kcmFne2JhY2tncm91bmQtY29sb3I6I2ZmZmZmMDt9dHIuZHJhZy1wcmV2aW91c3tiYWNrZ3JvdW5kLWNvbG9yOiNmZmQ7fQ0KdGQuYWN0aXZle2JhY2tncm91bmQtY29sb3I6I2RkZDt9dGQuY2hlY2tib3gsdGguY2hlY2tib3h7dGV4dC1hbGlnbjpjZW50ZXI7fQ0KdGJvZHl7Ym9yZGVyLXRvcDoxcHggc29saWQgI2NjYzt9dGJvZHkgdGh7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYzt9DQp0aGVhZCB0aHt0ZXh0LWFsaWduOmxlZnQ7DQogIHBhZGRpbmctcmlnaHQ6MWVtOw0KICBib3JkZXItYm90dG9tOjNweCBzb2xpZCAjY2NjO30NCi5icmVhZGNydW1ie3BhZGRpbmctYm90dG9tOi41ZW19ZGl2LmluZGVudGF0aW9ue3dpZHRoOjIwcHg7aGVpZ2h0OjEuN2VtO21hcmdpbjotMC40ZW0gMC4yZW0gLTAuNGVtIC0wLjRlbTsNCiAgcGFkZGluZzowLjQyZW0gMCAwLjQyZW0gMC42ZW07DQogIGZsb2F0OmxlZnQ7fQ0KdWwucHJpbWFyeXtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7cGFkZGluZzowIDAgMCAxZW07DQogIHdoaXRlLXNwYWNlOm5vd3JhcDtsaXN0LXN0eWxlOm5vbmU7bWFyZ2luOjVweDtoZWlnaHQ6YXV0bztsaW5lLWhlaWdodDpub3JtYWw7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjt9DQp1bC5wcmltYXJ5IGxpe2Rpc3BsYXk6aW5saW5lO311bC5wcmltYXJ5IGxpIGF7YmFja2dyb3VuZC1jb2xvcjojZGRkO2JvcmRlci1jb2xvcjojYmJiO2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkIHNvbGlkIG5vbmUgc29saWQ7aGVpZ2h0OmF1dG87bWFyZ2luLXJpZ2h0OjAuNWVtOw0KICBwYWRkaW5nOjAgMWVtO3RleHQtZGVjb3JhdGlvbjpub25lO311bC5wcmltYXJ5IGxpLmFjdGl2ZSBhe2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3JkZXI6MXB4IHNvbGlkICNiYmI7Ym9yZGVyLWJvdHRvbTojZmZmIDFweCBzb2xpZDt9DQp1bC5wcmltYXJ5IGxpIGE6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojZWVlO2JvcmRlci1jb2xvcjojY2NjO2JvcmRlci1ib3R0b20tY29sb3I6I2VlZTt9dWwuc2Vjb25kYXJ5e2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNiYmI7cGFkZGluZzowLjVlbSAxZW07bWFyZ2luOjVweDt9DQoNCip7bWFyZ2luOjA7fQ0KaHRtbCxib2R5e2JhY2tncm91bmQ6I2ZmZjtmb250OjEycHgvMS4yZW0gaGVsdmV0aWNhLGFyaWFsLHNhbnMtc2VyaWY7Y29sb3I6IzRiNGI0YjtoZWlnaHQ6MTAwJTtsaW5lLWhlaWdodDoxLjNlbTt9DQpocntoZWlnaHQ6MXB4O2JhY2tncm91bmQtY29sb3I6I2RkZDsgbm8tcmVwZWF0IGNlbnRlciBib3R0b207cGFkZGluZzo4cHggYXV0bztib3JkZXI6MCBub25lO30NCmlucHV0e2NvbG9yOiM0YjRiNGI7fQ0KaDEsaDIsaDMsaDQsaDUsaDZ7cGFkZGluZzowO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LWZhbWlseTpoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjt9DQpoMXtmb250LXNpemU6MjUwJTtjb2xvcjp3aGl0ZTt6LWluZGV4OjU7fQ0KaDJ7Zm9udC1zaXplOjE3NSU7fQ0KaDN7Zm9udC1zaXplOjE1MCU7fQ0KaDR7Zm9udC1zaXplOjEyMCU7fQ0KaDV7Zm9udC1zaXplOjExMCU7fQ0KaDZ7Zm9udC1zaXplOjEwNSU7fQ0KYTphY3RpdmUsYS5hY3RpdmV7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246bm9uZTt9DQphOmxpbmssYTp2aXNpdGVke2NvbG9yOiM0YjRiNGI7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTtvdXRsaW5lOm5vbmU7fQ0KYTpob3Zlcntjb2xvcjojZGIzYjJjO3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7fQ0KcHttYXJnaW4tYm90dG9tOi41ZW07bGluZS1oZWlnaHQ6MS4zZW07bGlzdC1zdHlsZTpub25lO3RleHQtYWxpZ246bGVmdDtsaW5lLWhlaWdodDoxLjVlbTtjb2xvcjojNGI0YjRiO30NCmJsb2NrcXVvdGUgKnttYXJnaW46NXB4IDAgMCAxMHB4O311bHtsaW5lLWhlaWdodDoxLjVlbTsNCnBhZGRpbmc6LjJlbSAxZW0gMWVtIDFlbTt9b2x7bGluZS1oZWlnaHQ6MS41ZW07cGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kOm5vbmU7fWltZyxhIGltZ3tib3JkZXI6bm9uZTt9DQpuby1yZXBlYXQgbGVmdCAzNSU7bWFyZ2luLWxlZnQ6LjVlbTtwYWRkaW5nLWxlZnQ6MWVtO30NCiN3cmFwcGVye21pbi1oZWlnaHQ6MTAwJTtoZWlnaHQ6YXV0byAhaW1wb3J0YW50O2hlaWdodDoxMDAlO21hcmdpbjowIGF1dG8gLTVlbTt9I2NvbnRhaW5lcnttYXJnaW46LTIuNWVtIGF1dG8gMCAyLjVlbTt9DQouZmllbGQtY29udGVudCAudmlldy1kb20taWQtNSAudmlldy1jb250ZW50IC52aWV3cy1yb3d7DQogICAgbWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCiNzaWRlYmFyLWxlZnR7cG9zaXRpb246cmVsYXRpdmU7ZmxvYXQ6bGVmdDtjbGVhcjpsZWZ0O3BhZGRpbmc6MmVtIDAgNmVtIDA7ei1pbmRleDo1MDA7d2lkdGg6MTMuNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6IzY2Njt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbjo0LjNlbSBhdXRvIDFlbSAyLjVlbTt9DQouc3VibWl0dGVke2Rpc3BsYXk6bm9uZTt9LmNvbnRhaW5lcnt6LWluZGV4OjU7aGVpZ2h0OjEwMCU7cGFkZGluZy10b3A6LjJlbTt9DQoudGl0bGUtYm94IGgxe2NvbG9yOiNkYjNiMmM7bGluZS1oZWlnaHQ6MWVtO30NCg0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVse2JvcmRlcjowO2xpc3Qtc3R5bGU6bm9uZTtoZWlnaHQ6MzFweDttYXJnaW46MDtwYWRkaW5nOjA7d2lkdGg6MTAwJTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGl7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtib3JkZXI6MDtmbG9hdDpsZWZ0O21hcmdpbjowO3BhZGRpbmc6MDtsaXN0LXN0eWxlOm5vbmU7cG9zaXRpb246cmVsYXRpdmU7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHVsIGxpIGF7ZGlzcGxheTpibG9jaztoZWlnaHQ6MzFweDt0ZXh0LWluZGVudDotNTAwMHB4O30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhe2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNjY2M7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpLm1lbnUtbWxpZC0yMzkzID4gYTpob3Zlcnt9DQoNCiNib3R0b21iYXJ7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxMy41ZW07Zm9udC1zaXplOjEzMCU7fQ0KI2JvdHRvbWJhciAuY29udGVudHttYXJnaW4tdG9wOi44ZW07fQ0KI2JvdHRvbWJhciBhe2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDNweCAzcHggM3B4O3RleHQtZGVjb3JhdGlvbjpub25lO30NCiNib3R0b21iYXIgYTpob3ZlciwNCiNib3R0b21iYXIgYS5hY3RpdmV7Y29sb3I6I2Q4M2IyYzt9DQojYm90dG9tYmFyIGJ7Zm9udC1zaXplOjEzMyU7fQ0KDQo8L3N0eWxlPg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="website_style"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiINCiJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkIj4NCjxodG1sIGNsYXNzPSJqcyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgZGlyPSJsdHIiIGxhbmc9ImVuIj4NCjxoZWFkPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4NCiAgICA8dGl0bGU+JHt0aGlzLmFwcC5uYW1lfTwvdGl0bGU+DQo8L2hlYWQ+DQoke3dlYnNpdGVfc3R5bGV9DQo8Ym9keSBjbGFzcz0ic2lkZWJhci1sZWZ0IGNyb24tY2hlY2stcHJvY2Vzc2VkIj4NCjxkaXYgaWQ9IndyYXBwZXIiPg0KPGRpdiBpZD0ibWVudWJrZyI+PC9kaXY+DQo8ZGl2IGlkPSJjb250YWluZXIiPg0KPGRpdiBpZD0iaGVhZGVyIj4NCiAgICA8ZGl2IGlkPSJsb2dvLWZsb2F0ZXIiPg0KCQk8YSB0aXRsZT0iIiBocmVmPSIke3JlcXVlc3QudXJsLnBhdGh9Ij48aW1nIGlkPSJsb2dvIiAgaGVpZ2h0PSI1MyIgd2lkdGg9IjE1OSIgYWx0PSJMYXllcjciIHNyYz0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFKOEFBQUExQ0FNQUFBQm9Rc2xhQUFBQUdYUkZXSFJUYjJaMGQyRnlaUUJCWkc5aVpTQkpiV0ZuWlZKbFlXUjVjY2xsUEFBQUFNQlFURlJGRkJBTWpJNk83cU9sYTI5dzV1Zm45TWpKNW1GZ3lNaklUMUpTNFR3dDFkZll0TGU0K2ZuNTgvVDBwNmluWFdObStlVGwvdno3K3YzK3E3cTgrdno1K3Uvdy9mbjd3TVBFNm9lSWdJU0cwZExTK2Z2OC9mei85dmo2Ny9Eem82R2ZWVnhmOS9qM3E2NncrZmYwdWJ1OW5xS2tSRUU5Mjl6ZHk4M092OEMrOWZYMTdlN3U2dXZyNHVQazVFeElkM3Q3cnEyclhsdFhob1NCOTlqYWxaaVozK0RnTHl3b1pXUmhzck95OGZIeG5aNmQrUGo3Ky96Ny9QejgvZjM5Ly8vL0FTRERZd0FBREZwSlJFRlVlTnJVV1d0N3Fqb1dOcUxGZWdGaEtCWjMyb3ExRmF1VTNZcHVXNU9zLy8rdlpxMGtJTFoyNW5ubXc1eHpjczYyR0lKNTg2NzdvZ1YvNzlINlIrQlRVa2twaFZENkd3ZWhGTWhBcWI4SlBnVUtFVWtKc0o0YzVvdWNBRXNoYVFJdjFWK1BUeGwwZDVPRXNZUWxneGZnZ1FqMXJQcHJFYllxOFFLSWFabDhac3RsMzJQTTVVRFFDSjhlZnprK2dKMlhNTmRNTGxuaW9aQVJtelFVL25VQXJYd2h6SkprRUFPWElsQ1NpMFhDc2tmU1FRV2FRdmovQU5TN3lPLzJ5L2w2L3JuUlZxSUN4QU44VTVZZFE2Mm05MzlDK0RQdjZvZHJZd3ZmOFVrK0dpRW9kREN4aUJYQ1JGUzdUdDVmZHNqWGtKQTF5Sys3Zk45ZFdVeXF3bWVWdDlwVk5VZmwyaG9UeWpKUjM5YjRBbjR6ZmdRZWNhRUNycmdJT01MS0Z5eEp5c2thMFpQelVlZG4vV0kwcCswMUxERGJHTnRYcCtYcXpOcVVPVTBOVDlvSitSV2ZpdHV2dCtNSXRTOEt3b0NneU0ycUtEeDN4Wnl5bjJvejF0NVFuVW5OL0RaODIxNXZKSnZFV0FkbXI0U3NWMVdjNmNmbDJZTk4rVzZ2cnErdjJ6Y2hpQUFDQkRQS21EUFFkemJNV1d4Q2E4b25RS0EzcktmTS9xZlAwMTF6Tkh0RG1tblpQTVdGSVdtYzQzdEZmTmRYM1VjRmtlQXlMLzJuRDJKTkJnQnVrVXp2eUpJMWg2cnk1cktHSXB1QURBejdXWCtUTmI3R0FVUURkUFZEMVZKUUpuaForUnA4MTllM04xeHk5VkVrNVAwNDJvdFFBbDZlbkRrb0RSQXNDRU9MYXNySlRndWhUNitqbzdUWDFhelFmNFRHWlNjYTRQUTU2a2R3djIvODRYZ2RjeDUwbGdvRWo1UUkwRjRvWjFnK1FZeGlGeUFxSGFIZmpYQS9YQjFvV0lUOWx4aUs0UkNQUkVpRytJbi82VU5pcU1UdmRGZlBSMUpHMFRFMGl5SzlEbjlIeFhFVTR3aGlFZUFmeGIvcW54NVhZWWg3eGZnTENwOElTSnNEY3g2QkY0cHpmVmJBMDIwbXJqdEZueVJCUnFBem5rN211bTZXNHhsZThNSmRJejFDYmFhdTJ4OUJ4NjFHSDJkaDZtYjZ5M1N0UWg0ckNBS1EzZWJZM3NBRitlSVk4NUE4RFI1SUJzaElFQWp0VzVSd2wwWlFXa1lJOGRCcXRaNUJLNmJVMGdjSFovYXROL1FQblI1ZUZTK2tSQVZPRmkvd29PL1J2ejhZbCtEWmZtM3RlMmlISVc3QjFYVnp2SGJEaS95aEZWK2hHb1lTTXhqRUZSTmF5RXRuRUhvKzJ5bEpISklhQ2ZodDhCRzE1TkFGYk41b3cxYXZBeXFsbTYwbEt1OEhJVDBBZkxhcThmWUlCcDhkZTQraUtqNy9CUjljMGovRTE2VzdiVkE4TkJvTkw1N2ordzY4N0o1OGI0U1NESVcyWTgyZkVsYW5VVTFYWnRQbkZhcHBoNjQvWHdBOFpNbjVBTU5mK2M3ZTM3MVVDSTN2YzVNUGVuUWdDREVxeFB3THZxYitqYS9POGFFZWJrbW1LQW51RnI1UCtBUjZ4YVNZWUxRaDhVckxYeWhqUEFVRlFYaEhibWkvZHpUOWlPN3UwUXZRaEljK3ZTUWdqeDg0Um1TYWhPODNia0R3bjljUTQxdzRyZ2FCdVkwYjhnMzU3VmQ4dU9JUmpaYm56UEVOdmdDTmVuTnd5ZzBRcTVhL29ISUpTajJpZUowUzkzdkRmV0ZEQ0E1OGluL2VkaEJxL25xQkRuYlM2dDhEOHV6aXhmT0c0L05oSFN2YlJNOFlnbVorZFZMQUd0LzE3WmhEdi9CbkJoODZBUHo1ZE1reXJyUmJOUHdKVFNaNkRNaHdLNVlqWDg5b3dVSHM2ZHVPNFNrdy9Kbjl1Y1huSWI0SjRmc0FOR0VWb1pESm14RzgxMjNZOUMraENydXYzL0JkdDJIMGFkQVJmeEtmUnArNVNWeUk1Y2wrY1RkQjV3ZTJiKzEvRTZEOWdxeDZRK2I1WU9oRFFNVGZjN2JDZ1c2SFcvbUNodjJHZ3RHdW1ZZGhEQVRrdFJ0RXZKRWZTQjZxN2UwM2ZGZmp6RG5oRTlhcFQzZEEvcmppTDR6STV3aUFQN2hUcmpjc0tPT1J6THFRMytTQXRQM3VuMmxNSTJudy9mbjhMRWo5TWx3ZUNSUFpqQ1cwWTJrVEppdGZqQUxoWS9mcUM3N3I3cjhxZUFaZmhQQW1aWkxCaVQvaVRwQjFrTVcrcmFhRXFrY2lWNXBBUTU4dy9Ka3hpV1hsWDNERjNza3BCZFJueEdnZjNock5EN2hzK0JkU2QxU3Vtelp5MnozRDE2dncvUUU4STBELzA1bjFQQXh6dGYvajJqdEw3VWlJSUdKa2lSSU40WDFQQUI2R1FFNUs4L2RlRk1YN0xsREd2enkvMFdjUG5hTkdSd2xEWlJ0WWFEVGxpeXJMTWQ1Q3VHMjNiN1lYOFNVb1Njam54V3ptOTd3WGltOE4vVk5HdkxYSEpjOFJDbTNDaUpYSU1mWUw2VXVheGp3eS9MSGMxZkx0RThIRzU0KzE4aW5LUTRNbVBzenQwZFBGK2lxK3VvVFB4ZmpxTW0zTVBlOE8vVjNGWDJneXVnOHl4SUl4UmtFRXlaYWhnais0T3h1UlB6SDhXZnNsYVZuNzBDSG5YYXVyVHFpTThtbnllTlN3RDFRQml2d2l4clNGZDcvam15VnBBSzQxRm8xUFdQNVVxRDBnTFBhMEVZNFZUYWU2aEhGSXZLbkJaL2pEQ2dLTFF5bXMvd1ByZGloQ2toQm81NnNiRENka0VHZjhZZFdHa2lKRjRnRzBYOC94emZ3eWg3aFQyWExQTzBKdHY1WVNuUVo0cEFOOUNyZ1paZUVWUHZMaFRmOEgxbjdKLytrZnljSDRlRTFmbHhKeXJrQis2VjloMnNTeCtFQlhPQjUzYnh2NFpuNHlXT2FqeDNrbDZwbEhuR2orOWg2TmgxeW16OXBSVU5xRlNQY01pQTV5enArMDF1cmZzMTd0ZFd6OGZiTHhBLzJsRHVOd280MGprczJtU3V0VTZtRG1URG5WemRWcmU5dStzdmhtdnZQVVh6NFZnNGlkOE4wUkVPOWtFQWZsSWxYRm1xcGxVWWxNMXZnSWEzbGF2UmlxbXIvOGp6a05LVW5RTmRxbi9TQ2MxUittcHFDR1VCRHIvS1c3dlgzRnMweDhoMlg1d08vTkhGWGpRL3NkcGNUZm5nYjVrQldVZVBFQU9rMlk0UHh6U2ljb2FKS3VVT0c4bGxtTS8wK0dFdE9HdmNhWE1wenlYMHluZ3FUV0JhbWFOWHFyV1ZoVGJoZFYrY3YydHN0SGswV2VKYVNFRFh5enczcmFRVmY0enFyUmg5LzRpVjZQV09zOHZMT3lReHdjR0h2UGhwVHVZM1JPNnRVN3hQS0F0NmFVUnl3WnJrWUZKSXNqbVcyMXg2L0x0N1ArcVJKWW5NZU4vQVhMOUE3cnpVejhxUERObkt6ajV1ZGRFdk1sVWpyUHRFN0VGbUFxTWdBYlExaDY4RGpxdEZxYngrc1d6aHRtRFh3cUNNaUV1NmZ3aXlRVnZTcStXWHl6MlFCMkIrTEtWbUttRU1NTHJuUkNxNGVlVjFVUlo1SWNrNGNOVlpYUm1wdkNya1QrWGcyK1FGN0doM2VVaWtVamZ3bEdaZVdnVC9KOXV0ZG5yd0RVdjYrTE9BTkdhbmRXTFJDbnNyRytQQU5KZzRKZXQ5M3Uzb1JWTCtYY1BrQjdIUlh3NklmOFJScDhSY1loRXVlbmw2cXVjeFZ0VkpkUnBxa3RxNlU2c2JYek5xTFY0QU9qY3FpMVhQM1V2MGZwWWhGNk9UOXdPT0Z6RGltRlZqazhVcDBicFZUQTRpWjNSNUpvZEF4K0hkRkRpU2lTUjhRcG96VDlGUVJCTk1SU04rRGg4VTVFRkFXR3VCekw2V0g4SzZhMVE0VEwwNVR1eWFvcDhnTSt2QkZFUCtDREo5OHZONkh1RSswV2g4T3FBNXY1WVhHUHoweFlPVDFDdXNxZ1AwbGgyQi9rbzhNYWZVSEdtSnRpZGIvS0tZUGVlR3lPdFFFZkxkQzhNZHhQSnFnb3kvbkJmWUcwWHpJWHF0YkRqL3pwTkNZZS81Qy9qQmI1a0pPU1NSaE5ITFlaUWQ5M2Q2bU1YU2YzaWh4R3lSTjRDVzQybUQzZCt6bUl6TzlQL0NuQW9NREFBdXRQdGlreGN6M2kyckpjQXpCcW9oeWNhVDZFRGZ1OTlEZXFxbVIreEVmbExiK1l2emdUVUVPdEtoVExZVmVVdUdYZnozTEVWeWFqSFRMelViQk9pZWxLT3VnbGZjVEg1OG5IeGhta2lNOUZCOVF2NW1yaGRPQll6SWZySGFZYkxFRW5PaSttRzB4ajNwUHB2UWhNRStxODdkbjYwbHNOd2t2NWk1OGNkWjlBNkVSWGFud0srck9rM0tpWUpSK2sxS09rR0NRTStUdjRIbk55R1RJMnN2Z3lpQWdmVEJEMjBUOTBQcjBQTVBnR2ZuTEF4RzdKL09RbE1EbSsrdkg5Rm5WYjBJdUYzZXV2K1F1N1Y5YWJtVVROOERkMThpT1h2eGc3NWhnQzdvc3lmU0w1em90K3o4bTVtaWZIa2JNWUlqNFVNdlFSeU1LWDZxN3crSXAxb09KdmczWGF4MlM5OUplYUFWQS82eCttVmhKQkJ2RzJtYi80c3dJMW1Tby8reFlNUThUU1liaDAybU5QVXhDVEdmTFdnWHVuaEtkaUJFUFBPUmIrTHBEOTJaejVmZFF4UHlrbmNGODZpK1FUa3dYUFdiQUNvU1dvc3pDZmxkNE9Pc25ud1YvYlYxZy82eCtsRFFGd3JLWnZ1bFgrNHZkUUhoRmd1b2poSmJEOVF6endsRlIrc01KQUY5MjUyU1RIVU8vMlZUOGJ3bkE1Z2VYaVE4bzBjMWZMUndXNzFXcUI4WVk2V0dqdFlqM0pwdTRJSUtPUDNXRGlidkNSbGRzWDVvM1FmM2gvYVhxak9zaUhZNnhEWDhlVDNxeGMzZ0hJWm9lVGFFeUgxSEJMMHhTTkJzUkl0NmlGYWVoSmdTRXNwVGNWS2swcHRBNXhXVXFDR3cxMTJpVkcxQWRVcVY2THR5aDFlVWxCeVV0dnFsb1hYaEZ3VXNSZzI5N0c2eW1aMTZtQnJPb0dzbW5PNkI2TnN2MXpxQnZRMHJRc2RVTmNMOU9tcFV4SHh4N1VObHUxMWxENm9NeUMvL2IrVjNjZmpSMURhTDIyUE85aU54dmV0c2RyTzdLNnF5eDBGMWlhQnJNUTByYVZxLzYxZmxiVTRidHVzWXZMYi9rdXZKOXVOT09wQ1JKRWxjOVU5ZnNNZVhwNWFMU21sbjdWZjY5YjMrWTFudTFhYXlhMW00TnE3YWxsRDVjUS9qUGVuLzk5eDc4RkdBQ0Q5Z1pIaXo2ZUZnQUFBQUJKUlU1RXJrSmdnZz09Ij48L2E+DQoJPC9kaXY+CQ0KPC9kaXY+DQo8ZGl2IGlkPSJjb250ZW50Ij4NCgk8aWZyYW1lIHN0eWxlPSJkaXNwbGF5Om5vbmUiIHNyYz0iIiBpZD0ibXlpZnJhbWUiIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9ImF1dG8iPg0KCTwvaWZyYW1lPg0KCQk8ZGl2IGlkPSJjb250ZW50X2xhbmRpbmdfcGFnZSI+ICAgICAgICAgICAgICANCgkJPGRpdiBjbGFzcz0idmlldyB2aWV3LXByb2R1Y3RzMyB2aWV3LWlkLXByb2R1Y3RzMyB2aWV3LWRpc3BsYXktaWQtcGFnZV8xIHZpZXctZG9tLWlkLTEiPgkJDQoJCTxkaXYgY2xhc3M9ImNvbnRhaW5lciI+DQoJCTxkaXYgY2xhc3M9InRpdGxlLWJveCI+DQoJCTxoMT4ke3RoaXMuYXBwLm5hbWV9PC9oMT4NCgkJPGJyPg0KCQk8aDM+T0F1dGggdmVyc2lvbjogMi4wPC9oMz4NCgkJPGJyPg0KCQkNCgkJPHA+PC9wPg0KCQkJDQoJCTwvZGl2Pg0KDQoJCSA8ZGl2IGNsYXNzPSJ2aWV3IHZpZXctcHJvZHVjdHMzIHZpZXctaWQtcHJvZHVjdHMzIHZpZXctZGlzcGxheS1pZC1wYWdlXzEgdmlldy1kb20taWQtMSI+CQ0KPGRpdiBjbGFzcz0iY29udGFpbmVyIj4="/&gt;
                    &lt;L7p:VariableToSet stringValue="website_top"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj48L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="website_bottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHt3ZWJzaXRlX3RvcH0KCQkgCjwhLS1vYXV0aF9jb250ZW50X3BsYWNlaG9sZGVyLS0+Cgoke3dlYnNpdGVfYm90dG9tfQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797512" version="2">
        <l7:ServiceDetail folderId="123600905" id="123797512" version="2">
            <l7:Name>oauth/v2</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/auth/oauth/v2/token</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>11</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="10">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This policy issues an access token"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SslAssertion/&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="d1d995ab-c7c8-4354-b005-ec3deeedc3a5"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="f0eb1f7b-392b-40a4-9f4f-46d00ffad3d3"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="POST"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="POST"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiJHtyZXF1ZXN0Lmh0dHAubWV0aG9kfSBub3QgcGVybWl0dGVkIgp9Cg=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check HTTP POST"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5ncmFudF90eXBlfEBAfSMjJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5zY29wZXxAQH0jIyR7cmVxdWVzdC5odHRwLnBhcmFtZXRlcnMuY29kZXxAQH0jIyR7cmVxdWVzdC5odHRwLnBhcmFtZXRlcnMucmVkaXJlY3RfdXJpfEBAfSMjJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5jbGllbnRfaWR8QEB9IyMke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXJzLmNsaWVudF9zZWNyZXR8QEB9IyMke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXJzLnVzZXJuYW1lfEBAfSMjJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5wYXNzd29yZHxAQH0jIyR7cmVxdWVzdC5odHRwLnBhcmFtZXRlcnMuYXNzZXJ0aW9ufEBAfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="requestParams"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Presence of &amp;quot;@@&amp;quot; indicates duplicate parameters"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="requestParams"/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue="false"/&gt;
                    &lt;L7p:Regex stringValue="@@"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiRHVwbGljYXRlIHBhcmFtZXRlcnMiCn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check for duplicate parameters in the request"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="authorization_code"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="authorization_code"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="client_credentials"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="client_credentials"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="password"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="password"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="refresh_token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="refresh_token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTWlzc2luZyBncmFudF90eXBlIgp9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check grant_type"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item regex="included"&gt;
                    &lt;L7p:Pattern stringValue="BEARER|MAC"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvciI6ImludmFsaWRfdG9rZW5fdHlwZSIKfQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Invalid token_type"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Make sure the ssg is configured for BEARER or MAC token types"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HttpBasic/&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9pZH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="otherClientId"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${otherClientId}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVzZXJuYW1lfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="client_id"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnBhc3N3b3JkfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="client_secret"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${client_id}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${client_secret}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Client credentials from Authorization header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVzZXJuYW1lfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="otherClientId"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${otherClientId}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9pZH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="client_id"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9zZWNyZXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="client_secret"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${client_id}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${client_secret}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Client credentials from POST body"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLkF1dGhvcml6YXRpb259"/&gt;
                    &lt;L7p:VariableToSet stringValue="requestAuthHeader"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${requestAuthHeader}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="authScheme"/&gt;
                    &lt;L7p:FindAll booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="requestAuthHeader"/&gt;
                    &lt;L7p:Regex stringValue="(.*)\s.*"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="WWW-Authenticate"/&gt;
                    &lt;L7p:HeaderValue stringValue="${authScheme[1]}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add WWW-Authenticate response header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfY2xpZW50IiwKICAiZXJyb3JfZGVzY3JpcHRpb24iOiJGYWlsZWQgdG8gZ2V0IGNsaWVudCBjcmVkZW50aWFscyIKfQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Get client credentials"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Get client registration information =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Y2xpZW50X2tleT0ke2NsaWVudF9pZH0mc2VjcmV0PSR7Y2xpZW50X3NlY3JldH0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="validateRequest"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${oauth_ovp_server}/oauth/validation/validate/v2/tokenrequest"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="validateRequest"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/result[text()='valid']"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathType"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/type/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathName"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/client_name/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:RateLimit&gt;
                    &lt;L7p:BlackoutPeriodInSeconds stringValue="30"/&gt;
                    &lt;L7p:CounterName stringValue="8126ba96-${client_id}"/&gt;
                    &lt;L7p:MaxRequestsPerSecond stringValue="${oauth2_client_max_fail_per_sec}"/&gt;
                    &lt;L7p:WindowSizeInSeconds stringValue="5"/&gt;
                    &lt;/L7p:RateLimit&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLkF1dGhvcml6YXRpb259"/&gt;
                    &lt;L7p:VariableToSet stringValue="requestAuthHeader"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${requestAuthHeader}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="authScheme"/&gt;
                    &lt;L7p:FindAll booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="requestAuthHeader"/&gt;
                    &lt;L7p:Regex stringValue="(.*)\s.*"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="WWW-Authenticate"/&gt;
                    &lt;L7p:HeaderValue stringValue="${authScheme[1]}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add WWW-Authenticate response header"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfY2xpZW50IiwKICAiZXJyb3JfZGVzY3JpcHRpb24iOiJDbGllbnQgYXV0aGVudGljYXRpb24gZmFpbGVkIgp9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Authenticate client and receive client values"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNjb3BlfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="scope"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${scope}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="client_credentials"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="client_credentials"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="password"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="password"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt4cGF0aFNjb3BlLnJlc3VsdH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="scope"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="If scope parameter is missing in the request, return the default scope.
                    The default scope in from client registration"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Set scope parameter to return"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="scope"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="scope"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handle scope and set a default value for certain grant_types"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="YXRfMg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token_type"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="585c3a3d-8fd7-4337-8d91-46846bfc4194"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5Ub2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="at_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5FeHBpcmF0aW9ufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="at_expiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5TZWNyZXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="mac_secret"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="cmZ0"/&gt;
                    &lt;L7p:VariableToSet stringValue="token_type"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="585c3a3d-8fd7-4337-8d91-46846bfc4194"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5Ub2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="rtoken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5FeHBpcmF0aW9ufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="rexpiration"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Generate tokens to be used later"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="authorization_code"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="authorization_code"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.code}"/&gt;
                    &lt;L7p:Expression2 stringValue="authorization_code"/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue="authorization_code"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiTWlzc2luZyBhdXRob3JpemF0aW9uIGNvZGUiCn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check for existince of the code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="request.http.parameter.redirect_uri"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="callback"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Y2xpZW50X2tleT0ke2NsaWVudF9pZH0mdG9rZW49JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvZGV9JmNhbGxiYWNrPSR7Y2FsbGJhY2t9"/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="toValidation"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${oauth_ovp_server}/oauth/validation/validate/v2/granttype"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="toValidation"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/result[text()='valid']"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathOwner"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/resource_owner/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathScope.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="scope"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathOwner.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validate and retrieve values"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Delete the authorization code. The authorization code should
                    be consumed at most once. =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="dGVtcF90b2tlbj0ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuY29kZX0="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="deleteMessage"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Delete authorization_code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth_tokenstore_server}/oauth/tokenstore/delete"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="deleteMessage"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="deleteResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6IkJlYXJlciIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0mc2VjcmV0PSR7bWFjX3NlY3JldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6Im1hYyIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSIsDQogICJtYWNfa2V5IjoiJHttYWNfc2VjcmV0fSIsDQogICJtYWNfYWxnb3JpdGhtIjoiaG1hYy1zaGEtMSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create tokens"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant_type: auth_code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="client_credentials"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="client_credentials"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${xpathType.result}"/&gt;
                    &lt;L7p:Expression2 stringValue="confidential"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="confidential"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfZ3JhbnQiLAogICJlcnJvcl9kZXNjcmlwdGlvbiI6Ik11c3QgYmUgY29uZmlkZW50aWFsIGNsaWVudCIKfQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check confidential clients"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathName.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnNjb3BlPSR7c2NvcGV9JnJlc291cmNlX293bmVyPSR7b3duZXJ9JmNsaWVudF9rZXk9JHtjbGllbnRfaWR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6IkJlYXJlciIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInNjb3BlIjoiJHtzY29wZX0iDQp9"/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnNjb3BlPSR7c2NvcGV9JnJlc291cmNlX293bmVyPSR7b3duZXJ9JmNsaWVudF9rZXk9JHtjbGllbnRfaWR9JnNlY3JldD0ke21hY19zZWNyZXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6Im1hYyIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInNjb3BlIjoiJHtzY29wZX0iLA0KICAibWFjX2tleSI6IiR7bWFjX3NlY3JldH0iLA0KICAibWFjX2FsZ29yaXRobSI6ImhtYWMtc2hhLTEiDQp9"/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create tokens"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant_type: client_credentials"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="password"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="password"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:RateLimit&gt;
                    &lt;L7p:BlackoutPeriodInSeconds stringValue="30"/&gt;
                    &lt;L7p:CounterName stringValue="cd416d07-${request.http.parameter.username}"/&gt;
                    &lt;L7p:MaxRequestsPerSecond stringValue="${oauth2_resource_owner_max_fail_per_sec}"/&gt;
                    &lt;L7p:WindowSizeInSeconds stringValue="5"/&gt;
                    &lt;/L7p:RateLimit&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:XpathCredentialSource&gt;
                    &lt;L7p:PasswordExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="$request.http.parameter.password"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:PasswordExpression&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="$request.http.parameter.username"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:XpathCredentialSource&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Authenticate resource owner =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Authentication&gt;
                    &lt;L7p:IdentityProviderOid longValue="-2"/&gt;
                    &lt;/L7p:Authentication&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfZ3JhbnQiLAogICJlcnJvcl9kZXNjcmlwdGlvbiI6IlJlc291cmNlIE93bmVyIGF1dGhlbnRpY2F0aW9uIGZhaWxlZCIKfQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Authenticate user"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="request.authenticatedUser"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6IkJlYXJlciIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0mc2VjcmV0PSR7bWFjX3NlY3JldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6Im1hYyIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSIsDQogICJtYWNfa2V5IjoiJHttYWNfc2VjcmV0fSIsDQogICJtYWNfYWxnb3JpdGhtIjoiaG1hYy1zaGEtMSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create tokens"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant_type: password"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="http://oauth.net/grant_type/assertion/saml/2.0/bearer"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.assertion}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item stringLength="included"&gt;
                    &lt;L7p:Max intValue="-1"/&gt;
                    &lt;L7p:Min intValue="1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Validation of the SAML assertion =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFzc2VydGlvbn0="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="bearerToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ValidateNonSoapSaml&gt;
                    &lt;L7p:AuthenticationStatement samlAuthenticationInfo="included"&gt;
                    &lt;L7p:AuthenticationMethods stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="urn:ietf:rfc:1510"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:MobileTwoFactorContract"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:am:unspecified"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:am:SPKI"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:am:X509-PKI"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:Smartcard"/&gt;
                    &lt;L7p:item stringValue="urn:ietf:rfc:3075"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:TimeSyncToken"/&gt;
                    &lt;L7p:item stringValue="urn:ietf:rfc:2945"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:SmartcardPKI"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:PreviousSession"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:MobileTwoFactorUnregistered"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:MobileOneFactorContract"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:NomadTelephony"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:MobileOneFactorUnregistered"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:AuthenticatedTelephony"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:am:PGP"/&gt;
                    &lt;L7p:item stringValue="urn:ietf:rfc:2246"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:PersonalizedTelephony"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocol"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:Telephony"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocolPassword"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:2.0:ac:classes:SoftwarePKI"/&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:am:password"/&gt;
                    &lt;/L7p:AuthenticationMethods&gt;
                    &lt;/L7p:AuthenticationStatement&gt;
                    &lt;L7p:CheckAssertionValidity booleanValue="false"/&gt;
                    &lt;L7p:MaxExpiry longValue="3600000"/&gt;
                    &lt;L7p:NameFormats stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"/&gt;
                    &lt;/L7p:NameFormats&gt;
                    &lt;L7p:NameQualifier stringValue=""/&gt;
                    &lt;L7p:NoSubjectConfirmation booleanValue="true"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="bearerToken"/&gt;
                    &lt;L7p:SubjectConfirmationDataCheckValidity booleanValue="false"/&gt;
                    &lt;L7p:SubjectConfirmations stringArrayValue="included"&gt;
                    &lt;L7p:item stringValue="urn:oasis:names:tc:SAML:1.0:cm:bearer"/&gt;
                    &lt;/L7p:SubjectConfirmations&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:Version boxedIntegerValue="2"/&gt;
                    &lt;/L7p:ValidateNonSoapSaml&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Validate the trusted issuer by adding a FIP here
                    =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="========== Get Subject Name ID from SAML token =========="/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmFzc2VydGlvbn0="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="saml_assertion"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="saml_assertion"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/saml2:Assertion/saml2:Subject/saml2:NameID"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="saml2"/&gt;
                    &lt;L7p:value stringValue="urn:oasis:names:tc:SAML:2.0:assertion"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="responseXpath.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnNjb3BlPSR7c2NvcGV9JnJlc291cmNlX293bmVyPSR7b3duZXJ9JmNsaWVudF9rZXk9JHtjbGllbnRfaWR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6IkJlYXJlciIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInNjb3BlIjoiJHtzY29wZX0iDQp9"/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnNjb3BlPSR7c2NvcGV9JnJlc291cmNlX293bmVyPSR7b3duZXJ9JmNsaWVudF9rZXk9JHtjbGllbnRfaWR9JnNlY3JldD0ke21hY19zZWNyZXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6Im1hYyIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInNjb3BlIjoiJHtzY29wZX0iLA0KICAibWFjX2tleSI6IiR7bWFjX3NlY3JldH0iLA0KICAibWFjX2FsZ29yaXRobSI6ImhtYWMtc2hhLTEiDQp9"/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create tokens"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant_type: saml"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.grant_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="refresh_token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="refresh_token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="c2NvcGU9JHtzY29wZX0mcnRva2VuPSR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5yZWZyZXNoX3Rva2VufSZjbGllbnRfa2V5PSR7Y2xpZW50X2lkfQ=="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="toValidation"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${oauth_ovp_server}/oauth/validation/validate/v2/refreshtoken"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="toValidation"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue=""/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/result[text()='valid']"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validate and retrieve values"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathValidationResultScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathValidationResultOwner"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/resource_owner/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathValidationResultScope.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="scope"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathValidationResultOwner.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6IkJlYXJlciIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdF90b2tlbn0mZXhwaXJhdGlvbj0ke2F0X2V4cGlyYXRpb259JnJ0b2tlbj0ke3J0b2tlbn0mcmV4cGlyYXRpb249JHtyZXhwaXJhdGlvbn0mc2NvcGU9JHtzY29wZX0mcmVzb3VyY2Vfb3duZXI9JHtvd25lcn0mY2xpZW50X2tleT0ke2NsaWVudF9pZH0mc2VjcmV0PSR7bWFjX3NlY3JldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="ew0KICAiYWNjZXNzX3Rva2VuIjoiJHthdF90b2tlbn0iLA0KICAidG9rZW5fdHlwZSI6Im1hYyIsDQogICJleHBpcmVzX2luIjoke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfSwNCiAgInJlZnJlc2hfdG9rZW4iOiIke3J0b2tlbn0iLA0KICAic2NvcGUiOiIke3Njb3BlfSIsDQogICJtYWNfa2V5IjoiJHttYWNfc2VjcmV0fSIsDQogICJtYWNfYWxnb3JpdGhtIjoiaG1hYy1zaGEtMSINCn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="clientResponse"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create tokens"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="cnRva2VuPSR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5yZWZyZXNoX3Rva2VufQ=="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="deleteRtoken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth_tokenstore_server}/oauth/tokenstore/delete"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="SOAPAction"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="deleteRtoken"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant_type: refresh_token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="grant types"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="xpathName.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="client_name"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtzdG9yZVRva2VufSZjbGllbnRfbmFtZT0ke2NsaWVudF9uYW1lfSZzdGF0dXM9RU5BQkxFRA=="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="storeToken"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth_tokenstore_server}/oauth/tokenstore/store"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="storeToken"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="storeTokenResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${storeTokenResult.mainpart}"/&gt;
                    &lt;L7p:Expression2 stringValue="persisted"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="persisted"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtjbGllbnRSZXNwb25zZX0="/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Pragma"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-cache"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Cache-Control"/&gt;
                    &lt;L7p:HeaderValue stringValue="no-store"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797511" version="2">
        <l7:ServiceDetail folderId="123600905" id="123797511" version="2">
            <l7:Name>oauth/v2</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/auth/oauth/v2/authorize</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>12</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="11">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This policy issues an authorization grant"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="f0eb1f7b-392b-40a4-9f4f-46d00ffad3d3"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="d1d995ab-c7c8-4354-b005-ec3deeedc3a5"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SslAssertion/&gt;
                    &lt;L7p:CustomizeErrorResponse&gt;
                    &lt;L7p:Content stringValue="An error occured. Please contact the system administrator or try again
                    later."/&gt;
                    &lt;L7p:ExtraHeaders nameValuePairArray="included"/&gt;
                    &lt;L7p:HttpStatus stringValue="400"/&gt;
                    &lt;/L7p:CustomizeErrorResponse&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl
                    stringValue="${oauth2_auth_template_server}${oauth2_auth_template_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="SOAPAction"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="websiteTemplate"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt3ZWJzaXRlVGVtcGxhdGUubWFpbnBhcnR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="content"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt3ZWJzaXRlVGVtcGxhdGUubWFpbnBhcnR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="errorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Generate website content"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="POST"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="POST"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.method}"/&gt;
                    &lt;L7p:Expression2 stringValue="GET"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="GET"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiJHtyZXF1ZXN0Lmh0dHAubWV0aG9kfSBub3QgcGVybWl0dGVkIgp9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check HTTP POST or GET"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5yZXNwb25zZV90eXBlfEBAfSMjJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVycy5jbGllbnRfaWR8QEB9IyMke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXJzLnJlZGlyZWN0X3VyaXxAQH0jIyR7cmVxdWVzdC5odHRwLnBhcmFtZXRlcnMuc2NvcGV8QEB9IyMke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXJzLnN0YXRlfEBAfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="requestParams"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Presence of &amp;quot;@@&amp;quot; indicates duplicate parameters"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="requestParams"/&gt;
                    &lt;L7p:ProceedIfPatternMatches booleanValue="false"/&gt;
                    &lt;L7p:Regex stringValue="@@"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="ewogICJlcnJvciI6ImludmFsaWRfcmVxdWVzdCIsCiAgImVycm9yX2Rlc2NyaXB0aW9uIjoiRHVwbGljYXRlIHBhcmFtZXRlcnMiCn0="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check for duplicate parameters in the request"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.sessionID}"/&gt;
                    &lt;L7p:Expression2 stringValue="client_authorize"/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue="client_authorize"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:XpathCredentialSource&gt;
                    &lt;L7p:PasswordExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="$request.http.parameter.password"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:PasswordExpression&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="$request.http.parameter.username"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:XpathCredentialSource&gt;
                    &lt;L7p:HttpBasic/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:Authentication&gt;
                    &lt;L7p:IdentityProviderOid longValue="-2"/&gt;
                    &lt;/L7p:Authentication&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWRVc2VyfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="resource_owner"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:UUIDGenerator&gt;
                    &lt;L7p:MaximumQuantity intValue="1"/&gt;
                    &lt;L7p:TargetVariable stringValue="sessionUserID"/&gt;
                    &lt;/L7p:UUIDGenerator&gt;
                    &lt;L7p:GenerateSecurityHash&gt;
                    &lt;L7p:Base64Data stringValue="JHtyZXNvdXJjZV9vd25lcn0="/&gt;
                    &lt;L7p:KeyText stringValue="${sessionUserID[0]}"/&gt;
                    &lt;L7p:LineBreak lineBreak="CR-LF"/&gt;
                    &lt;L7p:TargetOutputVariable stringValue="userSessionHash"/&gt;
                    &lt;/L7p:GenerateSecurityHash&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PHM+DQo8a2V5PiR7c2Vzc2lvblVzZXJJRFswXX08L2tleT4NCjxoYXNoPiR7dXNlclNlc3Npb25IYXNofTwvaGFzaD4NCjwvcz4="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="userSession"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${resource_owner}"/&gt;
                    &lt;L7p:CacheId stringValue="userSessionIDCacheV2"/&gt;
                    &lt;L7p:MaxEntries stringValue="1000"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="3000000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="userSession"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create a session for the user"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Authenticate"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CookieCredentialSource&gt;
                    &lt;L7p:CookieName stringValue="l7otk2a"/&gt;
                    &lt;/L7p:CookieCredentialSource&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="authUserCookie"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="request.http.header.cookie"/&gt;
                    &lt;L7p:Regex stringValue="l7otk2a=(.+)($|;|\s)"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthdXRoVXNlckNvb2tpZVsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="resource_owner"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TransformType transformType="BASE64_DECODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${resource_owner}"/&gt;
                    &lt;L7p:CacheId stringValue="userSessionIDCacheV2"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="3000000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="userSession"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="sessionKey"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="userSession"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/s/key/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="sessionReference"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="userSession"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/s/hash/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:GenerateSecurityHash&gt;
                    &lt;L7p:Base64Data stringValue="JHtyZXNvdXJjZV9vd25lcn0="/&gt;
                    &lt;L7p:KeyText stringValue="${sessionKey.result}"/&gt;
                    &lt;L7p:LineBreak lineBreak="CR-LF"/&gt;
                    &lt;L7p:TargetOutputVariable stringValue="userSessionHash"/&gt;
                    &lt;/L7p:GenerateSecurityHash&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${userSessionHash}"/&gt;
                    &lt;L7p:Expression2 stringValue="${sessionReference.result}"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="${sessionReference.result}"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Validate that the user is the one who started the session"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Use session-cookie"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPjxiPkF1dGhlbnRpY2F0aW9uIGZhaWxlZDwvYj48L3A+DQo8L2Rpdj4="/&gt;
                    &lt;L7p:VariableToSet stringValue="newErrorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newErrorContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="NDAx"/&gt;
                    &lt;L7p:VariableToSet stringValue="errorStatus"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="${errorStatus}"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Set-Cookie"/&gt;
                    &lt;L7p:HeaderValue stringValue="l7otk2a="/&gt;
                    &lt;L7p:RemoveExisting booleanValue="true"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Authentication error"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Authenticate resource_owner"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="Grant"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="Grant"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.http.parameter.sessionID}"/&gt;
                    &lt;L7p:CacheId stringValue="authorizeCache"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="grantedContent"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeClientName"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/clientName/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeClientID"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/client_id/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeRedirectURI"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/redirect_uri/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeResponseType"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/response_type/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeState"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/state"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="authorizeClientName.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="authorizeClientName"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGF1dGhvcml6ZT4NCiAgICA8Y2xpZW50TmFtZT48IVtDREFUQVtdXT48L2NsaWVudE5hbWU+DQogICAgPGNsaWVudF9pZD48IVtDREFUQVtdXT48L2NsaWVudF9pZD4NCiAgICA8cmVkaXJlY3RfdXJpPjwhW0NEQVRBW11dPjwvcmVkaXJlY3RfdXJpPg0KICAgIDxvcmlnaW5hbF9yZWRpcmVjdF91cmk+PCFbQ0RBVEFbXV0+PC9vcmlnaW5hbF9yZWRpcmVjdF91cmk+DQogICAgPHJlc3BvbnNlX3R5cGU+PCFbQ0RBVEFbXV0+PC9yZXNwb25zZV90eXBlPg0KICAgIDxzY29wZT48IVtDREFUQVtdXT48L3Njb3BlPg0KICAgIDxzdGF0ZT48IVtDREFUQVtdXT48L3N0YXRlPg0KPC9hdXRob3JpemU+"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="override"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Override (delete) cache entry"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.http.parameter.sessionID}"/&gt;
                    &lt;L7p:CacheId stringValue="authorizeCache"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="5000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="override"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access the values stored in the cache"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPjxiPlRoZSBzZXNzaW9uIGhhcyBleHBpcmVkIG9yIGFscmVhZHkgYmVlbiBncmFudGVkPC9iPjwvcD4NCjwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="newErrorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newErrorContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="The granted process has takten too long"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Get granted values"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${authorizeResponseType.result}"/&gt;
                    &lt;L7p:Expression2 stringValue="token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="MAC"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="MAC"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Must be BEARER or MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="YXRfMg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token_type"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="585c3a3d-8fd7-4337-8d91-46846bfc4194"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5Ub2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="access_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create access_token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHthdXRob3JpemVSZWRpcmVjdFVSSS5yZXN1bHR9I2FjY2Vzc190b2tlbj0ke2FjY2Vzc190b2tlbn0mZXhwaXJlc19pbj0ke29hdXRoMl9hY2Nlc3NfdG9rZW5fbGlmZXRpbWVfc2VjfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthY2Nlc3NfdG9rZW59JmV4cGlyYXRpb249JHtnZW5FeHBpcmF0aW9ufSZzY29wZT0ke2F1dGhvcml6ZVNjb3BlLnJlc3VsdH0mcmVzb3VyY2Vfb3duZXI9JHtyZXNvdXJjZV9vd25lcn0mY2xpZW50X2tleT0ke2F1dGhvcml6ZUNsaWVudElELnJlc3VsdH0mY2xpZW50X25hbWU9JHthdXRob3JpemVDbGllbnROYW1lfSZzdGF0dXM9RU5BQkxFRA=="/&gt;
                    &lt;L7p:VariableToSet stringValue="toStore"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${oauth2_token_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="BEARER"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="BEARER"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtsb2NhdGlvbn0mdG9rZW5fdHlwZT1CZWFyZXI="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=BEARER"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5TZWNyZXR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="mac_key"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0b1N0b3JlfSZzZWNyZXQ9JHttYWNfa2V5fQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="toStore"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtsb2NhdGlvbn0mdG9rZW5fdHlwZT1tYWMmbWFjX2tleT0ke21hY19rZXl9Jm1hY19hbGdvcml0aG09aG1hYy1zaGEtMQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="token_type=MAC"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Invalid token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHthdXRob3JpemVSZWRpcmVjdFVSSS5yZXN1bHR9P2Vycm9yPWludmFsaWRfdG9rZW5fdHlwZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access was granted: response_type=token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${authorizeResponseType.result}"/&gt;
                    &lt;L7p:Expression2 stringValue="code"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="code"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="YWM="/&gt;
                    &lt;L7p:VariableToSet stringValue="token_type"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="585c3a3d-8fd7-4337-8d91-46846bfc4194"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtnZW5Ub2tlbn0="/&gt;
                    &lt;L7p:VariableToSet stringValue="authorization_code"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="authorizeRedirectURI.result"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="redirect_uri"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="dG9rZW49JHthdXRob3JpemF0aW9uX2NvZGV9JmV4cGlyYXRpb249JHtnZW5FeHBpcmF0aW9ufSZzY29wZT0ke2F1dGhvcml6ZVNjb3BlLnJlc3VsdH0mcmVzb3VyY2Vfb3duZXI9JHtyZXNvdXJjZV9vd25lcn0mY2xpZW50X2tleT0ke2F1dGhvcml6ZUNsaWVudElELnJlc3VsdH0mY2xpZW50X25hbWU9JHthdXRob3JpemVDbGllbnROYW1lfSZjYWxsYmFjaz0ke3JlZGlyZWN0X3VyaX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="toStore"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHthdXRob3JpemVSZWRpcmVjdFVSSS5yZXN1bHR9P2NvZGU9JHthdXRob3JpemF0aW9uX2NvZGV9"/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access was granted: response_type=code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Decide wether to issue an access_token or an authorization_code"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHt0b1N0b3JlfQ=="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="toStore"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth_tokenstore_server}/oauth/tokenstore/store"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="toStore"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="storeResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${storeResult.mainpart}"/&gt;
                    &lt;L7p:Expression2 stringValue="persisted"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="persisted"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Persist"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPjxiPlRoZSB0b2tlbiBjb3VsZCBub3QgYmUgaXNzdWVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyIG9yIGNvbnRhY3QgeW91ciBzeXN0ZW0gYWRtaW5pc3RyYXRvcjwvYj48L3A+DQo8L2Rpdj4="/&gt;
                    &lt;L7p:VariableToSet stringValue="newErrorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newErrorContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Error persisting the token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Persist the issued token"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${authorizeState.result}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="add state parameter if sent in request message"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${authorizeScope.result}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtsb2NhdGlvbn0mc2NvcGU9JHthdXRob3JpemVTY29wZS5yZXN1bHR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="add scope parameter if sent in request message"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="resource_owner_cookie"/&gt;
                    &lt;L7p:TransformType transformType="BASE64_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Redirect back to the client"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="302"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html;"/&gt;
                    &lt;L7p:ResponseStatus stringValue="302"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Location"/&gt;
                    &lt;L7p:HeaderValue stringValue="${location}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Set-Cookie"/&gt;
                    &lt;L7p:HeaderValue stringValue="l7otk2a=${resource_owner_cookie}"/&gt;
                    &lt;L7p:RemoveExisting booleanValue="true"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access was granted"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="Deny"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="Deny"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.http.parameter.sessionID}"/&gt;
                    &lt;L7p:CacheId stringValue="authorizeCache"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="600000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="grantedContent"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeRedirectURI"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/redirect_uri/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="authorizeState"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="grantedContent"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/authorize/state"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHthdXRob3JpemVSZWRpcmVjdFVSSS5yZXN1bHR9P2Vycm9yPWFjY2Vzc19kZW5pZWQ="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Get the redirect URI and state value"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPjxiPlRoZSBwZXJpb2Qgb2YgdGltZSB0byBkZW55IGFjY2VzcyBoYXMgZXhwaXJlZDwvYj48L3A+DQo8L2Rpdj4="/&gt;
                    &lt;L7p:VariableToSet stringValue="newErrorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newErrorContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="401"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="401"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create the redirect location"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGF1dGhvcml6ZT4NCiAgICA8Y2xpZW50TmFtZT48IVtDREFUQVtdXT48L2NsaWVudE5hbWU+DQogICAgPGNsaWVudF9pZD48IVtDREFUQVtdXT48L2NsaWVudF9pZD4NCiAgICA8cmVkaXJlY3RfdXJpPjwhW0NEQVRBW11dPjwvcmVkaXJlY3RfdXJpPg0KICAgIDxvcmlnaW5hbF9yZWRpcmVjdF91cmk+PCFbQ0RBVEFbXV0+PC9vcmlnaW5hbF9yZWRpcmVjdF91cmk+DQogICAgPHJlc3BvbnNlX3R5cGU+PCFbQ0RBVEFbXV0+PC9yZXNwb25zZV90eXBlPg0KICAgIDxzY29wZT48IVtDREFUQVtdXT48L3Njb3BlPg0KICAgIDxzdGF0ZT48IVtDREFUQVtdXT48L3N0YXRlPg0KPC9hdXRob3JpemU+"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="override"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Override (delete) cache entry"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.http.parameter.sessionID}"/&gt;
                    &lt;L7p:CacheId stringValue="authorizeCache"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="5000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="override"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${authorizeState.result}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtsb2NhdGlvbn0mc3RhdGU9JHthdXRob3JpemVTdGF0ZS5yZXN1bHR9"/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="add state parameter if sent in request message"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="302"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Redirect"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="302"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Location"/&gt;
                    &lt;L7p:HeaderValue stringValue="${location}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Access was denied"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="reset"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="reset"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPlBsZWFzZSBnbyBiYWNrIHRvIHRoZSBjbGllbnQgYW5kIHJlcXVlc3QgYWNjZXNzIHRvIHJlc291cmNlcyBhZ2FpbjwvcD4NCjwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="newContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="content"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtjb250ZW50fQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Set-Cookie"/&gt;
                    &lt;L7p:HeaderValue stringValue="l7otk2a="/&gt;
                    &lt;L7p:RemoveExisting booleanValue="true"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Wrong user"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.client_id}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.response_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="code"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="code"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.response_type}"/&gt;
                    &lt;L7p:Expression2 stringValue="token"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="token"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlc3Npb25JRH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="sessionID"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${sessionID}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlZGlyZWN0X3VyaX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="redirect_uri"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNjb3BlfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="scope"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="redirect_uri"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="callback"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="scope"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="scope"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Y2xpZW50X2tleT0ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuY2xpZW50X2lkfSZjYWxsYmFjaz0ke2NhbGxiYWNrfSZyZXNwb25zZV90eXBlPSR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5yZXNwb25zZV90eXBlfSZzY29wZT0ke3Njb3BlfQ=="/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="validationRequest"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth_ovp_server}/oauth/validation/v2/authorize"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="SOAPAction"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="validationRequest"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:ResponseMsgDest stringValue="validationResult"/&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathResult"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/result/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${xpathResult.result}"/&gt;
                    &lt;L7p:Expression2 stringValue="valid"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:RightValue stringValue="valid"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathScope"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/scope/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathName"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/clientName/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathRedirectURI"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/redirect_uri/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathResponseType"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/response_type"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="success"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:VariablePrefix stringValue="xpathError"/&gt;
                    &lt;L7p:XmlMsgSrc stringValue="validationResult"/&gt;
                    &lt;L7p:XpathExpression xpathExpressionValue="included"&gt;
                    &lt;L7p:Expression stringValue="/validation/error/text()"/&gt;
                    &lt;L7p:Namespaces mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="s"/&gt;
                    &lt;L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Namespaces&gt;
                    &lt;/L7p:XpathExpression&gt;
                    &lt;/L7p:ResponseXpathAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPg0KJHt4cGF0aEVycm9yLnJlc3VsdH0NCjwvcD4NCjwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="newErrorContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newErrorContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="400"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="400"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:FalseAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Error"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Get the client values"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${xpathResponseType.result}"/&gt;
                    &lt;L7p:Expression2 stringValue="ddd"/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue="ddd"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:UUIDGenerator&gt;
                    &lt;L7p:MaximumQuantity intValue="2"/&gt;
                    &lt;L7p:Quantity stringValue="2"/&gt;
                    &lt;L7p:TargetVariable stringValue="sessionID"/&gt;
                    &lt;/L7p:UUIDGenerator&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGF1dGhvcml6ZT4NCiAgICA8Y2xpZW50TmFtZT48IVtDREFUQVske3hwYXRoTmFtZS5yZXN1bHR9XV0+PC9jbGllbnROYW1lPg0KICAgIDxjbGllbnRfaWQ+PCFbQ0RBVEFbJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNsaWVudF9pZH1dXT48L2NsaWVudF9pZD4NCiAgICA8cmVkaXJlY3RfdXJpPjwhW0NEQVRBWyR7eHBhdGhSZWRpcmVjdFVSSS5yZXN1bHR9XV0+PC9yZWRpcmVjdF91cmk+DQogICAgPHJlc3BvbnNlX3R5cGU+PCFbQ0RBVEFbJHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX3R5cGV9XV0+PC9yZXNwb25zZV90eXBlPg0KICAgIDxzY29wZT48IVtDREFUQVske3hwYXRoU2NvcGUucmVzdWx0fV1dPjwvc2NvcGU+DQogICAgPHN0YXRlPjwhW0NEQVRBWyR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5zdGF0ZX1dXT48L3N0YXRlPg0KICAgIDxzZXNzaW9uPjwhW0NEQVRBWyR7c2Vzc2lvbklEWzFdfV1dPjwvc2Vzc2lvbj4NCjwvYXV0aG9yaXplPg=="/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="authorizeContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${sessionID[0]}"/&gt;
                    &lt;L7p:CacheId stringValue="authorizeCache"/&gt;
                    &lt;L7p:MaxEntries stringValue="10000"/&gt;
                    &lt;L7p:MaxEntryAgeMillis stringValue="600000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="authorizeContent"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="All validation passed. Generate website content"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CookieCredentialSource&gt;
                    &lt;L7p:CookieName stringValue="l7otk2a"/&gt;
                    &lt;/L7p:CookieCredentialSource&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:CaptureVar stringValue="authUserCookie"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="request.http.header.cookie"/&gt;
                    &lt;L7p:Regex stringValue="l7otk2a=(.+)($|;|\s)"/&gt;
                    &lt;L7p:Replacement stringValue=""/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHthdXRoVXNlckNvb2tpZVsxXX0="/&gt;
                    &lt;L7p:VariableToSet stringValue="resource_owner"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TransformType transformType="BASE64_DECODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="resource_owner"/&gt;
                    &lt;L7p:TransformType transformType="URL_DECODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPldlbGNvbWUgYmFjayA8Yj4ke3Jlc291cmNlX293bmVyfTwvYj4gKG5vdCAke3Jlc291cmNlX293bmVyfT8gPGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9P2FjdGlvbj1yZXNldCI+Q2xpY2sgaGVyZTwvYT4pPC9wPg0KPHA+DQpBIGNsaWVudCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllcyBpcyBzZWVraW5nIGFjY2VzcyB0byByZXNvdXJjZXM6DQo8dGFibGU+DQo8dHI+PHRkPjxiPmNsaWVudF9uYW1lOjwvYj48L3RkPjx0ZD4ke3hwYXRoTmFtZS5yZXN1bHR9PC90ZD48L3RyPg0KPHRyPjx0ZD48Yj5jbGllbnRfaWQ6PC9iPjwvdGQ+PHRkPiR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5jbGllbnRfaWR9PC90ZD48L3RyPg0KPHRyPjx0ZD48Yj5yZWRpcmVjdF91cmk6PC9iPjwvdGQ+PHRkPiR7eHBhdGhSZWRpcmVjdFVSSS5yZXN1bHR9PC90ZD48L3RyPg0KPHRyPjx0ZD48Yj5yZXNwb25zZV90eXBlOjwvYj48L3RkPjx0ZD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVzcG9uc2VfdHlwZX08L3RkPjwvdHI+DQo8dHI+PHRkPjxiPnNjb3BlOjwvYj48L3RkPjx0ZD4ke3hwYXRoU2NvcGUucmVzdWx0fTwvdGQ+PC90cj4NCjwvdGFibGU+DQo8L3A+DQoNCjxwPlBsZWFzZSBncmFudCBvciBkZW55IHRoZSByZXF1ZXN0PC9wPg0KDQo8Zm9ybSBhY3Rpb249IiR7cmVxdWVzdC51cmwucHJvdG9jb2x9Oi8vJHtyZXF1ZXN0LnVybC5ob3N0fToke3JlcXVlc3QudXJsLnBvcnR9JHtyZXF1ZXN0LnVybC5wYXRofSI+DQoJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic2Vzc2lvbklEIiB2YWx1ZT0iJHtzZXNzaW9uSURbMF19Ii8+DQogPHRhYmxlPg0KIDx0cj4NCiAgPHRkPjxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9ImFjdGlvbiIgdmFsdWU9IkdyYW50Ii8+PC90ZD4NCiAgPHRkPjxpbnB1dCB0eXBlPSJzdWJtaXQiIG5hbWU9ImFjdGlvbiIgdmFsdWU9IkRlbnkiLz48L3RkPg0KIDwvdHI+DQogPC90YWJsZT4NCjwvZm9ybT4NCg0KPC9kaXY+"/&gt;
                    &lt;L7p:VariableToSet stringValue="newContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPg0KQSBjbGllbnQgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXMgaXMgc2Vla2luZyBhY2Nlc3MgdG8gcmVzb3VyY2VzOg0KPHRhYmxlPg0KPHRyPjx0ZD48Yj5jbGllbnRfbmFtZTo8L2I+PC90ZD48dGQ+JHt4cGF0aE5hbWUucmVzdWx0fTwvdGQ+PC90cj4NCjx0cj48dGQ+PGI+Y2xpZW50X2lkOjwvYj48L3RkPjx0ZD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuY2xpZW50X2lkfTwvdGQ+PC90cj4NCjx0cj48dGQ+PGI+cmVkaXJlY3RfdXJpOjwvYj48L3RkPjx0ZD4ke3hwYXRoUmVkaXJlY3RVUkkucmVzdWx0fTwvdGQ+PC90cj4NCjx0cj48dGQ+PGI+cmVzcG9uc2VfdHlwZTo8L2I+PC90ZD48dGQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlc3BvbnNlX3R5cGV9PC90ZD48L3RyPg0KPHRyPjx0ZD48Yj5zY29wZTo8L2I+PC90ZD48dGQ+JHt4cGF0aFNjb3BlLnJlc3VsdH08L3RkPjwvdHI+DQo8L3RhYmxlPg0KPC9wPg0KDQo8cD5UbyBncmFudCBvciBkZW55IHRoZSByZXF1ZXN0IHlvdSBuZWVkIHRvIHByb3ZpZGUgeW91ciBjcmVkZW50aWFsczwvcD4NCg0KPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249IiR7cmVxdWVzdC51cmwucHJvdG9jb2x9Oi8vJHtyZXF1ZXN0LnVybC5ob3N0fToke3JlcXVlc3QudXJsLnBvcnR9JHtyZXF1ZXN0LnVybC5wYXRofSIgb25zdWJtaXQ9InJldHVybiB2YWxpZGF0ZUZvcm0oKSI+DQoJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic2Vzc2lvbklEIiB2YWx1ZT0iJHtzZXNzaW9uSURbMF19Ii8+DQogPHRhYmxlPg0KIDx0cj4NCiA8dGQ+VXNlcm5hbWU6PC90ZD48dGQ+PGlucHV0IHR5cGU9InRleHQiIGlkPSJ1c2VybmFtZSIgbmFtZT0idXNlcm5hbWUiLz48L3RkPg0KIDwvdHI+DQogPHRyPg0KIDx0ZD5QYXNzd29yZDo8L3RkPjx0ZD48aW5wdXQgdHlwZT0icGFzc3dvcmQiIGlkPSJwYXNzd29yZCIgbmFtZT0icGFzc3dvcmQiLz48L3RkPg0KIDwvdHI+DQogPHRyPjx0ZCBjb2xzcGFuPSIyIj48aHIvPjwvdGQ+PC90cj4NCiA8dHI+DQogIDx0ZD48aW5wdXQgdHlwZT0ic3VibWl0IiBuYW1lPSJhY3Rpb24iIHZhbHVlPSJHcmFudCIvPjwvdGQ+DQogIDx0ZD48aW5wdXQgdHlwZT0ic3VibWl0IiBuYW1lPSJhY3Rpb24iIHZhbHVlPSJEZW55Ii8+PC90ZD4NCiA8L3RyPg0KIDwvdGFibGU+DQo8L2Zvcm0+DQoNCjwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="newContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="content"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtjb250ZW50fQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHt4cGF0aFJlZGlyZWN0VVJJLnJlc3VsdH0/ZXJyb3I9dW5zdXBwb3J0ZWRfcmVzcG9uc2VfdHlwZQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.state}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtsb2NhdGlvbn0mc3RhdGU9JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnN0YXRlfQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="location"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="add state parameter if sent in request message"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="302"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Redirect"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="302"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:AddHeader&gt;
                    &lt;L7p:HeaderName stringValue="Location"/&gt;
                    &lt;L7p:HeaderValue stringValue="${location}"/&gt;
                    &lt;L7p:Target target="RESPONSE"/&gt;
                    &lt;/L7p:AddHeader&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Check response_type"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Initial call of the client"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PGRpdj4NCjxwPlRoZSBzZXNzaW9uIGhhcyBleHBpcmVkLiBHbyBiYWNrIHRvIHRoZSBjbGllbnQgYW5kIHN0YXJ0IGFsbCBvdmVyIGFnYWluPC9wPg0KPC9kaXY+"/&gt;
                    &lt;L7p:VariableToSet stringValue="newContent"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="errorContent"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;!--oauth_content_placeholder--&gt;"/&gt;
                    &lt;L7p:RegexName stringValue="update the content of the website"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${newContent}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${errorStatus}"/&gt;
                    &lt;L7p:Expression2 stringValue=""/&gt;
                    &lt;L7p:Negate booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:Negated booleanValue="true"/&gt;
                    &lt;L7p:Operator operator="EMPTY"/&gt;
                    &lt;L7p:RightValue stringValue=""/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="${errorStatus}"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Custom error status"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="200"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64ResponseBody stringValue="JHtlcnJvckNvbnRlbnR9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Unknown action"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797521" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797521" version="2">
            <l7:Name>SAML</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/client/saml*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>2</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="1">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a test client for an OAuth 2 implementation using the saml
                    grant type"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="e1431c63-9d2c-4ba1-b254-8eb69f543da7"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvbWFuYWdlcg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!samlfromsts"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_saml"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCBzYW1s"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_saml"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!saml"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIHZpYSBjYWNoZS4="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:CaseSensitive booleanValue="false"/&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.saml}"/&gt;
                    &lt;L7p:Operator operatorNull="null"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item dataType="included"&gt;
                    &lt;L7p:Type variableDataType="string"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item stringLength="included"&gt;
                    &lt;L7p:Max intValue="-1"/&gt;
                    &lt;L7p:Min intValue="1"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNhbWx9"/&gt;
                    &lt;L7p:ContentType stringValue="text/plain; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="samlmsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!samlfromsts"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="samlmsg"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNhbWx9"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_saml"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="callapi"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="callapi"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRhcmdldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="target_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="R0VU"/&gt;
                    &lt;L7p:VariableToSet stringValue="target_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="7768a8bc-8228-48a2-80f1-f44884937569"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${request.http.parameter.target}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${authorization_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Call API"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="handshake"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="handshake"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="aHR0cDovL29hdXRoLm5ldC9ncmFudF90eXBlL2Fzc2VydGlvbi9zYW1sLzIuMC9iZWFyZXI="/&gt;
                    &lt;L7p:VariableToSet stringValue="notencodedgranttype"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="notencodedgranttype"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="encodedgranttype"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:EncodeDecode&gt;
                    &lt;L7p:SourceVariableName stringValue="current_saml"/&gt;
                    &lt;L7p:TargetDataType variableDataType="string"/&gt;
                    &lt;L7p:TargetVariableName stringValue="encoded_saml"/&gt;
                    &lt;L7p:TransformType transformType="URL_ENCODE"/&gt;
                    &lt;/L7p:EncodeDecode&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT0ke2VuY29kZWRncmFudHR5cGV9JmFzc2VydGlvbj0ke2VuY29kZWRfc2FtbH0mc2NvcGU9JHtvYXV0aDJfc2NvcGV9"/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:Login stringValue="${oauth2_client_id}"/&gt;
                    &lt;L7p:Password stringValue="${oauth2_client_secret}"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="application/xml"/&gt;
                    &lt;L7p:Name stringValue="accept"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue
                    stringValue="3MVG94DzwlYDSHS6GTCNPxF87RQ8HrxbojWk89by7fE_H4ch8TsfZcaIFz.jdne83WCVPiD_xA93_Y8j4iomk"/&gt;
                    &lt;L7p:Name stringValue="client_id"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="https://ssg61.l7tech.com:8443/salesforce/oauth/callback"/&gt;
                    &lt;L7p:Name stringValue="redirect_uri"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="4922422941220601472"/&gt;
                    &lt;L7p:Name stringValue="client_secret"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="authorization_code"/&gt;
                    &lt;L7p:Name stringValue="grant_type"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${request.http.parameter.code}"/&gt;
                    &lt;L7p:Name stringValue="code"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!saml"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIHZpYSBoYW5kc2hha2Uu"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handshake"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQouaGlkZGVuIHsgZGlzcGxheTogbm9uZTsgfQ0KLnVuaGlkZGVuIHsgZGlzcGxheTogYmxvY2s7IH0NCg0KPC9zdHlsZT4NCjwvaGVhZD4NCjxib2R5Pg0KPCEtLSBMYXlvdXQgLS0+DQo8ZGl2IGlkPSJ3cmFwcGVyIj4NCiAgICAgPGRpdiBpZD0ibWVudWJrZyI+PC9kaXY+DQogICAgIDxkaXYgaWQ9ImNvbnRhaW5lciI+DQoJICA8ZGl2IGlkPSJoZWFkZXIiPg0KCQkJPGRpdiBpZD0ibG9nby1mbG9hdGVyIj48YSBocmVmPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fS9vYXV0aC92Mi9jbGllbnQvc2FtbCIgdGl0bGU9IiI+PGltZyBzcmM9IiR7b2F1dGgyX3NlcnZlcl9sb2dvfSIgYWx0PSIiIGlkPSJsb2dvIiAvPjwvYT48L2Rpdj4NCg0KICAJCTwvZGl2Pg0KPCEtLWNsb3NlIGhlYWRlci0tPg0KDQoNCgk8ZGl2IGlkPSJzaWRlYmFyLWxlZnQiIGNsYXNzPSJzaWRlYmFyIj4NCgkJICA8ZGl2IGlkPSJibG9jay1tZW51X2Jsb2NrLTEwIiBjbGFzcz0iY2xlYXItYmxvY2sgYmxvY2sgYmxvY2stbWVudV9ibG9jayI+DQoJCSAgPGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+PGJyIC8+DQoJCSAgICA8aDI+IDwvaDI+DQoJCSAgICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkgICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIHBhcmVudC1tbGlkLTIzNjMgbWVudS1sZXZlbC0xIj4NCiAgCQkJCQk8IS0tPHVsIGNsYXNzPSJtZW51Ij4NCiAgCQkJCQk8bGkgY2xhc3M9ImV4cGFuZGVkIGZpcnN0IG1lbnUtbWxpZC0yMzY0IG5vbGluay1saSI+PHNwYW4gY2xhc3M9Im5vbGluayI+UmVwb3J0cyBieSBBUEkgS2V5PC9zcGFuPi0tPg0KICAJCQkJCTx1bCBjbGFzcz0ibWVudSI+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iL29hdXRoL3YyL2NsaWVudC9hdXRoY29kZSIgdGl0bGU9IiI+QXV0aG9yaXphdGlvbiBDb2RlPC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iL29hdXRoL3YyL2NsaWVudC9pbXBsaWNpdCIgdGl0bGU9IiI+SW1wbGljaXQ8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2NsaWVudGNyZWRzIiB0aXRsZT0iIj5DbGllbnQgQ3JlZGVudGlhbHM8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L3JvcGMiIHRpdGxlPSIiPlJlc291cmNlIE93bmVyIFBhc3N3b3JkIENyZWRlbnRpYWxzPC9hPjwvbGk+DQoJCQkJCTxsaSBjbGFzcz0ibGVhZiBmaXJzdCBtZW51LW1saWQtOTA0NiI+PGEgaHJlZj0iL29hdXRoL3YyL2NsaWVudC9zYW1sIiB0aXRsZT0iIj5TQU1MPC9hPjwvbGk+DQoJCQkJCTxiciAvPg0KCQkJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+DQoJCQkJCTxsaT48YSBocmVmPSIke29hdXRoX21hbmFnZXJfc2VydmVyX3VybH0iIHRhcmdldD0iX2JsYW5rIHRpdGxlPSI+T0F1dGggTWFuYWdlcjwvYT48L2xpPg0KCQkJCTwvZGl2Pg0KCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkgIDwvZGl2Pg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${current_saml}"/&gt;
                    &lt;L7p:Expression2 stringValue="No current saml"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="No current saml"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3NhbWx9"/&gt;
                    &lt;L7p:ContentType stringValue="text/xml; charset=utf-8"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_saml_summary"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:XslTransformation&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Create summary of SAML assertion information"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Direction intValue="-1"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="current_saml_summary"/&gt;
                    &lt;L7p:ResourceInfo staticResourceInfo="included"&gt;
                    &lt;L7p:Document stringValueReference="inline"&gt;&lt;![CDATA[&lt;xsl:stylesheet version="1.0"
                    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;
                    &lt;xsl:output method="html"/&gt;

                    &lt;xsl:template match="/"&gt;
                    &lt;b&gt;SAML Assertion Summary&lt;/b&gt;&lt;br/&gt;
                    NameID: &lt;xsl:value-of select="//*[local-name()='NameID']"/&gt;&lt;br/&gt;
                    SubjectConfimation: &lt;xsl:value-of select="//*[local-name()='SubjectConfirmation']/@Method"/&gt;&lt;br/&gt;
                    NotBefore: &lt;xsl:value-of select="//*[local-name()='Conditions']/@NotBefore"/&gt;&lt;br/&gt;
                    NotOnOrAfter: &lt;xsl:value-of select="//*[local-name()='Conditions']/@NotOnOrAfter"/&gt;&lt;br/&gt;
                    AuthenticationContext: &lt;xsl:value-of select="//*[local-name()='AuthnContext']"/&gt;&lt;br/&gt;
                    &lt;/xsl:template&gt;
                    &lt;/xsl:stylesheet&gt;]]&gt;&lt;/L7p:Document&gt;
                    &lt;/L7p:ResourceInfo&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;L7p:TransformName stringValue=""/&gt;
                    &lt;/L7p:XslTransformation&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Escape &amp;amp;lt; character in SAML assertion for HTML display"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="current_saml"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;/"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="&amp;amp;lt;/"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:Regex&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Add line break and escape &amp;amp;lt; character in SAML assertion for
                    HTML display"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="current_saml"/&gt;
                    &lt;L7p:Regex stringValue="&amp;lt;"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="&amp;lt;br&gt;&amp;amp;lt;"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                    &lt;/L7p:Regex&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtjdXJyZW50X3NhbWxfc3VtbWFyeS5tYWlucGFydH0NCjxiciAvPg0KPGEgaHJlZj0iamF2YXNjcmlwdDp1bmhpZGUoJ3NhbWxfYXNzZXJ0aW9uJykiPlZpZXcgU0FNTCBBc3NlcnRpb248L2E+DQoJCQk8L3A+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+DQogZnVuY3Rpb24gdW5oaWRlKGRpdklEKSB7DQogdmFyIGl0ZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXZJRCk7DQogaWYgKGl0ZW0pIHsNCiBpdGVtLmNsYXNzTmFtZT0oaXRlbS5jbGFzc05hbWU9PSdoaWRkZW4nKT8ndW5oaWRkZW4nOidoaWRkZW4nOw0KIH0NCiB9DQogPC9zY3JpcHQ+DQoJCQk8cCBpZD0ic2FtbF9hc3NlcnRpb24iIGNsYXNzPSJoaWRkZW4iPg0KJHtjdXJyZW50X3NhbWx9"/&gt;
                    &lt;L7p:VariableToSet stringValue="current_saml"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="RIGHT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Build HTML template for SAML assertion display if exists"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHtodG1sVGVtcGxhdGVUb3B9Cgo8ZGl2IGlkPSJjb250ZW50Ij4KCTxJRlJBTUUgaWQ9bXlpZnJhbWUgc3JjPSIiIHN0eWxlPSdkaXNwbGF5Om5vbmUnIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9ImF1dG8iPgoJPC9JRlJBTUU+Cgk8ZGl2IGlkPSJjb250ZW50X2xhbmRpbmdfcGFnZSI+ICAgICAgICAgICAgICAKCQk8ZGl2IGNsYXNzPSJ2aWV3IHZpZXctcHJvZHVjdHMzIHZpZXctaWQtcHJvZHVjdHMzIHZpZXctZGlzcGxheS1pZC1wYWdlXzEgdmlldy1kb20taWQtMSI+CQkKCQkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJPGRpdiBjbGFzcz0idGl0bGUtYm94Ij4KCQkJPGgxPk9BdXRoVjJDbGllbnQ8L2gxPgoJCQk8YnIgLz4KCQkJPGgzPk9BdXRoIHZlcnNpb246IGRyYWZ0LWlldGYtb2F1dGgtdjItMjM8L2gzPgoJCQk8YnIgLz4KCQkJPGgzPkdyYW50IHR5cGU6IFNBTUwgKGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL2RyYWZ0LWlldGYtb2F1dGgtc2FtbDItYmVhcmVyLTA1KTwvaDM+CgkJCTxiciAvPgoJCQk8aDM+Q3VycmVudCBBY2Nlc3MgVG9rZW46PC9oMz4KCQkJPGJyIC8+CgkJCTxwPjxwcmU+CiR7Y3VycmVudF90b2tlbn0KCQkJPC9wcmU+CgkJCTwvcD4KCQkJPC9kaXY+CgkJCTwvZGl2PgoJCQkJPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPgoJCQk8L2Rpdj4KCgkJCTxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCQk8ZGl2IGNsYXNzPSJjb250YWluZXIiPgoJCQk8YnIgLz4KCQkJPGgzPkluaXRpYXRlIG5ldyBTQU1MIGhhbmRzaGFrZTwvaDM+CgkJCTxiciAvPgoKCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fS9vYXV0aC92Mi9zYW1sVG9rZW5TZXJ2ZXIiPgoJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0icmVkaXJlY3RfdXJpIgoJCQkJCQkJICB2YWx1ZT0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9Ii8+CgkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iSW5pdGlhdGUiLz4JCQkKCQkJPC9mb3JtPgoJCQk8YnIgLz4KCQkJPHA+CiR7Y3VycmVudF9zYW1sfQoKCQkJPC9wPgoKCQkJPGJyIC8+PGJyIC8+PGJyIC8+CgoJCQkKCQkJPGgzPkluaXRpYXRlIG5ldyBPQXV0aCBoYW5kc2hha2U8L2gzPgoJCQk8YnIgLz4KCgkJCTxmb3JtIGFjdGlvbj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0ke3JlcXVlc3QudXJsLnBhdGh9Ij4KCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjdGlvbiIKCQkJCQkJCSAgdmFsdWU9ImhhbmRzaGFrZSIvPgoJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkluaXRpYXRlIi8+CgkJCTwvZm9ybT4KCgkJCTxiciAvPjxiciAvPjxiciAvPgoKCQkJPGgzPkNhbGwgQVBJIFVzaW5nIEN1cnJlbnQgQWNjZXNzIFRva2VuPC9oMz4KCQkJPGJyIC8+CgoJCQk8Zm9ybSBhY3Rpb249IiR7cmVxdWVzdC51cmwucHJvdG9jb2x9Oi8vJHtyZXF1ZXN0LnVybC5ob3N0fToke3JlcXVlc3QudXJsLnBvcnR9JHtyZXF1ZXN0LnVybC5wYXRofSI+CgkJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJhY3Rpb24iCgkJCQkJCQkgIHZhbHVlPSJjYWxsYXBpIi8+CgkJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIKCQkJCQkJCSAgdmFsdWU9InN0YXRlX3Rlc3QiLz4KCQkJCVRhcmdldDogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InRhcmdldCIgc2l6ZT04MCB2YWx1ZT0iJHthcGljYWxsdGFyZ2V0fSIvPgoJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IkNhbGwgQVBJIi8+CgkJCTwvZm9ybT4KCQkJPGJyIC8+CgkJCTxwPjxwcmU+CiR7YXBpb3V0cHV0fQoJCQk8L3ByZT4KCQkJPC9wPgoJCQkKCQkJPC9kaXY+CgkJCQk8Y2FwdGlvbj48aDQ+PGI+PC9iPjwvaDQ+PGhyPjxwPjwvcD48L2NhcHRpb24+CgkJPC9kaXY+Cgk8L2Rpdj4KPC9kaXY+CiR7aHRtbFRlbXBsYXRlQm90dG9tfQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
    <l7:Service xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management" id="123797520" version="2">
        <l7:ServiceDetail folderId="123600909" id="123797520" version="2">
            <l7:Name>client credentials</l7:Name>
            <l7:Enabled>true</l7:Enabled>
            <l7:ServiceMappings>
                <l7:HttpMapping>
                    <l7:UrlPattern>/oauth/v2/client/clientcreds*</l7:UrlPattern>
                    <l7:Verbs>
                        <l7:Verb>GET</l7:Verb>
                        <l7:Verb>POST</l7:Verb>
                        <l7:Verb>PUT</l7:Verb>
                        <l7:Verb>DELETE</l7:Verb>
                    </l7:Verbs>
                </l7:HttpMapping>
            </l7:ServiceMappings>
            <l7:Properties>
                <l7:Property key="policyRevision">
                    <l7:LongValue>3</l7:LongValue>
                </l7:Property>
                <l7:Property key="wssProcessingEnabled">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="soap">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
                <l7:Property key="internal">
                    <l7:BooleanValue>false</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:ServiceDetail>
        <l7:Resources>
            <l7:ResourceSet tag="policy">
                <l7:Resource type="policy" version="2">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
                    &lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy"
                    xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CommentAssertion&gt;
                    &lt;L7p:Comment stringValue="This is a test client for an OAuth 2 implementation using the client
                    credentials grant type"/&gt;
                    &lt;/L7p:CommentAssertion&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="950d7c13-dcd8-472f-a7ae-2f4d50b8bfdd"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="e1431c63-9d2c-4ba1-b254-8eb69f543da7"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=""/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvbWFuYWdlcg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="oauth_manager_server_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:CacheLookup&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!clientcreds"/&gt;
                    &lt;L7p:ContentTypeOverride stringValue=""/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;/L7p:CacheLookup&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkIHZpYSBjYWNoZS4="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="Tm8gY3VycmVudCB0b2tlbg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvcHJvdGVjdGVkYXBpL3Jlc291cmNlZm9v"/&gt;
                    &lt;L7p:VariableToSet stringValue="apicalltarget"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="callapi"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="callapi"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtjdXJyZW50X3Rva2VufQ=="/&gt;
                    &lt;L7p:VariableToSet stringValue="token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRhcmdldH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="target_url"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="R0VU"/&gt;
                    &lt;L7p:VariableToSet stringValue="target_http_method"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:Include&gt;
                    &lt;L7p:PolicyGuid stringValue="7768a8bc-8228-48a2-80f1-f44884937569"/&gt;
                    &lt;/L7p:Include&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="GET"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${request.http.parameter.target}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="${authorization_header}"/&gt;
                    &lt;L7p:Name stringValue="authorization"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="JHtyZXNwb25zZS5tYWlucGFydH0="/&gt;
                    &lt;L7p:VariableToSet stringValue="apioutput"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Call API"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;wsp:All wsp:Usage="Required"&gt;
                    &lt;L7p:ComparisonAssertion&gt;
                    &lt;L7p:Expression1 stringValue="${request.http.parameter.action}"/&gt;
                    &lt;L7p:Expression2 stringValue="handshake"/&gt;
                    &lt;L7p:Predicates predicates="included"&gt;
                    &lt;L7p:item binary="included"&gt;
                    &lt;L7p:RightValue stringValue="handshake"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Predicates&gt;
                    &lt;/L7p:ComparisonAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="Z3JhbnRfdHlwZT1jbGllbnRfY3JlZGVudGlhbHMmc2NvcGU9JHtvYXV0aDJfc2NvcGV9"/&gt;
                    &lt;L7p:ContentType stringValue="application/x-www-form-urlencoded"/&gt;
                    &lt;L7p:DataType variableDataType="message"/&gt;
                    &lt;L7p:VariableToSet stringValue="postMsg"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:CurrentSecurityHeaderHandling intValue="3"/&gt;
                    &lt;L7p:FailOnErrorStatus booleanValue="false"/&gt;
                    &lt;L7p:HttpMethod httpMethod="POST"/&gt;
                    &lt;L7p:Login stringValue="${oauth2_client_id}"/&gt;
                    &lt;L7p:Password stringValue="${oauth2_client_secret}"/&gt;
                    &lt;L7p:ProtectedServiceUrl stringValue="${oauth2_auth_server}${oauth2_token_path}"/&gt;
                    &lt;L7p:ProxyPassword stringValueNull="null"/&gt;
                    &lt;L7p:ProxyUsername stringValueNull="null"/&gt;
                    &lt;L7p:RequestHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:CustomizeValue stringValue="application/xml"/&gt;
                    &lt;L7p:Name stringValue="accept"/&gt;
                    &lt;L7p:UsesCustomizedValue booleanValue="true"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:RequestHeaderRules&gt;
                    &lt;L7p:RequestMsgSrc stringValue="postMsg"/&gt;
                    &lt;L7p:RequestParamRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:ForwardAll booleanValue="true"/&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"/&gt;
                    &lt;/L7p:RequestParamRules&gt;
                    &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet="included"&gt;
                    &lt;L7p:Rules httpPassthroughRules="included"&gt;
                    &lt;L7p:item httpPassthroughRule="included"&gt;
                    &lt;L7p:Name stringValue="Set-Cookie"/&gt;
                    &lt;/L7p:item&gt;
                    &lt;/L7p:Rules&gt;
                    &lt;/L7p:ResponseHeaderRules&gt;
                    &lt;L7p:SamlAssertionVersion intValue="2"/&gt;
                    &lt;/L7p:HttpRoutingAssertion&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="JHtyZXNwb25zZS5tYWlucGFydH0NCg0KVGhlIGFjY2VzcyB0b2tlbiB3YXMgcmV0cmlldmVkLg=="/&gt;
                    &lt;L7p:VariableToSet stringValue="current_token"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:CacheStorage&gt;
                    &lt;L7p:CacheEntryKey stringValue="${request.tcp.remoteIP}!${oauth2_client_id}!clientcreds"/&gt;
                    &lt;L7p:MaxEntryAgeMillis longValue="360000000"/&gt;
                    &lt;L7p:MaxEntrySizeBytes longValue="100000"/&gt;
                    &lt;/L7p:CacheStorage&gt;
                    &lt;L7p:assertionComment&gt;
                    &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                    &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                    &lt;L7p:value stringValue="Handshake"/&gt;
                    &lt;/L7p:entry&gt;
                    &lt;/L7p:Properties&gt;
                    &lt;/L7p:assertionComment&gt;
                    &lt;/wsp:All&gt;
                    &lt;L7p:TrueAssertion/&gt;
                    &lt;/wsp:OneOrMore&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression
                    stringValue="PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHhtbDpsYW5nPSJlbiIgbGFuZz0iZW4iIGRpcj0ibHRyIj4NCjxoZWFkPg0KPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgiIC8+DQo8dGl0bGU+T0F1dGhWMkNsaWVudDwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KYm9keS5kcmFne2N1cnNvcjptb3ZlO310aC5hY3RpdmUgaW1ne2Rpc3BsYXk6aW5saW5lO310ci5ldmVuLHRyLm9kZHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2NjYztwYWRkaW5nOjAuMWVtIDAuNmVtO30NCnRyLmRyYWd7YmFja2dyb3VuZC1jb2xvcjojZmZmZmYwO310ci5kcmFnLXByZXZpb3Vze2JhY2tncm91bmQtY29sb3I6I2ZmZDt9DQp0ZC5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZGRkO310ZC5jaGVja2JveCx0aC5jaGVja2JveHt0ZXh0LWFsaWduOmNlbnRlcjt9DQp0Ym9keXtib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjO310Ym9keSB0aHtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjO30NCnRoZWFkIHRoe3RleHQtYWxpZ246bGVmdDsNCiAgcGFkZGluZy1yaWdodDoxZW07DQogIGJvcmRlci1ib3R0b206M3B4IHNvbGlkICNjY2M7fQ0KLmJyZWFkY3J1bWJ7cGFkZGluZy1ib3R0b206LjVlbX1kaXYuaW5kZW50YXRpb257d2lkdGg6MjBweDtoZWlnaHQ6MS43ZW07bWFyZ2luOi0wLjRlbSAwLjJlbSAtMC40ZW0gLTAuNGVtOw0KICBwYWRkaW5nOjAuNDJlbSAwIDAuNDJlbSAwLjZlbTsNCiAgZmxvYXQ6bGVmdDt9DQp1bC5wcmltYXJ5e2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZTtwYWRkaW5nOjAgMCAwIDFlbTsNCiAgd2hpdGUtc3BhY2U6bm93cmFwO2xpc3Qtc3R5bGU6bm9uZTttYXJnaW46NXB4O2hlaWdodDphdXRvO2xpbmUtaGVpZ2h0Om5vcm1hbDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjYmJiO30NCnVsLnByaW1hcnkgbGl7ZGlzcGxheTppbmxpbmU7fXVsLnByaW1hcnkgbGkgYXtiYWNrZ3JvdW5kLWNvbG9yOiNkZGQ7Ym9yZGVyLWNvbG9yOiNiYmI7Ym9yZGVyLXdpZHRoOjFweDtib3JkZXItc3R5bGU6c29saWQgc29saWQgbm9uZSBzb2xpZDtoZWlnaHQ6YXV0bzttYXJnaW4tcmlnaHQ6MC41ZW07DQogIHBhZGRpbmc6MCAxZW07dGV4dC1kZWNvcmF0aW9uOm5vbmU7fXVsLnByaW1hcnkgbGkuYWN0aXZlIGF7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgI2JiYjtib3JkZXItYm90dG9tOiNmZmYgMXB4IHNvbGlkO30NCnVsLnByaW1hcnkgbGkgYTpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7Ym9yZGVyLWNvbG9yOiNjY2M7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZWVlO311bC5zZWNvbmRhcnl7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2JiYjtwYWRkaW5nOjAuNWVtIDFlbTttYXJnaW46NXB4O30NCg0KKnttYXJnaW46MDt9DQpodG1sLGJvZHl7YmFja2dyb3VuZDojZmZmO2ZvbnQ6MTJweC8xLjJlbSBoZWx2ZXRpY2EsYXJpYWwsc2Fucy1zZXJpZjtjb2xvcjojNGI0YjRiO2hlaWdodDoxMDAlO2xpbmUtaGVpZ2h0OjEuM2VtO30NCmhye2hlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZGRkOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtwYWRkaW5nOjhweCBhdXRvO2JvcmRlcjowIG5vbmU7fQ0KaW5wdXR7Y29sb3I6IzRiNGI0Yjt9DQpoMSxoMixoMyxoNCxoNSxoNntwYWRkaW5nOjA7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtZmFtaWx5OmhlbHZldGljYSxhcmlhbCxzYW5zLXNlcmlmO30NCmgxe2ZvbnQtc2l6ZToyNTAlO2NvbG9yOndoaXRlO3otaW5kZXg6NTt9DQpoMntmb250LXNpemU6MTc1JTt9DQpoM3tmb250LXNpemU6MTUwJTt9DQpoNHtmb250LXNpemU6MTIwJTt9DQpoNXtmb250LXNpemU6MTEwJTt9DQpoNntmb250LXNpemU6MTA1JTt9DQphOmFjdGl2ZSxhLmFjdGl2ZXtjb2xvcjojNGI0YjRiO3RleHQtZGVjb3JhdGlvbjpub25lO30NCmE6bGluayxhOnZpc2l0ZWR7Y29sb3I6IzRiNGI0Yjt0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lO291dGxpbmU6bm9uZTt9DQphOmhvdmVye2NvbG9yOiNkYjNiMmM7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwe21hcmdpbi1ib3R0b206LjVlbTtsaW5lLWhlaWdodDoxLjNlbTtsaXN0LXN0eWxlOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjEuNWVtO2NvbG9yOiM0YjRiNGI7fQ0KYmxvY2txdW90ZSAqe21hcmdpbjo1cHggMCAwIDEwcHg7fXVse2xpbmUtaGVpZ2h0OjEuNWVtOw0KcGFkZGluZzouMmVtIDFlbSAxZW0gMWVtO31vbHtsaW5lLWhlaWdodDoxLjVlbTtwYWRkaW5nOi4yZW0gMWVtIDFlbSAxZW07fXRyLmV2ZW4sdHIub2Rke2JhY2tncm91bmQ6bm9uZTt9aW1nLGEgaW1ne2JvcmRlcjpub25lO30NCm5vLXJlcGVhdCBsZWZ0IDM1JTttYXJnaW4tbGVmdDouNWVtO3BhZGRpbmctbGVmdDoxZW07fQ0KI3dyYXBwZXJ7bWluLWhlaWdodDoxMDAlO2hlaWdodDphdXRvICFpbXBvcnRhbnQ7aGVpZ2h0OjEwMCU7bWFyZ2luOjAgYXV0byAtNWVtO30jY29udGFpbmVye21hcmdpbjotMi41ZW0gYXV0byAwIDIuNWVtO30NCi5maWVsZC1jb250ZW50IC52aWV3LWRvbS1pZC01IC52aWV3LWNvbnRlbnQgLnZpZXdzLXJvd3sNCiAgICBtYXJnaW46MHB4O3BhZGRpbmc6MHB4O30NCg0KI3NpZGViYXItbGVmdHtmbG9hdDpsZWZ0O2NsZWFyOmxlZnQ7cGFkZGluZzoyZW0gMCA2ZW0gMDt6LWluZGV4OjUwMDt3aWR0aDoxNWVtO30NCiNzaWRlYmFyLWxlZnQgLmNvbnRlbnR7bWFyZ2luLXRvcDouOGVtO30NCiNzaWRlYmFyLWxlZnQgYXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMmVtO3BhZGRpbmc6M3B4IDAgMXB4IDNweDt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTA1JTttYXJnaW4tbGVmdDozcHg7bWFyZ2luLXJpZ2h0OjNweDt9DQojc2lkZWJhci1sZWZ0IHVse3dpZHRoOjEzLjVlbTtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGU6bm9uZTt9DQojc2lkZWJhci1sZWZ0IHVsIHVse25vLXJlcGVhdCBjZW50ZXIgdG9wO3BhZGRpbmctbGVmdDouMmVtO30NCiNzaWRlYmFyLWxlZnQgYTpob3ZlciwNCiNzaWRlYmFyLWxlZnQgYS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZDgzYjJjO2NvbG9yOndoaXRlO30NCiNzaWRlYmFyLWxlZnQgLm5vbGluay1saXtwYWRkaW5nLXRvcDoxLjNlbTt9DQojc2lkZWJhci1sZWZ0IC5maXJzdC5ub2xpbmstbGl7cGFkZGluZy10b3A6MDt9DQojc2lkZWJhci1sZWZ0IC5ub2xpbmt7Y29sb3I6IzIzMjAyMTtmb250LXNpemU6MTIwJTtmb250LXdlaWdodDo2MDA7fQ0KI3NpZGViYXItbGVmdCAubWVudS1uYW1lLW1lbnUtcmVzb3VyY2VzIC5ub2xpbmt7Zm9udC13ZWlnaHQ6MTAwO2ZvbnQtc2l6ZToxMDUlO30NCiNzaWRlYmFyLWxlZnQgbGkubGVhZntib3JkZXI6bm9uZTt0ZXh0LWluZGVudDpub25lOyBuby1yZXBlYXQgY2VudGVyIGJvdHRvbTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MXB4IDAgMnB4O30NCiNzaWRlYmFyLWxlZnQgdWwgdWwgbGkuZmlyc3R7cGFkZGluZy10b3A6MnB4O30NCg0KLnZpZXctY29udGVudCBoNHtmb250LXNpemU6MTAwJTt9I25hdmlnYXRpb257cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweCBzb2xpZCByZWQ7bWFyZ2luOjBweDtwYWRkaW5nOjBweDt9DQoNCi5icmVhZGNydW1ie3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQuN2VtO2xlZnQ6MTUuOGVtO3otaW5kZXg6NTA7fS5icmVhZGNydW1iIGEuYWN0aXZlLC5icmVhZGNydW1iIGE6YWN0aXZle2NvbG9yOiMyMzIwMjE7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fS5icmVhZGNydW1iIGE6aG92ZXJ7Y29sb3I6I2RiM2IyYzt9bGkubGVhZntkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMC41ZW0gMCAwLjNlbTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjNzI3MjcyO30NCg0KI2hlYWRlcntoZWlnaHQ6Ni41ZW07bWF4LXdpZHRoOjEwMCU7cG9zaXRpb246cmVsYXRpdmU7fSNoZWFkZXIgI2xvZ28tZmxvYXRlcntmbG9hdDpsZWZ0O3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDoxMCU7d2lkdGg6MTU5cHg7aGVpZ2h0OjUzcHg7bWFyZ2luLWxlZnQ6Mi41ZW07fWRpdiNyZXN7ZGlzcGxheTpub25lO3Zpc2liaWxpdHk6aGlkZGVuO30jbWVudWJrZ3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDozMXB4O2JhY2tncm91bmQtY29sb3I6I2ZmMDAwMDt0b3A6Ni42ZW07ei1pbmRleDowO30NCg0KZGl2Lmxpbmtze2Rpc3BsYXk6bm9uZTt9DQoNCiNjb250ZW50e21hcmdpbi1sZWZ0OjE1ZW07cGFkZGluZy10b3A6NC4zZW07cGFkZGluZy1ib3R0b206MWVtO30NCi5zdWJtaXR0ZWR7ZGlzcGxheTpub25lO30uY29udGFpbmVye3otaW5kZXg6NTtoZWlnaHQ6MTAwJTtwYWRkaW5nLXRvcDouMmVtO30NCi50aXRsZS1ib3ggaDF7Y29sb3I6I2RiM2IyYztsaW5lLWhlaWdodDoxZW07fQ0KDQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWx7Ym9yZGVyOjA7bGlzdC1zdHlsZTpub25lO2hlaWdodDozMXB4O21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyB1bCBsaXtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjowO2Zsb2F0OmxlZnQ7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgdWwgbGkgYXtkaXNwbGF5OmJsb2NrO2hlaWdodDozMXB4O3RleHQtaW5kZW50Oi01MDAwcHg7fQ0KI25hdmlnYXRpb24gZGl2Lm1lbnUtbmFtZS1wcmltYXJ5LWxpbmtzIGxpIGF7YmFja2dyb3VuZC1jb2xvcjojY2NjO30NCiNuYXZpZ2F0aW9uIGRpdi5tZW51LW5hbWUtcHJpbWFyeS1saW5rcyBsaSBhOmhvdmVye2JhY2tncm91bmQtY29sb3I6I2NjYzt9DQojbmF2aWdhdGlvbiBkaXYubWVudS1uYW1lLXByaW1hcnktbGlua3MgbGkubWVudS1tbGlkLTIzOTMgPiBhOmhvdmVye30NCg0KI2JvdHRvbWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjJlbSAwIDZlbSAwO3otaW5kZXg6NTAwO3dpZHRoOjEzLjVlbTtmb250LXNpemU6MTMwJTt9DQojYm90dG9tYmFyIC5jb250ZW50e21hcmdpbi10b3A6LjhlbTt9DQojYm90dG9tYmFyIGF7bGluZS1oZWlnaHQ6MS4yZW07cGFkZGluZzozcHggM3B4IDNweCAzcHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7fQ0KI2JvdHRvbWJhciBhOmhvdmVyLA0KI2JvdHRvbWJhciBhLmFjdGl2ZXtjb2xvcjojZDgzYjJjO30NCiNib3R0b21iYXIgYntmb250LXNpemU6MTMzJTt9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjwhLS0gTGF5b3V0IC0tPg0KPGRpdiBpZD0id3JhcHBlciI+DQogICAgIDxkaXYgaWQ9Im1lbnVia2ciPjwvZGl2Pg0KICAgICA8ZGl2IGlkPSJjb250YWluZXIiPg0KCSAgPGRpdiBpZD0iaGVhZGVyIj4NCgkJCTxkaXYgaWQ9ImxvZ28tZmxvYXRlciI+PGEgaHJlZj0iJHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3JlcXVlc3QudXJsLmhvc3R9OiR7cmVxdWVzdC51cmwucG9ydH0vb2F1dGgvdjIvY2xpZW50L2NsaWVudGNyZWRzIiB0aXRsZT0iIj48aW1nIHNyYz0iJHtvYXV0aDJfc2VydmVyX2xvZ299IiBhbHQ9IiIgaWQ9ImxvZ28iIC8+PC9hPjwvZGl2Pg0KDQogIAkJPC9kaXY+DQo8IS0tY2xvc2UgaGVhZGVyLS0+DQoNCg0KCTxkaXYgaWQ9InNpZGViYXItbGVmdCIgY2xhc3M9InNpZGViYXIiPg0KCQkgIDxkaXYgaWQ9ImJsb2NrLW1lbnVfYmxvY2stMTAiIGNsYXNzPSJjbGVhci1ibG9jayBibG9jayBibG9jay1tZW51X2Jsb2NrIj4NCgkJICA8YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz48YnIgLz4NCgkJICAgIDxoMj4gPC9oMj4NCgkJICAgICAgPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCSAgICAgICAgPGRpdiBjbGFzcz0ibWVudS1uYW1lLXByaW1hcnktbGlua3MgcGFyZW50LW1saWQtMjM2MyBtZW51LWxldmVsLTEiPg0KICAJCQkJCTwhLS08dWwgY2xhc3M9Im1lbnUiPg0KICAJCQkJCTxsaSBjbGFzcz0iZXhwYW5kZWQgZmlyc3QgbWVudS1tbGlkLTIzNjQgbm9saW5rLWxpIj48c3BhbiBjbGFzcz0ibm9saW5rIj5SZXBvcnRzIGJ5IEFQSSBLZXk8L3NwYW4+LS0+DQogIAkJCQkJPHVsIGNsYXNzPSJtZW51Ij4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2F1dGhjb2RlIiB0aXRsZT0iIj5BdXRob3JpemF0aW9uIENvZGU8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L2ltcGxpY2l0IiB0aXRsZT0iIj5JbXBsaWNpdDwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvY2xpZW50Y3JlZHMiIHRpdGxlPSIiPkNsaWVudCBDcmVkZW50aWFsczwvYT48L2xpPg0KCQkJCQk8bGkgY2xhc3M9ImxlYWYgZmlyc3QgbWVudS1tbGlkLTkwNDYiPjxhIGhyZWY9Ii9vYXV0aC92Mi9jbGllbnQvcm9wYyIgdGl0bGU9IiI+UmVzb3VyY2UgT3duZXIgUGFzc3dvcmQgQ3JlZGVudGlhbHM8L2E+PC9saT4NCgkJCQkJPGxpIGNsYXNzPSJsZWFmIGZpcnN0IG1lbnUtbWxpZC05MDQ2Ij48YSBocmVmPSIvb2F1dGgvdjIvY2xpZW50L3NhbWwiIHRpdGxlPSIiPlNBTUw8L2E+PC9saT4NCgkJCQkJPGJyIC8+DQoJCQkJCTxjYXB0aW9uPjxoND48Yj48L2I+PC9oND48aHI+PHA+PC9wPjwvY2FwdGlvbj4NCgkJCQkJPGxpPjxhIGhyZWY9IiR7b2F1dGhfbWFuYWdlcl9zZXJ2ZXJfdXJsfSIgdGFyZ2V0PSJfYmxhbmsgdGl0bGU9Ij5PQXV0aCBNYW5hZ2VyPC9hPjwvbGk+DQoJCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCSAgPC9kaXY+"/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateTop"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue="PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4="/&gt;
                    &lt;L7p:VariableToSet stringValue="htmlTemplateBottom"/&gt;
                    &lt;/L7p:SetVariable&gt;
                    &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody
                    stringValue="JHtodG1sVGVtcGxhdGVUb3B9CjxkaXYgaWQ9ImNvbnRlbnQiPgoJCTxJRlJBTUUgaWQ9bXlpZnJhbWUgc3JjPSIiIHN0eWxlPSdkaXNwbGF5Om5vbmUnIGZyYW1lYm9yZGVyPSIwIiBzY3JvbGxpbmc9ImF1dG8iPgoJCTwvSUZSQU1FPgogICAgICAgICAgICAgICAgPGRpdiBpZD0iY29udGVudF9sYW5kaW5nX3BhZ2UiPiAgICAgICAgICAgICAgCgkJCTxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCQkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJCTxkaXYgY2xhc3M9InRpdGxlLWJveCI+CgkJCQk8aDE+T0F1dGhWMkNsaWVudDwvaDE+CgkJCQk8YnIgLz4KCQkJCTxoMz5PQXV0aCB2ZXJzaW9uOiBkcmFmdC1pZXRmLW9hdXRoLXYyLTIzPC9oMz4KCQkJCTxiciAvPgoJCQkJPGgzPkdyYW50IHR5cGU6IENsaWVudCBjcmVkZW50aWFsczwvaDM+CgkJCQk8YnIgLz4KCQkJCTxoMz5DdXJyZW50IEFjY2VzcyBUb2tlbjo8L2gzPgoJCQkJPGJyIC8+CgkJCQk8cD48cHJlPgoke2N1cnJlbnRfdG9rZW59CgkJCQk8L3ByZT4KCQkJCTwvcD4KCQkJCTwvZGl2PgoJCQkJPC9kaXY+CgkJCSAgICAgICAgPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPgoJCSAgICAJPC9kaXY+CgogICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InZpZXcgdmlldy1wcm9kdWN0czMgdmlldy1pZC1wcm9kdWN0czMgdmlldy1kaXNwbGF5LWlkLXBhZ2VfMSB2aWV3LWRvbS1pZC0xIj4JCQoJCQkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJCTxiciAvPgoKCQkJCQoJCQkJPGgzPkluaXRpYXRlIG5ldyBPQXV0aCBoYW5kc2hha2U8L2gzPgoJCQkJPGJyIC8+CgoJCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgogICAJCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjdGlvbiIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9ImhhbmRzaGFrZSIvPgoJCQkJCTxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJJbml0aWF0ZSIvPgoJCQkJPC9mb3JtPgoKCQkJCTxiciAvPjxiciAvPjxiciAvPgoJCQkJCgkJCQk8aDM+Q2FsbCBBUEkgVXNpbmcgQ3VycmVudCBBY2Nlc3MgVG9rZW48L2gzPgoJCQkJPGJyIC8+CgoJCQkJPGZvcm0gYWN0aW9uPSIke3JlcXVlc3QudXJsLnByb3RvY29sfTovLyR7cmVxdWVzdC51cmwuaG9zdH06JHtyZXF1ZXN0LnVybC5wb3J0fSR7cmVxdWVzdC51cmwucGF0aH0iPgogICAJCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9ImFjdGlvbiIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9ImNhbGxhcGkiLz4KCQkJCQk8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSJzdGF0ZSIKICAgICAgICAgICAgICAgICAgICAJCQkJdmFsdWU9InN0YXRlX3Rlc3QiLz4KCQkJCQlUYXJnZXQ6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ0YXJnZXQiIHNpemU9ODAgdmFsdWU9IiR7YXBpY2FsbHRhcmdldH0iLz4KCQkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2FsbCBBUEkiLz4KCQkJCTwvZm9ybT4KCQkJCTxiciAvPgoJCQkJPHA+PHByZT4KJHthcGlvdXRwdXR9CgkJCQk8L3ByZT4KCQkJCTwvcD4KCQkJCQoJCQkJPC9kaXY+CgkJCSAgICAgICAgPGNhcHRpb24+PGg0PjxiPjwvYj48L2g0Pjxocj48cD48L3A+PC9jYXB0aW9uPgoJICAgIAk8L2Rpdj4KCgoJCTwvZGl2Pgo8L2Rpdj4KCiR7aHRtbFRlbXBsYXRlQm90dG9tfQ=="/&gt;
                    &lt;L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/&gt;
                    &lt;/L7p:HardcodedResponse&gt;
                    &lt;/wsp:All&gt;
                    &lt;/wsp:Policy&gt;
                </l7:Resource>
            </l7:ResourceSet>
        </l7:Resources>
    </l7:Service>
</enumeration>
