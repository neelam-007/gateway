<?xml version="1.0" encoding="UTF-8"?>
<exp:Export Version="3.0"
    xmlns:L7p="http://www.layer7tech.com/ws/policy"
    xmlns:exp="http://www.layer7tech.com/ws/policy/export" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <exp:References>
        <IDProviderReference RefType="com.l7tech.console.policy.exporter.IdProviderReference">
            <OID>-2</OID>
            <Name>Internal Identity Provider</Name>
            <Props>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGphdmEgdmVyc2lvbj0iMS43&#xd;
LjBfMDIiIGNsYXNzPSJqYXZhLmJlYW5zLlhNTERlY29kZXIiPgogPG9iamVjdCBjbGFzcz0iamF2&#xd;
YS51dGlsLkhhc2hNYXAiPgogIDx2b2lkIG1ldGhvZD0icHV0Ij4KICAgPHN0cmluZz5hZG1pbkVu&#xd;
YWJsZWQ8L3N0cmluZz4KICAgPGJvb2xlYW4+dHJ1ZTwvYm9vbGVhbj4KICA8L3ZvaWQ+CiA8L29i&#xd;
amVjdD4KPC9qYXZhPgo=</Props>
            <TypeVal>1</TypeVal>
        </IDProviderReference>
    </exp:References>
    <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
        <wsp:All wsp:Usage="Required">
            <L7p:CustomizeErrorResponse>
                <L7p:ExtraHeaders nameValuePairArray="included"/>
            </L7p:CustomizeErrorResponse>
            <wsp:All wsp:Usage="Required">
                <wsp:OneOrMore wsp:Usage="Required">
                    <L7p:SslAssertion/>
                    <wsp:All wsp:Usage="Required">
                        <L7p:CustomizeErrorResponse>
                            <L7p:Content stringValue="HTTP protocol is not supported. Use HTTPS instead"/>
                            <L7p:ExtraHeaders nameValuePairArray="included"/>
                        </L7p:CustomizeErrorResponse>
                        <L7p:FalseAssertion/>
                    </wsp:All>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="checkSSL()"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:OneOrMore>
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAudXJpfQ=="/>
                        <L7p:VariableToSet stringValue="sourceUri"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue=""/>
                        <L7p:VariableToSet stringValue="newSourceUri"/>
                    </L7p:SetVariable>
                    <L7p:Split>
                        <L7p:InputVariable stringValue="sourceUri"/>
                        <L7p:OutputVariable stringValue="splitUri"/>
                        <L7p:SplitPattern stringValue="/"/>
                    </L7p:Split>
                    <L7p:ForEachLoop L7p:Usage="Required"
                        loopVariable="splitUri" variablePrefix="uri">
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${splitUri[1]}"/>
                                    <L7p:Expression2 stringValue="${uri.current}"/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:RightValue stringValue="${uri.current}"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${uri.current}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtuZXdTb3VyY2VVcml9LyR7dXJpLmN1cnJlbnR9"/>
                                    <L7p:VariableToSet stringValue="newSourceUri"/>
                                </L7p:SetVariable>
                            </wsp:All>
                            <L7p:TrueAssertion/>
                        </wsp:OneOrMore>
                    </L7p:ForEachLoop>
                    <L7p:Split>
                        <L7p:InputVariable stringValue="newSourceUri"/>
                        <L7p:OutputVariable stringValue="splitUri"/>
                        <L7p:SplitPattern stringValue="/"/>
                    </L7p:Split>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${splitUri[2]}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="authenticate"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${request.http.method}"/>
                                <L7p:Expression2 stringValue="POST"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="POST"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="ZmFsc2U="/>
                                <L7p:VariableToSet stringValue="failed"/>
                            </L7p:SetVariable>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${request.http.parameter.provider}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.username}"/>
                                    <L7p:Expression2 stringValue=""/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>

                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:Negated booleanValue="true"/>

                                    <L7p:Operator operator="EMPTY"/>

                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnVzZXJuYW1lfQ=="/>

                                    <L7p:VariableToSet stringValue="username"/>
                                    </L7p:SetVariable>
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${request.http.parameter.password}"/>
                                    <L7p:Expression2 stringValue=""/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>

                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:Negated booleanValue="true"/>

                                    <L7p:Operator operator="EMPTY"/>

                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnBhc3N3b3JkfQ=="/>

                                    <L7p:VariableToSet stringValue="password"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="PENyZWRlbnRpYWxzPg0KPFVzZXJuYW1lPiR7dXNlcm5hbWV9PC9Vc2VybmFtZT4NCjxQYXNzd29yZD4ke3Bhc3N3b3JkfTwvUGFzc3dvcmQ+DQo8L0NyZWRlbnRpYWxzPg=="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>

                                    <L7p:VariableToSet stringValue="request"/>
                                    </L7p:SetVariable>
                                    <L7p:XpathCredentialSource>

                                    <L7p:PasswordExpression xpathExpressionValue="included">

                                    <L7p:Expression stringValue="//Password"/>

                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>

                                    <L7p:key stringValue="s"/>

                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    </L7p:PasswordExpression>

                                    <L7p:RemoveLoginElement booleanValue="true"/>

                                    <L7p:RemovePasswordElement booleanValue="true"/>

                                    <L7p:XpathExpression xpathExpressionValue="included">

                                    <L7p:Expression stringValue="//Username"/>

                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>

                                    <L7p:key stringValue="s"/>

                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    </L7p:XpathExpression>
                                    </L7p:XpathCredentialSource>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="request=${request.username}/${request.password}"/>
                                    <L7p:Level stringValue="WARNING"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>

                                    <L7p:value stringValue="client sent username/password credentials"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>

                                    <L7p:value stringValue="getUserPasswordCreds()"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.token}"/>
                                    <L7p:Expression2 stringValue=""/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:Negated booleanValue="true"/>

                                    <L7p:Operator operator="EMPTY"/>

                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="VG9rZW4gYmFzZWQgYXV0aGVudGljYXRpb24gaXMgbm90IGltcGxlbWVudGVk"/>

                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:FalseAssertion/>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>

                                    <L7p:value stringValue="client sent user token"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>

                                    <L7p:value stringValue="processUserToken()"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="User credentials can be either login/password or security token"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="User Credentials"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Authentication>

                                    <L7p:IdentityProviderOid longValue="-2"/>
                                    </L7p:Authentication>
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${failed}"/>
                                    <L7p:Expression2 stringValue="false"/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:RightValue stringValue="false"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:IdentityAttributes>

                                    <L7p:IdentityProviderOid longValue="-2"/>

                                    <L7p:LookupAttributes identityMappingArray="included">
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="Unique ID"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="BOTH"/>

                                    <L7p:VariableName stringValue="id"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="dn"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="First Name"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="firstName"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="firstName"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="Last Name"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="lastName"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="lastName"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="E-mail Address"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="email"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="email"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="User Login"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="login"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="login"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="Department"/>

                                    <L7p:Type variableDataType="string"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="department"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="department"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    <L7p:item internalAttributeMapping="included">

                                    <L7p:AttributeConfig attributeConfig="included">

                                    <L7p:Header header="included">

                                    <L7p:Name stringValue="Expiration Date"/>

                                    <L7p:Type variableDataType="dateTime"/>

                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>

                                    <L7p:VariableName stringValue="expiration"/>
                                    </L7p:Header>

                                    <L7p:VariableName stringValue="expiration"/>
                                    </L7p:AttributeConfig>

                                    <L7p:ProviderOid longValue="-2"/>
                                    </L7p:item>
                                    </L7p:LookupAttributes>
                                    </L7p:IdentityAttributes>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxMN2dpbXM6c2VydmljZSB4bWxuczpMN2dpbXM9Imh0dHA6Ly93d3cubGF5ZXI3dGVjaC5jb20vMjAxMi8xMi9naW1zIiA+DQogICA8TDdnaW1zOnVzZXI+DQogICAgICA8TDdnaW1zOnZlcnNpb24+MTwvTDdnaW1zOnZlcnNpb24+DQogICAgICA8TDdnaW1zOmRuPiR7YXV0aGVudGljYXRlZFVzZXIuZG59PC9MN2dpbXM6ZG4+DQogICAgICA8TDdnaW1zOmF0dHI+DQoJPEw3Z2ltczphdHRyLW5hbWU+bG9naW48L0w3Z2ltczphdHRyLW5hbWU+DQoJPEw3Z2ltczphdHRyLXZhbHVlPiR7YXV0aGVudGljYXRlZFVzZXIubG9naW59PC9MN2dpbXM6YXR0ci12YWx1ZT4NCiAgICAgIDwvTDdnaW1zOmF0dHI+DQogICAgICA8TDdnaW1zOmF0dHI+DQoJICAgPEw3Z2ltczphdHRyLW5hbWU+Z2l2ZW5OYW1lPC9MN2dpbXM6YXR0ci1uYW1lPg0KCSAgIDxMN2dpbXM6YXR0ci12YWx1ZT4ke2F1dGhlbnRpY2F0ZWRVc2VyLmZpcnN0TmFtZX08L0w3Z2ltczphdHRyLXZhbHVlPg0KICAgICAgPC9MN2dpbXM6YXR0cj4NCiAgICAgIDxMN2dpbXM6YXR0cj4NCgkgICA8TDdnaW1zOmF0dHItbmFtZT5zbjwvTDdnaW1zOmF0dHItbmFtZT4NCgkgICA8TDdnaW1zOmF0dHItdmFsdWU+JHthdXRoZW50aWNhdGVkVXNlci5sYXN0TmFtZX08L0w3Z2ltczphdHRyLXZhbHVlPg0KICAgICAgPC9MN2dpbXM6YXR0cj4NCiAgICAgIDxMN2dpbXM6YXR0cj4NCgkgICA8TDdnaW1zOmF0dHItbmFtZT5tYWlsPC9MN2dpbXM6YXR0ci1uYW1lPg0KCSAgIDxMN2dpbXM6YXR0ci12YWx1ZT4ke2F1dGhlbnRpY2F0ZWRVc2VyLmVtYWlsfTwvTDdnaW1zOmF0dHItdmFsdWU+DQogICAgICA8L0w3Z2ltczphdHRyPg0KICAgICAgPEw3Z2ltczphdHRyPg0KCSAgIDxMN2dpbXM6YXR0ci1uYW1lPmFjY291bnRFeHBpcmVzPC9MN2dpbXM6YXR0ci1uYW1lPg0KCSAgIDxMN2dpbXM6YXR0ci12YWx1ZT4ke2F1dGhlbnRpY2F0ZWRVc2VyLmV4cGlyYXRpb259PC9MN2dpbXM6YXR0ci12YWx1ZT4NCiAgICAgIDwvTDdnaW1zOmF0dHI+IA0KICAgPC9MN2dpbXM6dXNlcj4NCjwvTDdnaW1zOnNlcnZpY2U+"/>

                                    <L7p:VariableToSet stringValue="output"/>
                                    </L7p:SetVariable>

                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:Expression1 stringValue="${request.http.parameter.format}"/>

                                    <L7p:Expression2 stringValue="JSON"/>

                                    <L7p:Predicates predicates="included">

                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:RightValue stringValue="JSON"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtvdXRwdXR9"/>

                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>

                                    <L7p:DataType variableDataType="message"/>

                                    <L7p:VariableToSet stringValue="msg"/>
                                    </L7p:SetVariable>
                                    <L7p:JsonTransformation>

                                    <L7p:Convention convention="JSONML"/>

                                    <L7p:OtherTargetMessageVariable stringValue="msg"/>

                                    <L7p:RootTagString stringValue=""/>

                                    <L7p:Target target="OTHER"/>
                                    </L7p:JsonTransformation>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="JHtvdXRwdXR9"/>

                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>

                                    <L7p:DataType variableDataType="message"/>

                                    <L7p:Enabled booleanValue="false"/>

                                    <L7p:VariableToSet stringValue="msg"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="JHtvdXRwdXR9"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>

                                    <L7p:value stringValue="perform user authentication and return the authorization info"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>

                                    <L7p:value stringValue="authenticateUser()"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="dHJ1ZQ=="/>

                                    <L7p:VariableToSet stringValue="failed"/>
                                    </L7p:SetVariable>
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="QXV0aGVudGljYXRpb24gUmVxdWlyZWQ="/>

                                    <L7p:ResponseContentType stringValue="text/html; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="401"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="//validate"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${failed}"/>
                                    <L7p:Expression2 stringValue="false"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="false"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="QXV0aGVudGljYXRpb24gUmVxdWlyZWQ="/>
                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="401"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:CommentAssertion>
                                    <L7p:Comment stringValue="Add Custom Identity Provider authentication here"/>
                                    </L7p:CommentAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="QXV0aGVudGljYXRpb24gUmVxdWlyZWQ="/>
                                    <L7p:ResponseContentType stringValue="plain/text charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="401"/>
                                    </L7p:HardcodedResponse>
                                </wsp:All>
                            </wsp:OneOrMore>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="/1/authenticate"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="User Authentication"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${splitUri[2]}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="management"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="user"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="users"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                            </wsp:OneOrMore>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${request.http.parameter.provider}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="user"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="VXNlciBNYW5hZ2VtZW50IG9wdGlvbiBpcyBub3QgYXZhaWxhYmxlIGZvciBpbnRlcm5hbCBpZGVudGl0eSBwcm92aWRlcg=="/>
                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="users"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.method}"/>
                                    <L7p:Expression2 stringValue="GET"/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:RightValue stringValue="GET"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="VXNlciBNYW5hZ2VtZW50IG9wdGlvbiBpcyBub3QgYXZhaWxhYmxlIGZvciBpbnRlcm5hbCBpZGVudGl0eSBwcm92aWRlcg=="/>

                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="SW50ZXJuYWwgU2VydmVyIEVycm9y"/>

                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="500"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:CommentAssertion>
                                    <L7p:Comment stringValue="Add Custom Identity Provider user management here"/>
                                    </L7p:CommentAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="VXNlciBNYW5hZ2VtZW50IG9wdGlvbiBpcyBub3QgYXZhaWxhYmxlIGZvciBjdXN0b20gaWRlbnRpdHkgcHJvdmlkZXI="/>
                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                </wsp:All>
                            </wsp:OneOrMore>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValueReference="inline"><![CDATA[/1/management/user/<user-dn>
/1/management/users/<filter>]]></L7p:value>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="User Management"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${splitUri[2]}"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="management"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="group"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="groups"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                            </wsp:OneOrMore>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${request.http.parameter.provider}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="group"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="R3JvdXAgTWFuYWdlbWVudCBvcHRpb24gaXMgbm90IGF2YWlsYWJsZSBmb3IgaW50ZXJuYWwgaWRlbnRpdHkgcHJvdmlkZXI="/>
                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${splitUri[3]}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="groups"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>

                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.method}"/>
                                    <L7p:Expression2 stringValue="GET"/>

                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">

                                    <L7p:CaseSensitive booleanValue="false"/>

                                    <L7p:RightValue stringValue="GET"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="R3JvdXAgTWFuYWdlbWVudCBvcHRpb24gaXMgbm90IGF2YWlsYWJsZSBmb3IgaW50ZXJuYWwgaWRlbnRpdHkgcHJvdmlkZXI="/>

                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="SW50ZXJuYWwgU2VydmVyIEVycm9y"/>

                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>

                                    <L7p:ResponseStatus stringValue="500"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:CommentAssertion>
                                    <L7p:Comment stringValue="Add Custom Identity Provider group management here"/>
                                    </L7p:CommentAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="R3JvdXAgTWFuYWdlbWVudCBvcHRpb24gaXMgbm90IGF2YWlsYWJsZSBmb3IgY3VzdG9tIGlkZW50aXR5IHByb3ZpZGVy"/>
                                    <L7p:ResponseContentType stringValue="plain/text; charset=UTF-8"/>
                                    <L7p:ResponseStatus stringValue="501"/>
                                    </L7p:HardcodedResponse>
                                </wsp:All>
                            </wsp:OneOrMore>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValueReference="inline"><![CDATA[/1/management/group/<group-dn>
/1/management/groups/<filter>]]></L7p:value>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="Group Management"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="processRequest()"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="gims/1/*"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:All>
        </wsp:All>
    </wsp:Policy>
</exp:Export>
