<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <!-- PROTOTYPE ONLY BEGIN -->
    <meta http-equiv="Expires" content="-1" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Pragma" content="no-cache" />
    <!-- PROTOTYPE ONLY END -->
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Policy Migration [Enterprise Service Manager]</title>
    <wicket:head>
        <link rel="stylesheet" href="../css/l7.css" media="all" type="text/css" />

        <!-- Required YUI modules: animation, button, connection, container, event, json, logger -->
        <link rel="stylesheet" type="text/css" href="../yui/assets/skins/sam/skin.css">
        <script type="text/javascript" src="../yui/yahoo-dom-event/yahoo-dom-event.js"></script>
        <script type="text/javascript" src="../yui/animation/animation-min.js"></script>
        <script type="text/javascript" src="../yui/element/element-beta-min.js"></script>
        <script type="text/javascript" src="../yui/button/button-min.js"></script>
        <script type="text/javascript" src="../yui/connection/connection-min.js"></script>
        <script type="text/javascript" src="../yui/container/container-min.js"></script>
        <script type="text/javascript" src="../yui/json/json-min.js"></script>
        <script type="text/javascript" src="../yui/logger/logger-min.js"></script>

        <link rel="stylesheet" type="text/css" href="../css/l7-yui-skin.css" /> <!-- modifies YUI sam skin; must come after YUI CSS files -->
        <style type="text/css">
            th.dependencyExplorer {
                font-weight: normal;
                text-align: left;
                white-space: nowrap;
            }

            td.dependencyExplorer {
                text-align: left;
                vertical-align: top;
            }

            .yui-skin-sam .yui-button#migrateButton,
            .yui-skin-sam .yui-button#migrateButton .first-child,
            .yui-skin-sam .yui-button#migrateButton button,
            .yui-skin-sam .yui-button#migrateButton a,
            .yui-skin-sam .yui-button#migrateButton img,
            .yui-skin-sam .yui-button-focus#migrateButton,
            .yui-skin-sam .yui-button-focus#migrateButton .first-child,
            .yui-skin-sam .yui-button-focus#migrateButton button,
            .yui-skin-sam .yui-button-focus#migrateButton a,
            .yui-skin-sam .yui-button-focus#migrateButton img,
            .yui-skin-sam .yui-button-active#migrateButton,
            .yui-skin-sam .yui-button-active#migrateButton .first-child,
            .yui-skin-sam .yui-button-active#migrateButton button,
            .yui-skin-sam .yui-button-active#migrateButton a
            .yui-skin-sam .yui-button-active#migrateButton img,
            .yui-skin-sam .yui-button#identifyDependenciesButton,
            .yui-skin-sam .yui-button#identifyDependenciesButton .first-child,
            .yui-skin-sam .yui-button#identifyDependenciesButton button,
            .yui-skin-sam .yui-button#identifyDependenciesButton a,
            .yui-skin-sam .yui-button#identifyDependenciesButton img,
            .yui-skin-sam .yui-button-focus#identifyDependenciesButton,
            .yui-skin-sam .yui-button-focus#identifyDependenciesButton .first-child,
            .yui-skin-sam .yui-button-focus#identifyDependenciesButton button,
            .yui-skin-sam .yui-button-focus#identifyDependenciesButton a,
            .yui-skin-sam .yui-button-focus#identifyDependenciesButton img,
            .yui-skin-sam .yui-button-active#identifyDependenciesButton,
            .yui-skin-sam .yui-button-active#identifyDependenciesButton .first-child,
            .yui-skin-sam .yui-button-active#identifyDependenciesButton button,
            .yui-skin-sam .yui-button-active#identifyDependenciesButton a
            .yui-skin-sam .yui-button-active#identifyDependenciesButton img {
                border: none;
                background: none;
                margin: 0;
                padding: 0;
            }

            .yui-skin-sam .yui-button#migrateButton {
                margin-bottom: 10px;
            }
        </style>
        <script type="text/javascript" src="../js/l7.js"></script>
        <script type="text/javascript" src="../js/entityTreeTable.js"></script>
        <script type="text/javascript">
            /** Localized strings for local HTML markups, e.g., error dialogs. */
            var localizedStrings = {
                OK : 'OK',
                CANCEL : 'Cancel',
                ERROR : 'Error',
                SESSION_TIMEOUT : 'Your session has expired.',
                CANNOT_PARSE_RESPONSE_JSON : 'Malformed response from server.',
                CANNOT_GET_DATA_TO_ESTABLISH_TRUST : 'Unable to retrieve data for establishing trust by SSG Cluster from the server.',
                CANNOT_GET_DATA_TO_MAP_ACCESS_ACCOUNT : 'Unable to retrieve data for mapping access account from the server.',
                IDENTIFING_DEPENDENCIES : 'Identifying dependencies for selected source items ...',
                CANNOT_DOWNLOAD_DEPENDENCIES : 'Unable to retrieve list of dependencies for selected source items from the server.',
                DEPENDENCY_MAPPING : 'Dependency Mapping',
                DEPENDENCY_DOWNLOADED : 'Dependencies are listed below for mapping resolution.'
            }
        </script>
        <script type="text/javascript">
            var SIDE_SRC  = 'src';
            var SIDE_DEST = 'dest';
            var ITEM_TAB_SUFFIX_DETAILS      = 'Details';
            var ITEM_TAB_SUFFIX_DEPENDENCIES = 'Dependencies';
            var ITEM_TAB_SUFFIXES = [ITEM_TAB_SUFFIX_DETAILS, ITEM_TAB_SUFFIX_DEPENDENCIES];
            var ITEM_TAB_LCR = ['Left', 'Center', 'Right'];
            var MIN_FRAME_HEIGHT = 150;
            var MAX_FRAME_HEIGHT = 500;
            var INCR_FRAME_HEIGHT = 50;
            var DECR_FRAME_HEIGHT = - INCR_FRAME_HEIGHT;

            var migrateButton;
            var identifyDependenciesButton;
            var ssgClusterTrustDialog;
            var mapAccessAccountDialog;
            var changeAccessAccountDialog;
            var srcSSGClusterSelectorWindow;
            var destSSGClusterSelectorWindow;
            var srcSSGClusterContentSelectorWindow;
            var destSSGClusterContentSelectorWindow;

            var dependenciesAction;
            var migrationAction;

            /**
             * Verifies if all inputs for migration are valid.
             * @return {boolean} true if valid
             */
            function validateMigrationInputs() {
                var valid = validateIdentifyDependenciesInputs() &&
                            destSSGClusterContentSelectorWindow.getEntityTreeTable().getEntityWithRadioButtonSelected() != null;
                return valid;
            }

            /**
             * Verifies if all inputs for identifying dependencies are valid.
             * @return {boolean} true if valid
             */
            function validateIdentifyDependenciesInputs() {
                return srcSSGClusterContentSelectorWindow.getSsgCluster() != null &&
                       srcSSGClusterContentSelectorWindow.getEntityTreeTable().getEntitiesWithTristateCheckboxChecked().length > 0 &&
                       destSSGClusterContentSelectorWindow.getSsgCluster() != null &&
                       srcSSGClusterContentSelectorWindow.getSsgCluster().id != destSSGClusterContentSelectorWindow.getSsgCluster().id;
            }

            function updateMigrateButton() {
                migrateButton.set('disabled', !validateMigrationInputs());
            }

            function updateIdentifyDependenciesButton() {
                identifyDependenciesButton.set('disabled', !validateIdentifyDependenciesInputs());
            }

            function onLoadSrcSSGClusterContent(callbackId) {
                updateIdentifyDependenciesButton();
                updateMigrateButton();
                var entity = new Object();
                entity.id = "";
                entity.type = "";
                onItemHighlighted( null, null, entity, 'srcSSGClusterContentSelector' );
            }

            function onLoadDestSSGClusterContent(callbackId) {
                document.getElementById('destinationClusterId').value = destSSGClusterContentSelectorWindow.getSsgCluster().id;
                updateIdentifyDependenciesButton();
                updateMigrateButton();
                var entity = new Object();
                entity.id = "";
                entity.type = "";
                onItemHighlighted( null, null, entity, 'destSSGClusterContentSelector' );
            }

            function onChangeSrcSSGClusterContentSelection(event, entity, callbackId) {
                updateIdentifyDependenciesButton();
                updateMigrateButton();
            }

            function onChangeDestSSGClusterContentSelection(event, entity, callbackId) {
                document.getElementById('destinationFolderId').value = destSSGClusterContentSelectorWindow.getEntityTreeTable().getEntityWithRadioButtonSelected().id;
                updateMigrateButton();
            }

            /**
             * Callback function upon an SSG Cluster highlighted.
             * @param {object} previous     the previously highlighted SSG Cluster entity object literal; null if none
             * @param {object} ssgCluster   the newly highlighted SSG Cluster entity object literal
             * @param {string} callbackId   ID of IFRAME originating from
             */
            function onHighlightSsgCluster(previous, ssgCluster, callbackId) {
                if (callbackId == 'srcSSGClusterSelector') {
                    loadSrcSSGClusterContentSelector(ssgCluster);
                } else if (callbackId == 'destSSGClusterSelector') {
                    loadDestSSGClusterContentSelector(ssgCluster);
                }
            }

            /**
             * Callback function upon clicking a trust dialog button in the SSG Cluster selector.
             * @param {MouseEvent} event    the click event
             * @param {object} entity       object literal of the SSG cluster clicked on
             * @param {string} callbackId   ID of IFRAME originating from
             */
            function onClickTrustDialogButton(event, entity, callbackId) {
                if (entity.type == l7.Constants.ENTITY_TYPE.SSG_CLUSTER) {
                    launchSSGClusterTrustDialog(entity.id, entity.name, entity.sslHostName, entity.adminPort);
                } else {
                    YAHOO.log('No trust action for entity type: ' + entity.type, 'error', 'PolicyMigration.html');
                }
            }

            /**
             * Callback function upon clicking an access dialog button in the SSG Cluster selector.
             * @param {MouseEvent} event    the click event
             * @param {object} entity       object literal of the SSG cluster clicked on
             * @param {string} callbackId   ID of IFRAME originating from
             */
            function onClickAccessDialogButton(event, entity, callbackId) {
                if (entity.type == l7.Constants.ENTITY_TYPE.SSG_CLUSTER) {
                    if (entity.accessStatus) {
                        launchChangeAccessAccountDialog(entity);
                    } else {
                        launchMapAccessAccountDialog(entity);
                    }
                } else {
                    YAHOO.log('No trust action for entity type: ' + entity.type, 'error', 'PolicyMigration.html');
                }
            };

            function onClickItemTab(event, args) {
                var side = args[0];
                var tabSuffix = args[1];
                selectItemTab(side, tabSuffix, true);
            }

            function onItemHighlighted(ssgCluster, previous, entity, callbackId) {
                if (callbackId == 'srcSSGClusterContentSelector') {
                    var targetParam = "";
                    var targetCluster = destSSGClusterContentSelectorWindow.getSsgCluster();
                    if ( targetCluster ) {
                        targetParam = '&targetClusterId=' + escape(targetCluster.id);
                    }
                    wicketAjaxGet(srcItemSelectionCallbackUrl + '&clusterId=' + escape(srcSSGClusterContentSelectorWindow.getSsgCluster().id) + targetParam + '&type=' + escape(entity.type) + '&id=' + escape(entity.id) , function() { }, function() { });
                } else if (callbackId == 'destSSGClusterContentSelector') {
                    wicketAjaxGet(destItemSelectionCallbackUrl + '&clusterId=' + escape(destSSGClusterContentSelectorWindow.getSsgCluster().id) + '&type=' + escape(entity.type) + '&id=' + escape(entity.id) , function() { }, function() { });
                }
            }

            /**
             * @param {string} side         which side: SIDE_SRC or SIDE_DEST
             * @param {string} tabSuffix    which tab: one of ITEM_TAB_SUFFIXES
             */
            function selectItemTab(side, tabSuffix) {
                for (var i in ITEM_TAB_SUFFIXES) {
                    for (var j in ITEM_TAB_LCR) {
                        var elementId = side + 'Item' + ITEM_TAB_SUFFIXES[i] + 'Tab' + ITEM_TAB_LCR[j];
                        var element = document.getElementById(elementId);
                        if (tabSuffix == ITEM_TAB_SUFFIXES[i]) {
                            l7.Util.removeClass(element, 'unselectedTab');
                            l7.Util.removeClass(element, 'clickable');
                            YAHOO.util.Event.removeListener(element, 'click', onClickItemTab, [side, ITEM_TAB_SUFFIXES[i]]);
                        } else {
                            l7.Util.addClass(element, 'unselectedTab');
                            l7.Util.addClass(element, 'clickable');
                            YAHOO.util.Event.addListener(element, 'click', onClickItemTab, [side, ITEM_TAB_SUFFIXES[i]]);
                        }
                    }

                    var divId = side + 'Item' + ITEM_TAB_SUFFIXES[i] + 'Div';
                    var div = document.getElementById(divId);
                     if (tabSuffix == ITEM_TAB_SUFFIXES[i]) {
                         div.style.display = '';
                     } else {
                         div.style.display = 'none';
                     }
                }
            }

            /**
             * @param {string} side     which side: SIDE_SRC or SIDE_DEST
             * @return {string} the tab suffix: one of ITEM_TAB_SUFFIXES
             */
            function getSelctedItemTab(side) {
                for (var i in ITEM_TAB_SUFFIXES) {
                    var tabSuffix = ITEM_TAB_SUFFIXES[i];
                    var elementId = side + 'Item' + tabSuffix + 'Tab' + ITEM_TAB_LCR[0];
                    var element = document.getElementById(elementId);
                    if (!l7.Util.hasClass(element, 'clickable')) {
                        return tabSuffix;
                    }
                }
            }

            /**
             * @return {array}
             */
            function getSelectedSrcItems() {
                var result = [];
                var entities = srcSSGClusterContentSelectorWindow.getEntityTreeTable().getEntitiesWithTristateCheckboxChecked(
                    [
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE,
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE_ALIAS,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT_ALIAS
                    ]);
                for (var i = 0; i < entities.length; ++i) {
                    var entity = entities[i];
                    var o = {};
                    o.id = entity.id;
                    o.type = entity.type;
                    o.name = entity.name;
                    o.version = entity.version;
                    result.push(o);
                }
                return result;
            }

            function onClickIdentifyDependencies() {
                var postObject = {};
                postObject.clusterId = srcSSGClusterContentSelectorWindow.getSsgCluster().id;
                postObject.entities = getSelectedSrcItems();
                var postData = YAHOO.lang.JSON.stringify(postObject);
                document.getElementById('selectionJson').value = postData;
                dependenciesAction();
            }

            function onClickMigrate() {
                var postObject = {};
                postObject.clusterId = srcSSGClusterContentSelectorWindow.getSsgCluster().id;
                postObject.entities = getSelectedSrcItems();
                var postData = YAHOO.lang.JSON.stringify(postObject);
                document.getElementById('selectionJson').value = postData;
                document.getElementById('migrateFolders').value = document.getElementById('migrateFoldersCheckBox').checked;
                document.getElementById('enableNewServices').value = document.getElementById('enableNewServicesCheckBox').checked;
                document.getElementById('overwriteDependencies').value = document.getElementById('overwriteDependenciesCheckBox').checked;
                migrationAction();
            }

            /**
             * @param {string} id           SSG Cluster ID
             * @param {string} name         SSG Cluster name
             * @param {string} hostName     SSG Cluster SSL host name
             * @param {string} port         SSG Cluster administrative port number
             */
            function launchSSGClusterTrustDialog(id, name, hostName, port) {
                var callback = {
                    success : function(o) {
                        var result = l7.Connection.parseJsonResponse(o,
                                                                     true,
                                                                     localizedStrings.CANNOT_GET_DATA_TO_ESTABLISH_TRUST,
                                                                     localizedStrings.CANNOT_PARSE_RESPONSE_JSON,
                                                                     localizedStrings.SESSION_TIMEOUT,
                                                                     localizedStrings.ERROR,
                                                                     localizedStrings.OK);
                        if (result.success) {
                            // The response JSON object is expected to have this property:
                            // token {string} - an opague token for use as input to the gateway trust servlet
                            var baseURL = document.URL;
                            var queryPos = baseURL.indexOf('?');
                            if (queryPos > -1) {
                                baseURL = baseURL.substr(0, queryPos);  // Strips off query part.
                            }
                            document.getElementById('ssgClusterTrustForm_returnurl').value = baseURL + '?clusterguid=' + o.argument.id;
                            document.getElementById('ssgClusterTrustForm_esmToken').value = result.json.token;
                            document.getElementById('ssgClusterTrustForm').action = 'https://' + o.argument.hostName + ':' + o.argument.port + '/ssg/esmtrust?esmtrust=1';
                            document.getElementById('ssgClusterTrustDialog_name').innerHTML = l7.Util.escapeHtmlText(o.argument.name);
                            ssgClusterTrustDialog.center();
                            ssgClusterTrustDialog.show();
                        }
                    },
                    failure : function(o) {
                        l7.Dialog.showErrorDialog(
                                localizedStrings.ERROR,
                                localizedStrings.CANNOT_GET_DATA_TO_ESTABLISH_TRUST + '<br/><br/>' + o.status + ' ' + o.statusText,
                                localizedStrings.OK);
                    },
                    argument : {
                        id       : id,
                        name     : name,
                        hostName : hostName,
                        port     : port
                    }
                };
                var url = document.forms['getGatewayTrustServletInputsForm'].action;
                YAHOO.util.Connect.asyncRequest('GET', url, callback, null);
            }

            /**
             * @param {object} entity   the SSG Cluster entity object literal
             */
            function launchMapAccessAccountDialog(entity) {
                var callback = {
                    success : function(o) {
                        var result = l7.Connection.parseJsonResponse(o,
                                                                     true,
                                                                     localizedStrings.CANNOT_GET_DATA_TO_MAP_ACCESS_ACCOUNT,
                                                                     localizedStrings.CANNOT_PARSE_RESPONSE_JSON,
                                                                     localizedStrings.SESSION_TIMEOUT,
                                                                     localizedStrings.ERROR,
                                                                     localizedStrings.OK);
                        if (result.success) {
                            // The response JSON object is expected to have this property:
                            // token {string} - an opague token for use as input to the gateway trust servlet
                            var entity = o.argument;
                            document.getElementById('mapAccessAccountForm_esmToken').value = result.json.token;
                            document.getElementById('mapAccessAccountForm_returnurl').value = document.URL + '?clusterguid=' + entity.id;
                            document.getElementById('mapAccessAccountForm').action = 'https://' + entity.sslHostName + ':' + entity.adminPort + '/ssg/esmtrust';
                            document.getElementById('mapAccessAccountDialog_ssgClusterName').innerHTML = l7.Util.escapeHtmlText(entity.name);
                            mapAccessAccountDialog.center();
                            mapAccessAccountDialog.show();
                        }
                    },
                    failure : function(o) {
                        l7.Dialog.showErrorDialog(
                                localizedStrings.ERROR,
                                localizedStrings.CANNOT_GET_DATA_TO_MAP_ACCESS_ACCOUNT + '<br/><br/>' + o.status + ' ' + o.statusText,
                                localizedStrings.OK);
                    },
                    argument : entity
                };
                var url = document.forms['getGatewayTrustServletInputsForm'].action;
                YAHOO.util.Connect.asyncRequest('GET', url, callback, null);
            }

            /**
             * @param {object} entity   the SSG Cluster entity object literal
             */
            function launchChangeAccessAccountDialog(entity) {
                var callback = {
                    success : function(o) {
                        var result = l7.Connection.parseJsonResponse(o,
                                                                     true,
                                                                     localizedStrings.CANNOT_GET_DATA_TO_MAP_ACCESS_ACCOUNT,
                                                                     localizedStrings.CANNOT_PARSE_RESPONSE_JSON,
                                                                     localizedStrings.SESSION_TIMEOUT,
                                                                     localizedStrings.ERROR,
                                                                     localizedStrings.OK);
                        if (result.success) {
                            // The response JSON object is expected to have this property:
                            // token {string} - an opague token for use as input to the gateway trust servlet
                            var entity = o.argument;
                            document.getElementById('changeAccessAccountForm_esmToken').value = result.json.token;
                            document.getElementById('changeAccessAccountForm_returnurl').value = document.URL + '?clusterguid=' + entity.id;
                            document.getElementById('changeAccessAccountForm').action = 'https://' + entity.sslHostName + ':' + entity.adminPort + '/ssg/esmtrust';
                            document.getElementById('changeAccessAccountDialog_ssgClusterName').innerHTML = l7.Util.escapeHtmlText(entity.name);
                            changeAccessAccountDialog.center();
                            changeAccessAccountDialog.show();
                        }
                    },
                    failure : function(o) {
                        l7.Dialog.showErrorDialog(
                                localizedStrings.ERROR,
                                localizedStrings.CANNOT_GET_DATA_TO_MAP_ACCESS_ACCOUNT + '<br/><br/>' + o.status + ' ' + o.statusText,
                                localizedStrings.OK);
                    },
                    argument : entity
                };
                var url = document.forms['getGatewayTrustServletInputsForm'].action;
                YAHOO.util.Connect.asyncRequest('GET', url, callback, null);
            }

            function loadSrcSSGClusterContentSelector(ssgCluster) {
                srcSSGClusterContentSelectorWindow.setSsgClusterContentLoadedCallback(onLoadSrcSSGClusterContent);
                srcSSGClusterContentSelectorWindow.setEntityTristateCheckboxClickedCallback(onChangeSrcSSGClusterContentSelection);
                srcSSGClusterContentSelectorWindow.setHighlightableEntitiesAndCallback(
                    [
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE,
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE_ALIAS,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT_ALIAS
                    ], onItemHighlighted);
                srcSSGClusterContentSelectorWindow.loadSsgClusterContent(
                    ssgCluster,
                    [
                        l7.Constants.ENTITY_TYPE.SERVICE_FOLDER,
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE,
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE_ALIAS,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT_ALIAS
                    ],
                    null);
            }

            function loadDestSSGClusterContentSelector(ssgCluster) {
                destSSGClusterContentSelectorWindow.setSsgClusterContentLoadedCallback(onLoadDestSSGClusterContent);
                destSSGClusterContentSelectorWindow.setEntityRadioButtonClickedCallback(onChangeDestSSGClusterContentSelection);
                destSSGClusterContentSelectorWindow.setHighlightableEntitiesAndCallback(
                    [
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE,
                        l7.Constants.ENTITY_TYPE.PUBLISHED_SERVICE_ALIAS,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT,
                        l7.Constants.ENTITY_TYPE.POLICY_FRAGMENT_ALIAS
                    ], onItemHighlighted);
                destSSGClusterContentSelectorWindow.loadSsgClusterContent(
                    ssgCluster,
                    null,
                    [
                        l7.Constants.ENTITY_TYPE.SERVICE_FOLDER
                    ]);
            }

            function refreshSrcSsgClusterSelector() {
                srcSSGClusterSelectorWindow.loadEntityTreeTable();
                loadSrcSSGClusterContentSelector(null);     // Because no cluster is now selected.
            }

            function refreshDestSsgClusterSelector() {
                destSSGClusterSelectorWindow.loadEntityTreeTable();
                loadDestSSGClusterContentSelector(null);    // Because no cluster is now selected.
            }

            function refreshSrcSsgClusterContentSelector() {
                var ssgCluster = srcSSGClusterSelectorWindow.getEntityTreeTable().getHighlightedEntity();
                loadSrcSSGClusterContentSelector(ssgCluster);
            }

            function refreshDestSsgClusterContentSelector() {
                var ssgCluster = destSSGClusterSelectorWindow.getEntityTreeTable().getHighlightedEntity();
                loadDestSSGClusterContentSelector(ssgCluster);
            }

            function initSSGClusterSelector(iframe) {
                iframe.contentWindow.setCallbackId(iframe.id);
                iframe.contentWindow.setEntityHighlightedCallback(onHighlightSsgCluster);
                iframe.contentWindow.setOnClickTrustDialogButtonCallback(onClickTrustDialogButton);
                iframe.contentWindow.setOnClickAccessDialogButtonCallback(onClickAccessDialogButton);
            }

            function initSSGClusterContentSelector(iframe) {
                iframe.contentWindow.setCallbackId(iframe.id);
            }

            function initButtons() {
                migrateButton = new YAHOO.widget.Button('migrateButton', {
                    disabled : true,        // initially disabled until all dependency mapping are done
                    onclick  : { fn : onClickMigrate },
                    title    : 'Migrate selected policies with dependency mapping', // need title on IMG element too
                    type     : 'push'
                });
                identifyDependenciesButton = new YAHOO.widget.Button('identifyDependenciesButton', {
                    disabled : true,        // initially disabled until SSG contents are checked
                    onclick : { fn : onClickIdentifyDependencies },
                    title   : 'Identify dependencies',                              // need title on IMG element too
                    type    : 'push'
                });
            }

            function initSSGClusterTrustDialog() {
                ssgClusterTrustDialog = new YAHOO.widget.Dialog('ssgClusterTrustDialog', {
                    buttons     : [
                        {
                            text      : localizedStrings.OK,
                            handler   : function() {
                                this.submit();
                            },
                            isDefault : true
                        },
                        {
                            text      : localizedStrings.CANCEL,
                            handler   : function() {
                                this.hide();
                            }
                        }
                    ],
                    close       : true,
                    draggable   : true,
                    icon        : YAHOO.widget.SimpleDialog.ICON_BLOCK,
                    modal       : true,
                    postmethod  : 'form',
                    visible     : false
                });
                ssgClusterTrustDialog.render();
            }

            function initMapAccessAccountDialog() {
                mapAccessAccountDialog = new YAHOO.widget.Dialog('mapAccessAccountDialog', {
                    buttons     : [
                        {
                            text      : localizedStrings.OK,
                            handler   : function() {
                                this.submit();
                            },
                            isDefault : true
                        },
                        {
                            text      : localizedStrings.CANCEL,
                            handler   : function() {
                                this.hide();
                            }
                        }
                    ],
                    close       : true,
                    draggable   : true,
                    icon        : YAHOO.widget.SimpleDialog.ICON_BLOCK,
                    modal       : true,
                    postmethod  : 'form',
                    visible     : false
                });
                mapAccessAccountDialog.render();
            }

            function initChangeAccessAccountDialog() {
                changeAccessAccountDialog = new YAHOO.widget.Dialog('changeAccessAccountDialog', {
                    buttons     : [
                        {
                            text      : localizedStrings.OK,
                            handler   : function() {
                                this.submit();
                            },
                            isDefault : true
                        },
                        {
                            text      : localizedStrings.CANCEL,
                            handler   : function() {
                                this.hide();
                            }
                        }
                    ],
                    close       : true,
                    draggable   : true,
                    icon        : YAHOO.widget.SimpleDialog.ICON_BLOCK,
                    modal       : true,
                    postmethod  : 'form',
                    visible     : false
                });
                changeAccessAccountDialog.render();
            }

            function initDialogs() {
                initSSGClusterTrustDialog();
                initMapAccessAccountDialog();
                initChangeAccessAccountDialog();
            }

            function initActions() {
                var identifyDependenciesImage = document.getElementById('identifyDependenciesImage');
                dependenciesAction = identifyDependenciesImage.onclick;
                identifyDependenciesImage.onclick = null;

                var migrateImage = document.getElementById('migrateImage');
                migrationAction = migrateImage.onclick;
                migrateImage.onclick = null;
            }

            function init() {
                srcSSGClusterSelectorWindow = document.getElementById('srcSSGClusterSelector').contentWindow;
                destSSGClusterSelectorWindow = document.getElementById('destSSGClusterSelector').contentWindow;
                srcSSGClusterContentSelectorWindow = document.getElementById('srcSSGClusterContentSelector').contentWindow;
                destSSGClusterContentSelectorWindow = document.getElementById('destSSGClusterContentSelector').contentWindow;

                initButtons();
                initDialogs();
                initActions();
                selectItemTab(SIDE_SRC,  ITEM_TAB_SUFFIX_DETAILS);
                selectItemTab(SIDE_DEST, ITEM_TAB_SUFFIX_DETAILS);
            }

            YAHOO.util.Event.onDOMReady(init);

            function selectClusters( sourceGuid, sourceItems, targetGuid, targetItem, migrateFolders, enableNewServices, overwriteDependencies ) {
                document.getElementById('migrateFoldersCheckBox').checked = migrateFolders;
                document.getElementById('enableNewServicesCheckBox').checked = enableNewServices;
                document.getElementById('overwriteDependenciesCheckBox').checked = overwriteDependencies;
                document.getElementById('destinationClusterId').value = targetGuid;
                document.getElementById('destinationFolderId').value = targetItem;

                var resetAfterLoad = function() {
                    updateMigrateButton();
                    updateIdentifyDependenciesButton();
                }

                srcSSGClusterSelectorWindow.getEntityTreeTable().highlightEntity( sourceGuid, true );
                srcSSGClusterContentSelectorWindow.setSsgClusterContentLoadedCallback( function() {
                    var item;
                    for ( item in sourceItems ) {
                        srcSSGClusterContentSelectorWindow.getEntityTreeTable().setEntityTristateCheckboxState( sourceItems[item], true );
                        srcSSGClusterContentSelectorWindow.getEntityTreeTable().expandAncestorsOf( sourceItems[item] );
                    }
                    resetAfterLoad();
                } );

                destSSGClusterSelectorWindow.getEntityTreeTable().highlightEntity( targetGuid, true );
                destSSGClusterContentSelectorWindow.setSsgClusterContentLoadedCallback( function() {
                    destSSGClusterContentSelectorWindow.getEntityTreeTable().setEntityRadioButtonState( targetItem, true );
                    destSSGClusterContentSelectorWindow.getEntityTreeTable().expandAncestorsOf( targetItem );
                    resetAfterLoad();
                } );
            }
        </script>
    </wicket:head>
</head>
<body class="yui-skin-sam">
<noscript><div class="javascriptWarning">This page requires JavaScript. Your browser either does not have JavaScript support or has disabled it.</div></noscript>
<table width="100%">
    <tr>
        <td>
            <div class="header">
                <table width="100%">
                    <tr class="header">
                        <td class="logoLeft"><img src="../images/logoLeft.png" alt="" /></td>
                        <td class="logo"><a href="Monitor.html"><img src="../images/l7Logo.png" alt="Layer 7 Technologies Inc." /><img src="../images/esmLogo.png" alt="" /></a></td>
                        <td class="logoRight"><img src="../images/logoRight.png" alt="" /></td>
                        <td width="100%"><img src="../images/spacer.png" alt="" /></td>
                        <td class="middle nowrap">Logged in as "admin"<br />since May 5, 2008 05:57:54 PM</td>
                        <td class="middle"><form method="get" action="Login.html"><input type="submit" value="Log Out" /></form></td>
                        <td class="middle help"><a href="Help.html" target="l7-esm-help" title="Open help page in a separate window">Help</a></td>
                    </tr>
                </table>
            </div>
            <div class="divider"><img src="../images/spacer.png" alt="" /></div>
            <div>
                <table>
                    <tr>
                        <td id="tabLTManageGateways"><img src="../images/tabLT.png" alt="" /></td>
                        <td id="tabCTManageGateways" class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRTManageGateways"><img src="../images/tabRT.png" alt="" /></td>
                        <td id="tabLTManagePolicies"><img src="../images/tabLT.png" alt="" /></td>
                        <td id="tabCTManagePolicies" class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRTManagePolicies"><img src="../images/tabRT.png" alt="" /></td>
                        <td id="tabLTReports"><img src="../images/tabLT.png" alt="" /></td>
                        <td id="tabCTReports" class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRTReports"><img src="../images/tabRT.png" alt="" /></td>
                        <td id="tabLTTools"><img src="../images/tabLT.png" alt="" /></td>
                        <td id="tabCTTools" class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRTTools"><img src="../images/tabRT.png" alt="" /></td>
                        <td id="tabLTSettings"><img src="../images/tabLT.png" alt="" /></td>
                        <td id="tabCTSettings" class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRTSettings"><img src="../images/tabRT.png" alt="" /></td>
                        <td><img src="../images/tabLT.png" alt="" /></td>
                        <td class="tabCT"><img src="../images/spacer.png" alt="" /></td>
                        <td><img src="../images/tabRT.png" alt="" /></td>
                    </tr>
                    <tr>
                        <td id="tabLMManageGateways" class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabCMManageGateways" class="tabCM"><a href="Monitor.html">Manage Gateways</a></td>
                        <td id="tabRMManageGateways" class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabLMManagePolicies" class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabCMManagePolicies" class="tabCMon">Manage Policies</td>
                        <td id="tabRMManagePolicies" class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabLMReports" class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabCMReports" class="tabCM"><a href="StandardReports.html">Reports</a></td>
                        <td id="tabRMReports" class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabLMTools" class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabCMTools" class="tabCM"><a href="Messages.html">Tools</a></td>
                        <td id="tabRMTools" class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabLMSettings" class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabCMSettings" class="tabCM"><a href="UserSettings.html">Settings</a></td>
                        <td id="tabRMSettings" class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                        <td class="tabLM"><img src="../images/spacer.png" alt="" /></td>
                        <td class="tabCM" width="100%"><img src="../images/spacer.png" alt="" /></td>
                        <td class="tabRM"><img src="../images/spacer.png" alt="" /></td>
                    </tr>
                    <tr>
                        <td id="tabLBManageGateways"><img src="../images/tabLBoff.png" alt="" /></td>
                        <td id="tabCBManageGateways" class="tabCBoff"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRBManageGateways"><img src="../images/tabRBoff.png" alt="" /></td>
                        <td id="tabLBManagePolicies"><img src="../images/tabLBon.png" alt="" /></td>
                        <td id="tabCBManagePolicies" class="tabCBon"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRBManagePolicies"><img src="../images/tabRBon.png" alt="" /></td>
                        <td id="tabLBReports"><img src="../images/tabLBoff.png" alt="" /></td>
                        <td id="tabCBReports" class="tabCBoff"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRBReports"><img src="../images/tabRBoff.png" alt="" /></td>
                        <td id="tabLBTools"><img src="../images/tabLBoff.png" alt="" /></td>
                        <td id="tabCBTools" class="tabCBoff"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRBTools"><img src="../images/tabRBoff.png" alt="" /></td>
                        <td id="tabLBSettings"><img src="../images/tabLBoff.png" alt="" /></td>
                        <td id="tabCBSettings" class="tabCBoff"><img src="../images/spacer.png" alt="" /></td>
                        <td id="tabRBSettings"><img src="../images/tabRBoff.png" alt="" /></td>
                        <td><img src="../images/tabLBoff.png" alt="" /></td>
                        <td class="tabCBoff"><img src="../images/spacer.png" alt="" /></td>
                        <td><img src="../images/tabRBoff.png" alt="" /></td>
                    </tr>
                </table>
            </div>
            <script language="JavaScript" type="text/javascript">
                l7.TabBar.initTab('ManageGateways');
                l7.TabBar.initTab('Reports');
                l7.TabBar.initTab('Tools');
                l7.TabBar.initTab('Settings');
            </script>
            <div class="subtabBar">
                <span class="subtabOn">Migration</span>
                |
                <span class="subtabOff"><a href="PolicySubmission.html">Submission</a></span>
                |
                <span class="subtabOff"><a href="PolicyApproval.html">Approval</a></span>
                |
                <span class="subtabOff"><a href="PolicyMapping.html">Mapping</a></span>
            </div>
            <div class="content">
            <wicket:extend>

            <div class="panel">
                <div class="panelTitle">
                    Reload Migration
                     <img wicket:id="refresh" class="refresh clickableImg middle" src="../images/refresh.png" title="Refresh list of generated reports" alt="Refresh" />
                </div>
                <div class="panelContent">
                    <form wicket:id="reloadForm">
                        <table>
                        <tr>
                        <td>Reload to re-migrate using settings from a previous migration:</td> 
                        <td><select wicket:id="reloadSelect"></select></td>
                        <td><button type="submit" wicket:id="reloadMigrationButton">Reload Migration</button></td>
                        </tr>
                        </table>
                    </form>
                    <script language="javascript" wicket:id="javascript"></script>
                </div>
            </div>            

            <div class="sideBySide">
            <table>
            <tr>
                <td><img src="../images/spacer.png" alt="" height="0" width="350" /><!-- minimum width --></td>
                <td class="srcDestCenter"></td>
                <td><img src="../images/spacer.png" alt="" height="0" width="350" /><!-- minimum width --></td>
            </tr>
            <tr>
                <td width="50%">
                    <table width="100%">
                        <tr>
                            <td class="roundedTitleLeft"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td class="roundedTitleCenter" width="100%">Source</td>
                            <td class="roundedTitleRight"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                        </tr>
                    </table>
                </td>
                <td class="srcDestCenter"></td>
                <td width="50%">
                    <table width="100%">
                        <tr>
                            <td class="roundedTitleLeft"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td class="roundedTitleCenter" width="100%">Destination</td>
                            <td class="roundedTitleRight"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="srcDestTop">
                    <table width="100%">
                        <tr>
                            <td class="nowrap">Select a source SSG Cluster:</td>
                            <td class="right" width="100%">
                                <img class="clickableImg" src="../images/refresh.png" title="Refresh" alt="Refresh" onclick="refreshSrcSsgClusterSelector();"/>
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterSelector', 'destSSGClusterSelector'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterSelector', 'destSSGClusterSelector'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td class="srcDestCenter"></td>
                <td class="srcDestTop">
                    <table width="100%">
                        <tr>
                            <td class="nowrap">Select a destination SSG Cluster:</td>
                            <td class="right" width="100%">
                                <img class="clickableImg" src="../images/refresh.png" title="Refresh" alt="Refresh" onclick="refreshDestSsgClusterSelector();"/>
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterSelector', 'destSSGClusterSelector'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterSelector', 'destSSGClusterSelector'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="srcDest">
                    <iframe id="srcSSGClusterSelector" src="SSGClusterSelector.html" frameborder="0" scrolling="yes"
                            height="150" width="100%" onload="initSSGClusterSelector(this);"></iframe>
                </td>
                <td class="srcDestCenter"></td>
                <td class="srcDest">
                    <iframe id="destSSGClusterSelector" src="SSGClusterSelector.html" frameborder="0" scrolling="yes"
                            height="150" width="100%" onload="initSSGClusterSelector(this);"></iframe>
                </td>
            </tr>
            <tr>
                <td class="srcDest">
                    <table width="100%">
                        <tr>
                            <td width="100%">
                                <span class="nowrap">Select items to migrate:</span>
                                <span class="nowrap">
                                    <input id="migrateFoldersCheckBox" type="checkbox" checked/>
                                    <label for="migrateFoldersCheckBox"> migrate folders</label>
                                </span>
                            </td>
                            <td class="nowrap">
                                <img class="clickableImg" src="../images/refresh.png" title="Refresh" alt="Refresh" onclick="refreshSrcSsgClusterContentSelector();"/>
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterContentSelector', 'destSSGClusterContentSelector'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterContentSelector', 'destSSGClusterContentSelector'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td class="srcDestCenter"></td>
                <td class="srcDest">
                    <table width="100%">
                        <tr>
                            <td width="100%">
                                <span class="nowrap">Select a destination folder:</span>
                                <span class="nowrap">
                                    (<input id="enableNewServicesCheckBox" type="checkbox" />
                                    <label for="enableNewServicesCheckBox"> enable new services</label>,
                                    <input id="overwriteDependenciesCheckBox" type="checkbox" />
                                    <label for="overwriteDependenciesCheckBox"> overwrite existing items</label>)
                                </span>
                            </td>
                            <td class="nowrap">
                                <img class="clickableImg" src="../images/refresh.png" title="Refresh" alt="Refresh" onclick="refreshDestSsgClusterContentSelector();"/>
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterContentSelector', 'destSSGClusterContentSelector'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcSSGClusterContentSelector', 'destSSGClusterContentSelector'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="srcDest">
                    <iframe id="srcSSGClusterContentSelector" src="SSGClusterContentSelector.html" frameborder="0"
                            scrolling="yes" height="150" width="100%"
                            onload="initSSGClusterContentSelector(this);"></iframe>
                </td>
                <td class="srcDestCenter">
                    <button id="migrateButton"><img src="../images/copy.png" title="Migrate selected policies with dependency mapping" alt="" id="migrateImage" wicket:id="migrateImage"></button>
                    <br/>
                    <button id="identifyDependenciesButton"><img src="../images/resolveDependencies.png" title="Identify dependencies" alt="" id="identifyDependenciesImage" wicket:id="identifyDependenciesImage"></button>
                </td>
                <td class="srcDest">
                    <iframe id="destSSGClusterContentSelector" src="SSGClusterContentSelector.html" frameborder="0"
                            scrolling="yes" height="150" width="100%"
                            onload="initSSGClusterContentSelector(this);"></iframe>
                </td>
            </tr>
            <tr>
                <td class="srcDest" style="padding-top: 4px; padding-bottom: 0;">
                    <table width="100%">
                        <tr>
                            <td id="srcItemDetailsTabLeft" class="roundedTitle2Left"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td id="srcItemDetailsTabCenter" class="roundedTitle2Center">Item Details</td>
                            <td id="srcItemDetailsTabRight" class="roundedTitle2Right"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td><img src="../images/spacer.png" width="1" height="1" alt="" /></td>
                            <td id="srcItemDependenciesTabLeft" class="roundedTitle2Left"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td id="srcItemDependenciesTabCenter" class="roundedTitle2Center">Item Dependencies</td>
                            <td id="srcItemDependenciesTabRight" class="roundedTitle2Right"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td class="right" width="100%">
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcItemDiv', 'destItemDiv'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcItemDiv', 'destItemDiv'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td class="srcDestCenter"></td>
                <td class="srcDest" style="padding-top: 4px; padding-bottom: 0;">
                    <table width="100%">
                        <tr>
                            <td id="destItemDetailsTabLeft" class="roundedTitle2Left"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td id="destItemDetailsTabCenter" class="roundedTitle2Center">Item Details</td>
                            <td id="destItemDetailsTabRight" class="roundedTitle2Right"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td><img src="../images/spacer.png" width="1" height="1" alt="" /></td>
                            <td id="destItemDependenciesTabLeft" class="roundedTitle2Left"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td id="destItemDependenciesTabCenter" class="roundedTitle2Center">Item Dependencies</td>
                            <td id="destItemDependenciesTabRight" class="roundedTitle2Right"><img src="../images/spacer.png" width="8" height="8" alt="" /></td>
                            <td class="right" width="100%">
                                <img class="clickable" src="../images/taller.png" title="Make taller" alt=""
                                     onclick="l7.Resize.changeHeight(['srcItemDiv', 'destItemDiv'], INCR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                                <img class="clickable" src="../images/shorter.png" title="Make shorter" alt=""
                                     onclick="l7.Resize.changeHeight(['srcItemDiv', 'destItemDiv'], DECR_FRAME_HEIGHT, MIN_FRAME_HEIGHT, MAX_FRAME_HEIGHT);" />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td class="srcDestBottom" style="padding-top: 0;">
                    <div id="srcItemDiv" style="border: 1px solid #606060; overflow: scroll; height: 150px" class="dataIFrame">
                        <div id="srcItemDetailsDiv">
                            <table class="dataTable" wicket:id="srcItemDetails" width="100%">
                                <thead>
                                    <tr>
                                        <th width="15%">Property</th>
                                        <th width="85%">Value</th>
                                    </tr>
                                </thead>
                                <tr wicket:id="itemDetailsRepeater">
                                    <th><div style="text-align: left;" wicket:id="name"/></th>
                                    <td><div wicket:id="value"/></td>
                                </tr>
                            </table>
                        </div>
                        <div id="srcItemDependenciesDiv">
                            <table class="dataTable" wicket:id="srcItemDependencies" width="100%">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th class="name" width="100%">Name<br /><img src="../images/spacer.png" alt="" height="0" width="140" /><!-- minimum width --></th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr wicket:id="optionRepeater">
                                        <td><div wicket:id="optional"/></td>
                                        <td><div wicket:id="name"/></td>
                                        <td><div wicket:id="type"/></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>
                <td class="srcDestCenter"></td>
                <td class="srcDestBottom" style="padding-top: 0;">
                    <div id="destItemDiv" style="border: 1px solid #606060; overflow: scroll; height: 150px" class="dataIFrame">
                        <div id="destItemDetailsDiv">
                            <table class="dataTable" wicket:id="destItemDetails" width="100%">
                                <thead>
                                    <tr>
                                        <th width="15%">Property</th>
                                        <th width="85%">Value</th>
                                    </tr>
                                </thead>
                                <tr wicket:id="itemDetailsRepeater">
                                    <th><div style="text-align: left;" wicket:id="name"/></th>
                                    <td><div wicket:id="value"/></td>
                                </tr>
                            </table>
                        </div>
                        <div id="destItemDependenciesDiv">
                            <table class="dataTable" wicket:id="destItemDependencies" width="100%">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th class="name" width="100%">Name<br /><img src="../images/spacer.png" alt="" height="0" width="140" /><!-- minimum width --></th>
                                        <th>Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr wicket:id="optionRepeater">
                                        <td><div wicket:id="optional"/></td>
                                        <td><div wicket:id="name"/></td>
                                        <td><div wicket:id="type"/></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
            </table>
            </div>
            <form wicket:id="selectionForm">
                <input id="selectionJson" type="hidden" wicket:id="selectionJson"/>
                <input id="destinationClusterId" type="hidden" wicket:id="destinationClusterId"/>
                <input id="destinationFolderId" type="hidden" wicket:id="destinationFolderId"/>
                <input id="migrateFolders" type="hidden" wicket:id="migrateFolders"/>
                <input id="enableNewServices" type="hidden" wicket:id="enableNewServices"/>
                <input id="overwriteDependencies" type="hidden" wicket:id="overwriteDependencies"/>
            </form>
            <div wicket:id="dialogContainer">
                <div wicket:id="dialog"/>
            </div>
            <div class="panel">
                <div class="panelTitle">Dependencies Mapping</div>
                <div class="panelContent" style="height: 390px; overflow: hidden">
                    <table width="100%" wicket:id="dependencies" cellpadding="0" cellspacing="0">
                        <tr>
                            <th width="49%"><img src="../images/spacer.png" alt="" height="0" width="350" /><!-- minimum width -->
                            </th>
                            <th width="2%"></th>
                            <th width="49%"><img src="../images/spacer.png" alt="" height="0" width="350" /><!-- minimum width -->
                            </th>
                        </tr>
                        <tr>
                            <th class="dependencyExplorer">Select an item to resolve:</th>
                            <th class="dependencyExplorer">&nbsp;</th>
                            <th class="dependencyExplorer">Choose mapping from destination candidates:</th>
                        </tr>
                        <tr>
                            <td class="panelToolbar" style="padding: 4px; vertical-align: top">
                                <p>Dependencies that must be mapped for migration are shown by: <img src="/images/unresolved.png" class="middle"/></p>
                                <p>For some dependencies (such as policy fragments) mapping is optional.</p>

                                <table class="indent spaced">
                                    <tr>
                                        <th>Total number of dependencies:</th>
                                        <td><div wicket:id="dependenciesTotalLabel"/></td>
                                    </tr>
                                    <tr>
                                        <th>Number of unmapped dependencies :</th>
                                        <td><div wicket:id="dependenciesUnmappedLabel"/></td>
                                    </tr>
                                    <tr>
                                        <th>Number of required unmapped dependencies :</th>
                                        <td><div wicket:id="dependenciesRequiredUnmappedLabel"/></td>
                                    </tr>
                                 </table>
                            </td>
                            <td></td>
                            <td class="panelToolbar" style="padding: 4px; vertical-align: top">
                                <div wicket:id="dependencyCandidateContainer">
                                    <p>Find destination candidates for:</p>

                                    <table class="indent spaced">
                                        <tr>
                                            <th>Name:</th>
                                            <td><div wicket:id="dependencyCandidateName"/></td>
                                        </tr>
                                        <tr>
                                            <th>Type:</th>
                                            <td><div wicket:id="dependencyCandidateType"/></td>
                                        </tr>
                                     </table>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top">
                               <div wicket:id="dependenciesTable"/>

                                <form wicket:id="dependencyControlsForm">
                                    <button type="submit" wicket:id="dependencyLoadButton">Load Previous Mappings</button>
                                    <button type="submit" wicket:id="dependencyClearButton">Clear Mapping</button>
                                    <button type="submit" wicket:id="dependencyEditButton">Edit Mapping Value</button>
                                </form>
                            </td>
                            <td></td>
                            <td valign="top">
                                <form wicket:id="dependencyOptionsContainer">
                                    <div>
                                        <table cellspacing="2" style="margin-top: 2px">
                                            <tr>
                                                <td class="middle nowrap">
                                                    Search for candidates from <select wicket:id="dependencySearchTarget" style="width: 250px;"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="middle nowrap">
                                                    where name <select wicket:id="dependencySearchManner"/>
                                                    <input type="text" wicket:id="dependencySearchText" value="" size="30" style="width: 235px"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="right"><button type="submit" wicket:id="dependencySearchButton">Search</button></td>
                                            </tr>
                                        </table>

                                        <br/>

                                        <div style="border: 1px solid black; height: 185px; width: 400px; overflow: scroll">
                                            <table class="dataTable" wicket:id="dependencyOptions" width="100%">
                                                <thead>
                                                    <tr>
                                                        <th></th>
                                                        <th width="95%">Name</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr wicket:id="optionRepeater">
                                                        <td><input name="selectionValue" type="radio" wicket:id="uid"/></td>
                                                        <td><div wicket:id="name"/></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </form>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <div id="ssgClusterTrustDialog">
                <div class="hd">Establish Trust by SSG Cluster</div>
                <div class="bd" style="width: 40em;">
                    <form id="ssgClusterTrustForm" method="POST">
                        <input id="ssgClusterTrustForm_esmToken" type="hidden" name="token" />
                        <input id="ssgClusterTrustForm_returnurl" type="hidden" name="returnurl" />
                    </form>
                    To establish trust of this Enterprise Service Manager by the SSG Cluster
                    &ldquo;<span id="ssgClusterTrustDialog_name"></span>&rdquo;,
                    you will now be redirected to the cluster server where
                    you can authenticate using a gateway administrator account.
                    That account will also be mapped to your Enterprise Service Manager account.
                    When completed, you will be returned to this page.
                </div>
            </div>

            <div style="display: none;">
                <form name="getGatewayTrustServletInputsForm" wicket:id="getGatewayTrustServletInputsForm" method="POST">
                </form>
            </div>

            <div id="mapAccessAccountDialog">
                <div class="hd">Map Access Account</div>
                <div class="bd" style="width: 40em;">
                    <form id="mapAccessAccountForm" method="POST">
                        <input id="mapAccessAccountForm_esmToken" type="hidden" name="token" />
                        <input id="mapAccessAccountForm_returnurl" type="hidden" name="returnurl" />
                    </form>
                    To enable access to the SSG Cluster
                    &ldquo;<span id="mapAccessAccountDialog_ssgClusterName"></span>&rdquo;,
                    you will now be redirected to the cluster server where
                    you can map a gateway user account to your Enterprise Service Manager account.
                    When completed, you will be returned to this page.
                </div>
            </div>

            <div id="changeAccessAccountDialog">
                <div class="hd">Change Access Account</div>
                <div class="bd" style="width: 40em;">
                    <form id="changeAccessAccountForm" method="POST">
                        <input id="changeAccessAccountForm_esmToken" type="hidden" name="token" />
                        <input id="changeAccessAccountForm_returnurl" type="hidden" name="returnurl" />
                    </form>
                    Your Enterprise Service Manager account is currently mapped to a user account
                    on the SSG Cluster
                    &ldquo;<span id="changeAccessAccountDialog_ssgClusterName"></span>&rdquo;.
                    To change that,  you will now be redirected to the cluster server where
                    you can map a different gateway user account.
                    When completed, you will be returned to this page.
                </div>
            </div>

            </wicket:extend>
            </div>
            <div class="statusBar">
                <table>
                    <tr>
                        <td width="100%">Time Zone: Canada/Pacific (GMT-08:00/<b>-07:00</b>)</td>
                        <td><a class="nowrap" href="http://www.layer7tech.com" target="_blank">Layer 7 Technologies Inc.</a></td>
                    </tr>
                </table>
            </div>
            <div class="divider"><img src="../images/spacer.png" alt="" /></div>
        </td>
    </tr>
</table>
</body>
</html>
