This patch is for tomcat-6.0.35 and can be found at http://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_35.
The patch is created with *NIX style line endings and has the strip option of p0.

Patch: patch -p0 -i coyote-6.0.35-l7p1.patch


BUG - SSG-7202 Gateway Truncates Content-Type Space Delimiter on Response
-------------------------------------------------------------------------

The response content type string is generated by the apache catalina library with the following method:
org.apache.coyote.Response#getContentType
 public String getContentType() {

        String ret = contentType;

        if (ret != null
            && characterEncoding != null
            && charsetSet) {
            ret = ret + ";charset=" + characterEncoding;
        }

        return ret;
  }
It didn't put a space between the semicolon and the charset, this class is defined as Final and seem there is no way to override this method.

To resolve this issue a Connector property "trimContentType" (value true/false) is created to configure the space trimming behaviour.

By default trimContentType property is true.


BUG SSG-7786 - Java environment revealing vulnerability
-------------------------------------------------------
When accessing the gateway with the java metadata directory in the URI (http://localhost:8080/WEB-INF or http://localhost:8080/META-INF) it is not captured by the SoapMessageProcessingServlet.  This is because Tomcat disable access to these URI, when such URI is reached, it will immediately return a 404 as such the logic in SoapMessageProcessingServlet is never executed (no audit log, etc...).

This patch is to handle the /WEB-INF and /META-INF URI consistently with SoapMessageProcessingServlet
